<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>Using SpaceMask</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- mathjax,charset=utf-8,html,xhtml --> 
<meta name="src" content="documentation.tex" /> 
<link rel="stylesheet" type="text/css" href="documentation.css" /> 
<script>window.MathJax = { tex: { tags: "ams", }, }; </script> 
 <script type="text/javascript" async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>  
</head><body 
>
<div class="maketitle">
                                                                                       
                                                                                       
                                                                                       
                                                                                       

<h2 class="titleHead">Using SpaceMask</h2>
 <div class="author" ><span 
class="cmr-12">Denis Pollney</span></div>
<br />
<div class="date" >\( \)<span 
class="cmr-12">Date</span>\( \)</div>
</div>
<div 
class="abstract" 
>
<h3 class="abstracttitle">
<span 
class="cmbx-9">Abstract</span>
</h3>
     <!--l. 21--><p class="noindent" ><span 
class="cmr-9">The SpaceMask thorn provides a grid function which can be used to store user-defined states at each</span>
     <span 
class="cmr-9">grid point. Routines are provided for quickly setting and checking the mask states.</span>
</p>
</div>
<h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>The mask bit-field</h3>
<!--l. 28--><p class="noindent" >The mask is a grid function which can be used to assign a state to each point on the grid. It is
used as a bit field, with different bits, or combinations of bits, assigned to represent various
states. The mask is currently implemented as a CCTK_INT grid function, providing 32 bits per
point.<span class="footnote-mark"><a 
href="documentation2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-1001f1"></a> 
                                                                                       
                                                                                       
Appropriate numbers of bits within the mask can be allocated to represent individual states of a given
type.
</p><!--l. 38--><p class="noindent" >For instance, a programmer wants to record whether each point of the grid has <span 
class="cmti-10">state </span>“interior”, “excised” or
“boundary”. The collection of these states is called a <span 
class="cmti-10">type</span>, and 2-bits of the mask (enough to represent the three
possible states of the type) are allocated to hold this information. If an independent classification of points (ie. a
new type) is required, bits are allocated to it from the remaining free bits in the mask. (See Figure
<a 
href="#x1-10031">1<!--tex4ht:ref: fig:mask_bits --></a>.)
</p><!--l. 46--><p class="noindent" >The SpaceMask thorn provides a set of routines for allocating bits within the mask, and for setting and checking
the mask state at individual points.
</p>
<hr class="figure" /><div class="figure" 
>
                                                                                       
                                                                                       
<a 
 id="x1-10031"></a>
                                                                                       
                                                                                       
<!--l. 52--><p class="noindent" ><img 
src="space_mask.png" alt="PIC"  
width="667" />
<br /> </p><div class="caption" 
><span class="id">Figure 1: </span><span  
class="content">The <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_RegisterType() </span>function allocates bits of the mask to a new “type” (eg.
“excision” and “colour” in the figure). The number of bits that are allocated is determined by the number
of possible states of the given type.</span></div><!--tex4ht:label?: x1-10031 -->
                                                                                       
                                                                                       
</div><hr class="endfigure" />
<h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>Using the mask</h3>
<!--l. 62--><p class="noindent" >A number of functions are provided for registering new types, and checking and setting mask values at a point.
The interface to these functions differs slightly for C and Fortran90 code.
</p><!--l. 66--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-30002.1"></a>Accessing the mask from C Code</h4>
<!--l. 68--><p class="noindent" >The following description describes the C interface for manipulating the mask. An example of code using these
functions can be found in Appendix <a 
href="#x1-140005.1">5.1<!--tex4ht:ref: app:eg_C --></a>.
</p><!--l. 72--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x1-40002.1.1"></a>Registering a new type</h5>
<!--l. 74--><p class="noindent" >Bits of the mask are allocated to a new type using the function:
</p><!--l. 76--><p class="noindent" > <span 
class="cmtt-10">int SpaceMask</span><span 
class="cmtt-10">_RegisterType(const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">, </span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       int </span><span 
class="cmitt-10">nstates</span><span 
class="cmtt-10">, const char* const </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_list</span><span 
class="cmtt-10">[]) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 89--><p class="noindent" >The name of the new type to be registered;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">nstates</span> </dt><dd 
class="description">
             <!--l. 89--><p class="noindent" >The number of states in the new type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_list</span> </dt><dd 
class="description">
             <!--l. 89--><p class="noindent" >A list of names, one for each state, or NULL.</p></dd></dl>
<!--l. 91--><p class="noindent" >An appropriate number of bits of the mask are allocated to hold a unique value for the \(n\) states specified by the
<span 
class="cmti-10">nstates </span>argument. The registration must take place before the type can be used, so for instance, this
could be scheduled at CCTK_STARTUP. The function returns a \(-1\) if the required states cannot be
allocated (for example, if there are not enough free bits remaining in the mask), otherwise it returns
\(0\).
                                                                                       
                                                                                       
</p><!--l. 99--><p class="noindent" >It is possible to allocate a portion of the mask without assigning names to any of the states by passing NULL as
the <span 
class="cmti-10">state</span><span 
class="cmti-10">_list</span>. This is useful when some integer number of states is required for a given type, but the number of
states and appropriate names are not known at compile time. States which are allocated in this way can be
accessed using the <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_GetStateBitsList()</span>.
</p><!--l. 106--><p class="noindent" >New states can be added to an already allocated type using the function:
</p><!--l. 109--><p class="noindent" > <span 
class="cmtt-10">int SpaceMask</span><span 
class="cmtt-10">_AppendStatesToType(const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">, </span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       int </span><span 
class="cmitt-10">nstates</span><span 
class="cmtt-10">, const char* const </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_list</span><span 
class="cmtt-10">[]) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 122--><p class="noindent" >The name of an already registered type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">nstates</span> </dt><dd 
class="description">
             <!--l. 122--><p class="noindent" >The number of states to be added;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_list</span> </dt><dd 
class="description">
             <!--l. 122--><p class="noindent" >A list of names, one for each of the new states.</p></dd></dl>
<!--l. 124--><p class="noindent" >A number of new bits will be added to the specified type appropriate to hold the number of existing states plus
the extra states. The allocated bits need not be contiguous within the mask. The function returns \(0\) if successful,
otherwise a \(-1\) if the new states could not be allocated.
</p><!--l. 131--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x1-50002.1.2"></a>Setting and checking mask states</h5>
<!--l. 133--><p class="noindent" >The state of the mask at a given point is set using the function:
                                                                                       
                                                                                       
</p><!--l. 135--><p class="noindent" > <span 
class="cmtt-10">void SpaceMask</span><span 
class="cmtt-10">_SetState(CCTK</span><span 
class="cmtt-10">_INT* </span><span 
class="cmitt-10">mask</span><span 
class="cmtt-10">, int </span><span 
class="cmitt-10">point</span><span 
class="cmtt-10">, </span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">, const char* </span><span 
class="cmitt-10">state</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">mask</span> </dt><dd 
class="description">
             <!--l. 149--><p class="noindent" >A pointer to the mask grid function;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">point</span> </dt><dd 
class="description">
             <!--l. 149--><p class="noindent" >The index of the point within the grid function array;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 149--><p class="noindent" >The name of the type containing the state;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 149--><p class="noindent" >The particular state to be set.</p></dd></dl>
<!--l. 151--><p class="noindent" >The state of the mask at a given point can be checked using:
</p><!--l. 153--><p class="noindent" > <span 
class="cmtt-10">int SpaceMask</span><span 
class="cmtt-10">_CheckState(const CCTK</span><span 
class="cmtt-10">_INT* </span><span 
class="cmitt-10">mask</span><span 
class="cmtt-10">, int </span><span 
class="cmitt-10">point</span><span 
class="cmtt-10">, </span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">, const char* </span><span 
class="cmitt-10">state</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">mask</span> </dt><dd 
class="description">
             <!--l. 167--><p class="noindent" >A pointer to the mask grid function;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">point</span> </dt><dd 
class="description">
             <!--l. 167--><p class="noindent" >The index of the point within the grid function array;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 167--><p class="noindent" >The name of the type containing the state;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 167--><p class="noindent" >The particular state to be compared.</p></dd></dl>
<!--l. 169--><p class="noindent" >The return value is 1 if the given <span 
class="cmti-10">state</span><span 
class="cmti-10">_name </span>has been set at the point, or 0 otherwise.
</p><!--l. 172--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.1.3   </span> <a 
 id="x1-60002.1.3"></a>Faster bitwise operators</h5>
<!--l. 174--><p class="noindent" >The above mentioned functions for checking and setting the mask are rather inefficient, since they require strings
                                                                                       
                                                                                       
to be compared at each point. A set of faster macros are provided which operate on the mask by performing bit
operations directly. In order to use these functions, the bitmasks corresponding to the desired type and it’s states
need to be obtained using the following functions:
</p><!--l. 181--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT SpaceMask</span><span 
class="cmtt-10">_GetTypeBits(const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 190--><p class="noindent" >The type for which the bitmask is to be determined.</p></dd></dl>
<!--l. 192--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT SpaceMask</span><span 
class="cmtt-10">_GetStateBits(const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">, const char* </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">)</span>
                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 202--><p class="noindent" >The type containing the state in question;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 202--><p class="noindent" >The state whose bitmask is to be determined.</p></dd></dl>
<!--l. 204--><p class="noindent" >Each of these functions returns a CCTK_INT8 which holds the bitmask corresponding to the given type or
state. For example, if a given type uses three bits of the mask, the returned value could be the
integer corresponding to the bitfield \(001110000\)…, where the location of \(1\)s indicates the bits which have been
allocated to the given type. A return value of \(0\) (GetTypeBits) or \(-1\) (GetStateBits) indicates that the
bitmask could not be determined for some reason (for example, the requested state was not previously
registered).
</p><!--l. 214--><p class="noindent" >All of the state masks allocated for a given type can be retrieved using the following function:
</p><!--l. 217--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT* SpaceMask</span><span 
class="cmtt-10">_GetStateBitsList(const char* </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 226--><p class="noindent" >The type for which the bitmask is to be determined.</p></dd></dl>
<!--l. 228--><p class="noindent" >The return value is a list of integers, with a length corresponding to the number of states of the given type.
Each of the entries is a bitmask which identifies the state. List entries are returned in the order in
which they were originally assigned. This allows for a simple correspondence between states and
integers (given by the index of the list entry). <span 
class="cmti-10">A fortran wrapper does not currently exist for this</span>
<span 
class="cmti-10">functionality.</span>
</p><!--l. 236--><p class="noindent" >The following macros have been defined for fast setting and checking of the mask by direct bitwise
operations:
                                                                                       
                                                                                       
</p><!--l. 239--><p class="noindent" > <span 
class="cmtt-10">void SpaceMask</span><span 
class="cmtt-10">_SetStateBits(CCTK</span><span 
class="cmtt-10">_INT* </span><span 
class="cmitt-10">mask</span><span 
class="cmtt-10">, int </span><span 
class="cmitt-10">point</span><span 
class="cmtt-10">, </span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_bits</span><span 
class="cmtt-10">, CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_bits</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">mask</span> </dt><dd 
class="description">
             <!--l. 255--><p class="noindent" >A pointer to the mask grid function;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">point</span> </dt><dd 
class="description">
             <!--l. 255--><p class="noindent" >The index of the point within the grid function array;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_bits</span> </dt><dd 
class="description">
             <!--l. 255--><p class="noindent" >The bitmask corresponding to the required type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_bits</span> </dt><dd 
class="description">
             <!--l. 255--><p class="noindent" >The bitmask corrsponding to the required state;</p></dd></dl>
<!--l. 257--><p class="noindent" > <span 
class="cmtt-10">int SpaceMask</span><span 
class="cmtt-10">_CheckStateBits(const CCTK</span><span 
class="cmtt-10">_INT* </span><span 
class="cmitt-10">mask</span><span 
class="cmtt-10">, int </span><span 
class="cmitt-10">point</span><span 
class="cmtt-10">, </span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_bits</span><span 
class="cmtt-10">, CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_bits</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">mask</span> </dt><dd 
class="description">
             <!--l. 273--><p class="noindent" >A pointer to the mask grid function;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">point</span> </dt><dd 
class="description">
             <!--l. 273--><p class="noindent" >The index of the point within the grid function array;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_bits</span> </dt><dd 
class="description">
             <!--l. 273--><p class="noindent" >The bitmask corresponding to the required type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_bits</span> </dt><dd 
class="description">
             <!--l. 273--><p class="noindent" >The bitmask corrsponding to the required state;</p></dd></dl>
<!--l. 275--><p class="noindent" >The latter macro returns a 1 if the given state has been set, a 0 otherwise. The <span 
class="cmti-10">type</span><span 
class="cmti-10">_bits </span>and <span 
class="cmti-10">state</span><span 
class="cmti-10">_bits </span>can be
obtained using the <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_Get*Bits </span>functions, described above.
</p><!--l. 280--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-70002.2"></a>Accessing the mask from Fortran90 Code</h4>
<!--l. 282--><p class="noindent" >The following Fortran interfaces to the mask utilities apply only to Fortran90 code, since fast bitwise operations
are not a part of the Fortran77 standard. An example of the use of the Fortran90 interface can be found in
                                                                                       
                                                                                       
Appendix <a 
href="#x1-150005.2">5.2<!--tex4ht:ref: app:eg_F90 --></a>.
</p><!--l. 287--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.1   </span> <a 
 id="x1-80002.2.1"></a>Registering a new type</h5>
<!--l. 289--><p class="noindent" >Registration functions have not been implemented for the Fortran90 interface, though they can
easily be written in C by following the descriptions in Section <a 
href="#x1-40002.1.1">2.1.1<!--tex4ht:ref: sec:reg_C --></a> and the example in Appendix
<a 
href="#x1-140005.1">5.1<!--tex4ht:ref: app:eg_C --></a>.
</p><!--l. 294--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.2   </span> <a 
 id="x1-90002.2.2"></a>Setting and checking mask states</h5>
<!--l. 296--><p class="noindent" >The mask states can be manipulated using the following functions:
</p><!--l. 298--><p class="noindent" > <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_SetState(CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">mask(,,)</span><span 
class="cmtt-10">, int </span><span 
class="cmitt-10">point</span><span 
class="cmtt-10">, character </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">,</span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       character </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">mask</span> </dt><dd 
class="description">
             <!--l. 312--><p class="noindent" >A pointer to the mask grid function;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">point</span> </dt><dd 
class="description">
             <!--l. 312--><p class="noindent" >The index of the point within the grid function array;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 312--><p class="noindent" >The name of the type containing the state; type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 312--><p class="noindent" >The name of the state to be set.</p></dd></dl>
<!--l. 314--><p class="noindent" >The value of the <span 
class="cmti-10">mask </span>variable is changed to turn on the specified state at the point.
                                                                                       
                                                                                       
</p><!--l. 317--><p class="noindent" > <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_CheckState(CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">check</span><span 
class="cmtt-10">, CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">mask(,,)</span><span 
class="cmtt-10">, int </span><span 
class="cmitt-10">point</span><span 
class="cmtt-10">,</span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       character </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">, character </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">check</span> </dt><dd 
class="description">
             <!--l. 334--><p class="noindent" >A variable which is set to 1 if the requested state has been set;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">mask</span> </dt><dd 
class="description">
             <!--l. 334--><p class="noindent" >A pointer to the mask grid function;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">point</span> </dt><dd 
class="description">
             <!--l. 334--><p class="noindent" >The index of the point within the grid function array;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 334--><p class="noindent" >The name of the type containing the state; type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 334--><p class="noindent" >The name of the state to be checked.</p></dd></dl>
<!--l. 336--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">2.2.3   </span> <a 
 id="x1-100002.2.3"></a>Faster bitwise operators</h5>
<!--l. 338--><p class="noindent" >As in the C interface, alternative bitwise operators have been defined in order to more quickly operate on the
mask at a point. In order to use these functions, the bitmasks corresponding to the type and states in question
must first be obtained using the following functions:
</p><!--l. 343--><p class="noindent" > <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_GetTypeBits(CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_bits</span><span 
class="cmtt-10">, character </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">)</span>
                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_bits</span> </dt><dd 
class="description">
             <!--l. 354--><p class="noindent" >A variable which will be set to the bitmask of the requested type;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 354--><p class="noindent" >A character string naming the type.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 356--><p class="noindent" > <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_GetStateBits(CCTK</span><span 
class="cmtt-10">_INT </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_bits</span><span 
class="cmtt-10">, character </span><span 
class="cmitt-10">type</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">,</span><br 
class="newline" /><span 
class="cmtt-10"> </span><span 
class="cmtt-10">       character </span><span 
class="cmitt-10">state</span><span 
class="cmitt-10">_name</span><span 
class="cmtt-10">) </span><br 
class="newline" />                  </p><dl class="description"><dt class="description">
         <span 
class="cmbxti-10">state</span><span 
class="cmbxti-10">_bits</span> </dt><dd 
class="description">
             <!--l. 369--><p class="noindent" >A variable which will be set to the bitmask of the requested state;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 369--><p class="noindent" >A character string naming the type containing the state;
                </p></dd><dt class="description">
         <span 
class="cmbxti-10">type</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">
             <!--l. 369--><p class="noindent" >A character string naming the state.</p></dd></dl>
<!--l. 371--><p class="noindent" >Once the bitmasks for the type and state have been obtained, the following macros can be used
directly:
</p><!--l. 374--><p class="noindent" > <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_SetStateBitsF90(mask, i, j, k, type</span><span 
class="cmtt-10">_bits, state</span><span 
class="cmtt-10">_bits) </span><br 
class="newline" />
</p><!--l. 378--><p class="noindent" >This macro sets the value of the mask at the index \((i,j,k)\) to the given state. It doesn’t have a return value, and can be
used directly inline (without a Fortran ‘call’).
</p><!--l. 382--><p class="noindent" > <span 
class="cmtt-10">SpaceMask</span><span 
class="cmtt-10">_CheckStateBitsF90(mask, i, j, k, type</span><span 
class="cmtt-10">_bits, state</span><span 
class="cmtt-10">_bits) </span><br 
class="newline" />
</p><!--l. 386--><p class="noindent" >A value of ‘<span 
class="cmtt-10">.true.</span>’ is returned if the given state has been set, or ‘<span 
class="cmtt-10">.false.</span>’ otherwise. The macro can be used
directly in Fortran boolean expressions, as in the examples in Appendix <a 
href="#x1-150005.2">5.2<!--tex4ht:ref: app:eg_F90 --></a>.
</p><!--l. 392--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-110003"></a>Notes</h3>
<!--l. 394--><p class="noindent" >A proposal exists to provide a more versatile solution by allowing tables to be associated with each grid point.
This could be implemented using the existing standard outlined here through the addition of an additional
integer grid function
</p><!--l. 399--><p class="noindent" ><span 
class="cmtt-10">space</span><span 
class="cmtt-10">_table</span><span 
class="cmtt-10">_field</span>
</p><!--l. 401--><p class="noindent" >A bit of the existing <span 
class="cmtt-10">space</span><span 
class="cmtt-10">_mask </span>would be allocated to indicate whether or not a table has been associated with
the given point. If so, then the corresponding point in the <span 
class="cmtt-10">space</span><span 
class="cmtt-10">_table</span><span 
class="cmtt-10">_field </span>would hold the table
handle.
                                                                                       
                                                                                       
</p><!--l. 407--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-120004"></a>Acknowledgements</h3>
<!--l. 409--><p class="noindent" >Thanks to Jonathan Thornburg, Tom Goodale, and Erik Schnetter for helpful comments on the original
specification. Useful implementation of the mask required grid symmetries to work for integer grid functions.
This was done by Thomas Radke. Peter Diener helped with the coding of the Fortran90 bitwise
operators.
</p><!--l. 415--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-130005"></a>Appendix</h3>
<!--l. 417--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-140005.1"></a>Example: C code</h4>
                                                                                       
                                                                                       
<pre class="verbatim" id="verbatim-1">
#include &#x0022;cctk.h&#x0022;
#include &#x0022;cctk_Arguments.h&#x0022;
#include &#x0022;cctk_Parameters.h&#x0022;

#include &#x0022;SpaceMask.h&#x0022;

/*
 * Register a mask type with three states.
 */
void Eg_RegisterMask (void)
{
  char *state_list_excision[3] = {&#x0022;normal&#x0022;, &#x0022;excise&#x0022;, &#x0022;boundary&#x0022;};

  SpaceMask_RegisterType(&#x0022;excision&#x0022;, 3, state_list_excision);

  return;
}

/*
 * Set the mask to the ‘‘normal’’ state at each point using the
 * slower name-reference function. See below for an example using
 * the faster bitwise operator to check the mask states.
 */
void Eg_SetMaskStates (CCTK_ARGUMENTS)
{
  DECLARE_CCTK_ARGUMENTS
  DECLARE_CCTK_PARAMETERS

  int i, j, k, ijk;

  for (k=0; k&#x003C;cctk_lsh[2]; ++k)
  {
    for (j=0; j&#x003C;cctk_lsh[1]; ++j)
    {
      for (i=0; i&#x003C;cctk_lsh[0]; ++i)
      {
        ijk = CCTK_GFINDEX3D(cctkGH, i, j, k);
 
        SpaceMask_SetState(space_mask, ijk, &#x0022;excision&#x0022;, &#x0022;normal&#x0022;);
      }
    }
  }
  return;
}

/*
 * Check which of the points of the mask have been set to the
                                                                                       
                                                                                       
 * ‘‘boundary’’ state using the bitwise macro.
 */
void Eg_CheckMaskStates (CCTK_ARGUMENTS)
{
  DECLARE_CCTK_ARGUMENTS
  DECLARE_CCTK_PARAMETERS

  int i, j, k, ijk;

  CCTK_INT excision_mask;
  CCTK_INT boundary_mask;

  excision_mask = SpaceMask_GetTypeBits(&#x0022;excision&#x0022;);
  boundary_mask = SpaceMask_GetStateBits(&#x0022;boundary&#x0022;);

  for (k=0; k&#x003C;cctk_lsh[2]; ++k)
  {
    for (j=0; j&#x003C;cctk_lsh[1]; ++j)
    {
      for (i=0; i&#x003C;cctk_lsh[0]; ++i)
      {
        ijk = CCTK_GFINDEX3D(cctkGH, i, j, k);

        if (SpaceMask_CheckStateBits(space_mask, ijk, excision_mask,
                                     boundary_mask))
        {
          CCTK_VINFO(CCTK_THORNSTRING,
                     &#x0022;Point (%d,%d,%d) is a boundary point.\n&#x0022;,
                     i, j, k);
        }
      }
    }
  }
  return;
}
</pre>
<!--l. 502--><p class="nopar" >
</p><!--l. 505--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-150005.2"></a>Example: Fortran90 code</h4>
                                                                                       
                                                                                       
<pre class="verbatim" id="verbatim-2">
#include &#x0022;cctk.h&#x0022;
#include &#x0022;cctk_Arguments.h&#x0022;
#include &#x0022;cctk_Parameters.h&#x0022;

#include &#x0022;SpaceMask.h&#x0022;

!
! Sets each point of the mask to the ’normal’ state. Here, ’normal’
! is one of the states of the ’excision’ type, which should have
! been registered previously using the C SpaceMask_RegisterType()
! function.
!
subroutine Eg_SetStateByName(CCTK_ARGUMENTS)
  implicit none

  integer ni, nj, nk
  integer i, j, k, ijk

  ni = cctk_lsh(1)
  nj = cctk_lsh(2)
  nk = cctk_lsh(3)

  do k=1,nk
     do j=1,nj
        do i=1,ni

           ijk = (i-1) + ni*((j-1) + nj*(k-1))

           call SpaceMask_SetState(space_mask, ijk, &#x0022;excision&#x0022;, &#x0022;normal&#x0022;)

        end do
     end do
  end do

end subroutine Eg_SetStateByName

!
! Sets the mask values within a radius of 1 to the ’excise’ state,
! then does a check of the state of each point.  The bitwise macros
! are used in this case for greater efficiency in setting/checking
! the mask.
!
subroutine Eg_SetExcisedRegionByBitmask(CCTK_ARGUMENTS)
  implicit none

  integer ni, nj, nk
  integer i, j, k, ijk
                                                                                       
                                                                                       

  CCTK_INT type_bits, excised

  ni = cctk_lsh(1)
  nj = cctk_lsh(2)
  nk = cctk_lsh(3)

  call SpaceMask_GetTypeBits(type_bits, &#x0022;excision&#x0022;)
  call SpaceMask_GetStateBits(excised, &#x0022;excision&#x0022;, &#x0022;excised&#x0022;)

  do k=1,nk
     do j=1,nj
        do i=1,ni

           if (r(i,j,k).lt.1.d0) then
              SpaceMask_SetStateBitsF90(space_mask, i, j, k, type_bits, &#x0026;
                   excised)
           end if

        end do
     end do
  end do

  do k=1,nk
     do j=1,nj
        do i=1,ni
           if (SpaceMask_CheckStateBitsF90(space_mask, i, j, k, type_bits, &#x0026;
                excised)) then
              write(*,*) &#x0022;The point (&#x0022;, i, j, k, &#x0022;) has been excised.&#x0022;
           end if
        end do
     end do
  end do

end subroutine Eg_SetExcisedRegionByBitmask
</pre>
<!--l. 590--><p class="nopar" >
</p><!--l. 597--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-160006"></a>Parameters</h3>
<!--l. 616--><p class="noindent" ></p> <table id="TBL-2" class="tabular" 
 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2" /><col 
id="TBL-2-3" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:normal; text-align:left;" id="TBL-2-1-1"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;">use_mask</div></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"  
class="td10"> <span 
class="cmbx-10">Scope: </span>restricted</td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-1-3"  
class="td01">                                           BOOLEAN  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td colspan="3" style="white-space:normal; text-align:left;" id="TBL-2-2-1"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;"><span 
class="cmbx-10">Description: </span><span 
class="cmti-10">Turn on storage for mask?</span></div>                                                                      
</td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-3-1"  
class="td11">          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"  
class="td10">                </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-3-3"  
class="td01">                                          <span 
class="cmbx-10">Default: </span>no  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-4-1"  
class="td11">          </td></tr></table>
                                                                                       
                                                                                       
<!--l. 625--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-170007"></a>Interfaces</h3>
<!--l. 630--><p class="noindent" >
</p>
<h4 class="likesubsectionHead"><a 
 id="x1-18000"></a>General</h4>
<!--l. 632--><p class="noindent" ><span 
class="cmbx-10">Implements</span>:
</p><!--l. 634--><p class="noindent" >spacemask
</p><!--l. 637--><p class="noindent" ><span 
class="cmbx-10">Inherits</span>:
</p><!--l. 639--><p class="noindent" >grid
</p>
<h4 class="likesubsectionHead"><a 
 id="x1-19000"></a>Grid Variables</h4>
<!--l. 642--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">7.0.1   </span> <a 
 id="x1-200007.0.1"></a>PUBLIC GROUPS</h5>
<!--l. 646--><p class="noindent" ></p> <table id="TBL-3" class="tabular" 
 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1" /></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2" /></colgroup><colgroup id="TBL-3-3g"><col 
id="TBL-3-3" /><col 
id="TBL-3-4" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-1"  
class="td11">   <span 
class="cmbx-10">Group Names </span>   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-2"  
class="td10">   <span 
class="cmbx-10">Variable Names </span> </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-1-3"  
class="td01">    <span 
class="cmbx-10">Details </span>   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-4"  
class="td11">                                                                 </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-1"  
class="td11">  space_mask_group   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-2-3"  
class="td01">     compact  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-4"  
class="td11"> 0                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-2"  
class="td10">     space_mask       </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-3-3"  
class="td01">   dimensions  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-4"  
class="td11"> 3                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-4-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-4-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-4-3"  
class="td01">  distribution  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-4"  
class="td11"> DEFAULT                                                   </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-5-1"  
class="td11">
                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-5-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-5-3"  
class="td01">   group type  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-4"  
class="td11"> GF                                                            </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-6-1"  
class="td11">
                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-6-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-6-3"  
class="td01">         tags  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-4"  
class="td11"> tensortypealias=”Scalar” Prolongation=”None”  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-7-1"  
class="td11"> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-7-2"  
class="td10"> </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-7-3"  
class="td01"> timelevels </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-4"  
class="td11"> 1 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-8-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-8-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-8-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-8-3"  
class="td01"> variable type  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-8-4"  
class="td11"> INT                                                           </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-9-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-9-1"  
class="td11">        mask            </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-9-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-9-3"  
class="td01">     compact  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-9-4"  
class="td11"> 0                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-10-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-10-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-10-2"  
class="td10">        emask          </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-10-3"  
class="td01">   description  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-10-4"  
class="td11"> Mask                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-11-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-11-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-11-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-11-3"  
class="td01">   dimensions  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-11-4"  
class="td11"> 3                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-12-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-12-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-12-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-12-3"  
class="td01">  distribution  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-12-4"  
class="td11"> DEFAULT                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-13-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-13-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-13-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-13-3"  
class="td01">   group type  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-13-4"  
class="td11"> GF                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-14-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-14-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-14-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-14-3"  
class="td01">         tags  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-14-4"  
class="td11"> tensortypealias=”Scalar” Prolongation=”None”  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-15-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-15-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-15-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-15-3"  
class="td01">    timelevels  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-15-4"  
class="td11"> 1                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-16-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-16-1"  
class="td11">                    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-16-2"  
class="td10">                    </td><td  style="white-space:nowrap; text-align:right;" id="TBL-3-16-3"  
class="td01"> variable type  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-16-4"  
class="td11"> REAL                                                        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-17-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-17-1"  
class="td11">                    </td></tr></table>
<!--l. 672--><p class="noindent" ><span 
class="cmbx-10">Adds header</span>:
</p><!--l. 676--><p class="noindent" >SpaceMask.h
</p><!--l. 679--><p class="noindent" ><span 
class="cmbx-10">Uses header</span>:
</p><!--l. 681--><p class="noindent" >Symmetry.h
</p><!--l. 684--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-210008"></a>Schedule</h3>
                                                                                       
                                                                                       
<!--l. 690--><p class="noindent" >This section lists all the variables which are assigned storage by thorn CactusNumerical/SpaceMask. Storage can
either last for the duration of the run (<span 
class="cmbx-10">Always </span>means that if this thorn is activated storage will
be assigned, <span 
class="cmbx-10">Conditional </span>means that if this thorn is activated storage will be assigned for the
duration of the run if some condition is met), or can be turned on for the duration of a schedule
function.
</p><!--l. 693--><p class="noindent" >
</p>
<h4 class="likesubsectionHead"><a 
 id="x1-22000"></a>Storage</h4>
<!--l. 695--><p class="noindent" > 
</p><!--l. 697--><p class="noindent" ></p> <table id="TBL-4" class="tabular" 
 
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1" /><col 
id="TBL-4-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-4-1-2"  
class="td11"> <span 
class="cmbx-10">Conditional:       </span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-2-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-4-2-2"  
class="td11"> space_mask_group</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-3-1"  
class="td11">     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-4-3-2"  
class="td11"> mask                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-4-1"  
class="td11">     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-4-4-2"  
class="td11">                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-5-1"  
class="td11">    </td></tr></table>
<!--l. 705--><p class="noindent" >
</p>
<h4 class="likesubsectionHead"><a 
 id="x1-23000"></a>Scheduled Functions</h4>
<!--l. 708--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_BASEGRID </span>(conditional)
</p><!--l. 710--><p class="noindent" >      maskzero
</p><!--l. 712--><p class="noindent" >     <span 
class="cmti-10">initialise mask to zero</span>
</p><!--l. 715--><p class="noindent" > 
</p><!--l. 717--><p class="noindent" ></p> <table id="TBL-5" class="tabular" 
 
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1" /><col 
id="TBL-5-2" /><col 
id="TBL-5-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-1-3"  
class="td11"> c                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-2-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-2-3"  
class="td11"> function                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-3-2"  
class="td11"> Writes:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-3-3"  
class="td11"> spacemask::space_mask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-4-1"  
class="td11">    </td></tr></table>
<!--l. 726--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_WRAGH </span>(conditional)
</p><!--l. 728--><p class="noindent" >      masksym
</p><!--l. 730--><p class="noindent" >     <span 
class="cmti-10">set grid symmetries for mask</span>
</p><!--l. 733--><p class="noindent" > 
</p><!--l. 735--><p class="noindent" ></p> <table id="TBL-6" class="tabular" 
 
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1" /><col 
id="TBL-6-2" /><col 
id="TBL-6-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-6-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-1-3"  
class="td11"> c           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-6-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-2-2"  
class="td11"> Options:    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-2-3"  
class="td11"> global     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-6-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-3-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-3-3"  
class="td11"> function  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-6-4-1"  
class="td11">    </td></tr></table>
<!--l. 744--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_POSTREGRIDINITIAL </span>(conditional)
</p><!--l. 746--><p class="noindent" >      maskzero
</p><!--l. 748--><p class="noindent" >     <span 
class="cmti-10">initialise mask to zero</span>
</p><!--l. 751--><p class="noindent" > 
</p><!--l. 753--><p class="noindent" ></p> <table id="TBL-7" class="tabular" 
 
><colgroup id="TBL-7-1g"><col 
id="TBL-7-1" /><col 
id="TBL-7-2" /><col 
id="TBL-7-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-7-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-7-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-1-3"  
class="td11"> c                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-7-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-2-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-2-3"  
class="td11"> function                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-7-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-3-2"  
class="td11"> Writes:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-3-3"  
class="td11"> spacemask::space_mask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-7-4-1"  
class="td11">    </td></tr></table>
<!--l. 762--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_POSTREGRID </span>(conditional)
</p><!--l. 764--><p class="noindent" >      maskzero
</p><!--l. 766--><p class="noindent" >     <span 
class="cmti-10">initialise mask to zero</span>
</p><!--l. 769--><p class="noindent" > 
</p><!--l. 771--><p class="noindent" ></p> <table id="TBL-8" class="tabular" 
 
><colgroup id="TBL-8-1g"><col 
id="TBL-8-1" /><col 
id="TBL-8-2" /><col 
id="TBL-8-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-8-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-8-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-1-3"  
class="td11"> c                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-8-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-2-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-2-3"  
class="td11"> function                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-8-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-3-2"  
class="td11"> Writes:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-3-3"  
class="td11"> spacemask::space_mask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-8-4-1"  
class="td11">    </td></tr></table>
<!--l. 780--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_WRAGH </span>(conditional)
                                                                                       
                                                                                       
</p><!--l. 782--><p class="noindent" >      masksym_emask
</p><!--l. 784--><p class="noindent" >     <span 
class="cmti-10">set grid symmetries for emask (compatibility mode)</span>
</p><!--l. 787--><p class="noindent" > 
</p><!--l. 789--><p class="noindent" ></p> <table id="TBL-9" class="tabular" 
 
><colgroup id="TBL-9-1g"><col 
id="TBL-9-1" /><col 
id="TBL-9-2" /><col 
id="TBL-9-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-9-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-9-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-1-3"  
class="td11"> c           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-9-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-2-2"  
class="td11"> Options:    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-2-3"  
class="td11"> global     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-9-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-3-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-3-3"  
class="td11"> function  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-9-4-1"  
class="td11">    </td></tr></table>
<!--l. 798--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_BASEGRID </span>(conditional)
</p><!--l. 800--><p class="noindent" >      maskone
</p><!--l. 802--><p class="noindent" >     <span 
class="cmti-10">set old style mask to one</span>
</p><!--l. 805--><p class="noindent" > 
</p><!--l. 807--><p class="noindent" ></p> <table id="TBL-10" class="tabular" 
 
><colgroup id="TBL-10-1g"><col 
id="TBL-10-1" /><col 
id="TBL-10-2" /><col 
id="TBL-10-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-10-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-10-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-1-3"  
class="td11"> c                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-10-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-2-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-2-3"  
class="td11"> function                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-10-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-3-2"  
class="td11"> Writes:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-3-3"  
class="td11"> spacemask::emask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-10-4-1"  
class="td11">    </td></tr></table>
<!--l. 816--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_POSTSTEP </span>(conditional)
</p><!--l. 818--><p class="noindent" >      checkmask
</p><!--l. 820--><p class="noindent" >     <span 
class="cmti-10">ensure that all mask values are legal</span>
</p><!--l. 823--><p class="noindent" > 
</p><!--l. 825--><p class="noindent" ></p> <table id="TBL-11" class="tabular" 
 
><colgroup id="TBL-11-1g"><col 
id="TBL-11-1" /><col 
id="TBL-11-2" /><col 
id="TBL-11-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-11-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-11-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-1-3"  
class="td11"> c                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-11-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-2-2"  
class="td11"> Reads:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-2-3"  
class="td11"> spacemask::emask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-11-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-3-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-3-3"  
class="td11"> function                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-11-4-1"  
class="td11">    </td></tr></table>
<!--l. 834--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_POSTREGRIDINITIAL </span>(conditional)
</p><!--l. 836--><p class="noindent" >      maskone
</p><!--l. 838--><p class="noindent" >     <span 
class="cmti-10">set mask to one</span>
</p><!--l. 841--><p class="noindent" > 
</p><!--l. 843--><p class="noindent" ></p> <table id="TBL-12" class="tabular" 
 
><colgroup id="TBL-12-1g"><col 
id="TBL-12-1" /><col 
id="TBL-12-2" /><col 
id="TBL-12-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-12-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-12-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-3"  
class="td11"> c                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-12-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-3"  
class="td11"> function                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-12-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-2"  
class="td11"> Writes:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-3"  
class="td11"> spacemask::emask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-12-4-1"  
class="td11">    </td></tr></table>
<!--l. 852--><p class="noindent" ><span 
class="cmbx-10">CCTK</span><span 
class="cmbx-10">_POSTREGRID </span>(conditional)
</p><!--l. 854--><p class="noindent" >      maskone
</p><!--l. 856--><p class="noindent" >     <span 
class="cmti-10">set mask to one</span>
</p><!--l. 859--><p class="noindent" > 
</p><!--l. 861--><p class="noindent" ></p> <table id="TBL-13" class="tabular" 
 
><colgroup id="TBL-13-1g"><col 
id="TBL-13-1" /><col 
id="TBL-13-2" /><col 
id="TBL-13-3" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-13-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-13-1-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-13-1-2"  
class="td11"> Language:  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-13-1-3"  
class="td11"> c                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-13-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-13-2-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-13-2-2"  
class="td11"> Type:        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-13-2-3"  
class="td11"> function                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-13-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-13-3-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-13-3-2"  
class="td11"> Writes:      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-13-3-3"  
class="td11"> spacemask::emask(everywhere)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-13-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-13-4-1"  
class="td11">    </td></tr></table>
 
</body></html> 

                                                                                       


