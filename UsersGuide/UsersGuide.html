<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- mathjax,charset=utf-8,html,xhtml --> 
<meta name="src" content="UsersGuide.tex" /> 
<link rel="stylesheet" type="text/css" href="UsersGuide.css" /> 
<script>window.MathJax = { tex: { tags: "ams", }, }; </script> 
 <script type="text/javascript" async="async" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>  
</head><body 
>
<div class="center" 
>
<!--l. 62--><p class="noindent" >
</p><!--l. 62--><p class="noindent" ><span 
class="cmr-17x-x-143">Cactus 4.18</span><br />
<span 
class="cmr-17x-x-143">Users’ Guide</span>
</p><!--l. 62--><p class="noindent" ><img 
src="bincactus2.png" alt="PIC"  
width="142" />
</p><!--l. 62--><p class="noindent" >commit 7081ec6a0b60a9fe9abdf72b1916e9d843d4b2b4<br />
Documentation compiled on: January 22, 2026</p></div>
<!--l. 84--><p class="noindent" >
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p><!--l. 20--><p class="noindent" ><span 
class="cmbx-12">Preface</span> <a 
 id="x1-1doc"></a>
</p><!--l. 25--><p class="noindent" >This document contains a quick-start guide to installing and running a Cactus application. In subsequent
chapters, it provides more detailed information on advanced user’s topics, as well as an introduction
to thorn writing. Please report omissions, errors, or suggestions to any of our contact addresses
below.
</p><!--l. 34--><p class="noindent" ><span 
class="cmbx-10">Overview of documentation</span>
                  </p><dl class="list1"><dt class="list">
<span 
class="cmssbx-10">Part</span><span 
class="cmssbx-10"> </span><a 
href="#x1-1000A"><span 
class="cmssbx-10">A</span><!--tex4ht:ref: part:Introduction --></a><span 
class="cmssbx-10">: Introduction to Cactus.</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 38--><p class="noindent" >A guide through the process of obtaining and installing Cactus and running a simple
                  example application with it.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Part</span><span 
class="cmssbx-10"> </span><a 
href="#x1-13000B"><span 
class="cmssbx-10">B</span><!--tex4ht:ref: part:Notes --></a><span 
class="cmssbx-10">: Additional Notes.</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 42--><p class="noindent" >A  more  in-depth  description  of  required  hardware  and  software,  along  with
                  configuration,  installation  and  running  options.  Describes  how  to  check  the
                  installation with Cactus test suites.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Part</span><span 
class="cmssbx-10"> </span><a 
href="#x1-38000C"><span 
class="cmssbx-10">C</span><!--tex4ht:ref: part:ThornWriting --></a><span 
class="cmssbx-10">: Thorn Writing.</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 47--><p class="noindent" >An introduction to thorn concepts and description of how to create, write and
                  maintain  application  thorns.  Explanation  of  use  of  the  programming  interface
                  to  take  advantage  of  parallelism  and  modularity.  This  is  followed  by  a  more
                  advanced  discussion  of  user  supplied  infrastructure  routines  such  as  additional
                  <span 
class="cmti-10">output routines</span>, <span 
class="cmti-10">drivers</span>, etc.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Part</span><span 
class="cmssbx-10"> </span><a 
href="#x1-176000D"><span 
class="cmssbx-10">D</span><!--tex4ht:ref: part:Appendices --></a><span 
class="cmssbx-10">: Appendices.</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 55--><p class="noindent" >These contain a glossary, a description of the Cactus Configuration Language, the
                  Utility routines and other odds and ends, such as how to use GNATS and TAGS.
</p>
                  </dd></dl>
<!--l. 62--><p class="noindent" >Related topics are discussed in separate documents including:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmssbx-10">Reference Manual</span>  </dt><dd 
class="list">
                  <!--l. 66--><p class="noindent" >Contains detailed descriptions of the functions provided by the Cactus flesh API,
                  along with other reference material.
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<!--l. 85--><p class="noindent" ><span 
class="cmbx-10">Typographical Conventions</span>
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">Typewriter</span>        </dt><dd 
class="list">
                  <!--l. 89--><p class="noindent" >Is currently used for everything you type, for program names, and code extracts.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">&#x003C; ... &#x003E;</span>           </dt><dd 
class="list">
                  <!--l. 91--><p class="noindent" >Indicates a compulsory argument.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">[ ... ]</span>           </dt><dd 
class="list">
                  <!--l. 92--><p class="noindent" >Indicates an optional argument.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">|</span>                 </dt><dd 
class="list">
                  <!--l. 93--><p class="noindent" >Indicates an exclusive or.
</p>
                  </dd></dl>
<!--l. 99--><p class="noindent" ><span 
class="cmbx-10">How to Contact Us</span>
</p><!--l. 103--><p class="noindent" >Please let us know of any errors or omissions in this guide, as well as suggestions for future editions. These can
be reported via email to <span 
class="cmtt-10">cactusmaint@cactuscode.org</span>.
</p><!--l. 110--><p class="noindent" ><span 
class="cmbx-10">Acknowledgements</span>
</p><!--l. 114--><p class="noindent" >Hearty thanks to all those who have helped with documentation for the Cactus Code. Special thanks to those
who struggled with the earliest sparse versions of this guide and sent in mistakes and suggestions, in particular
John Baker, Carsten Gundlach, Ginny Hudak-David, Sai Iyer, Paul Lamping, Nancy Tran and Ed
Seidel.
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
<h1 class="partHead"><span class="titlemark">Part A<br /></span><a 
 id="x1-1000A"></a>Introduction</h1>
<!--l. 11--><p class="noindent" >
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter A1</span><br /><a 
 id="x1-2000A1"></a>Getting Started</h2>
<h3 class="sectionHead"><span class="titlemark">A1.1   </span> <a 
 id="x1-3000A1.1"></a>Obtaining Cactus</h3>
<!--l. 26--><p class="noindent" >Cactus is distributed, extended, and maintained using the free git software (<a 
href="https://git-scm.com/" class="url" ><span 
class="cmtt-10">https://git-scm.com/</span></a>) git allows
many people to work on a large software project together without getting into a tangle. Since Cactus thorns are
distributed from several repositories on the main git site, and from a growing number of user sites, we provide a
<span 
class="cmtt-10">GetComponents </span>script on our website for checking out the flesh and thorns. The script is available
at
</p><!--l. 35--><p class="noindent" ><a 
href="https://github.com/gridaphobe/CRL/raw/master/GetComponents" class="url" ><span 
class="cmtt-10">https://github.com/gridaphobe/CRL/raw/master/GetComponents</span></a>.
</p><!--l. 37--><p class="noindent" >The script takes as an argument the name of a file containing a <span 
class="cmti-10">ThornList</span>, that is a list of thorns with the
syntax </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">arrangement</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;/&#x003C;</span><span 
class="cmsltt-10">thorn</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div>
<!--l. 44--><p class="noindent" >Optional directives in the ThornList indicate which repository to fetch thorns from. The ThornList is written in the <span 
class="cmti-10">Component</span>
<span 
class="cmti-10">Retrieval Language</span>, documented at <a 
href="https://github.com/gridaphobe/CRL/wiki/Component-Retrieval-Language" class="url" ><span 
class="cmtt-10">https://github.com/gridaphobe/CRL/wiki/Component-Retrieval-Language</span></a>.
</p><!--l. 49--><p class="noindent" >The same script can be used to checkout additional thorns, or to update existing ones.
</p><!--l. 52--><p class="noindent" >The components that make up Cactus can also be checked out directly using git from
<a 
href="https://bitbucket.org/cactuscode/" class="url" ><span 
class="cmtt-10">https://bitbucket.org/cactuscode/</span></a>.
</p><!--l. 55--><p class="noindent" >Another script, <span 
class="cmtt-10">MakeThornList</span>, can be used to produce a minimal ThornList from a given Cactus par file. It
needs a <span 
class="cmti-10">master </span>ThornList to be copied into your <span 
class="cmtt-10">Cactus </span>directory.
</p><!--l. 59--><p class="noindent" >See <a 
href="http://www.cactuscode.org/download/thorns/MakeThornList" class="url" ><span 
class="cmtt-10">http://www.cactuscode.org/download/thorns/MakeThornList</span></a>.
</p><!--l. 64--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">A1.1.1   </span> <a 
 id="x1-4000A1.1.1"></a>Directory Structure</h4>
<!--l. 67--><p class="noindent" >A fresh checkout creates a directory <span 
class="cmtt-10">Cactus </span>with the following subdirectories:
</p><!--l. 70--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
                                                                                       
                                                                                       
<span 
class="cmtt-10">repos</span>             </dt><dd 
class="list">
                  <!--l. 72--><p class="noindent" >created by GetComponents to hold the checked out repositories
                  </p></dd><dt class="list">
<span 
class="cmtt-10">doc</span>               </dt><dd 
class="list">
                  <!--l. 75--><p class="noindent" >Cactus documentation
                  </p></dd><dt class="list">
<span 
class="cmtt-10">lib</span>               </dt><dd 
class="list">
                  <!--l. 77--><p class="noindent" >contains libraries
                  </p></dd><dt class="list">
<span 
class="cmtt-10">src</span>               </dt><dd 
class="list">
                  <!--l. 79--><p class="noindent" >contains the source code for Cactus
                  </p></dd><dt class="list">
<span 
class="cmtt-10">arrangements</span>      </dt><dd 
class="list">
                  <!--l. 81--><p class="noindent" >contains  the  Cactus  arrangements.  The  arrangements  (the  actual  “physics”)
                  are  not  supplied  by  just  checking  out  just  Cactus.  If  the  arrangements  you
                  want to use are standard Cactus arrangements, or reside on our git repository
                  (<span 
class="cmtt-10">https://bitbucket.org/cactuscode/</span>), they can be checked out in similar way
                  to the flesh.</p></dd></dl>
<!--l. 88--><p class="noindent" >When Cactus is first compiled, it creates a new directory <span 
class="cmtt-10">Cactus/configs</span>, which will contain all the source
code, object files and libraries created during the build process.
</p><!--l. 92--><p class="noindent" >Configurations are described in detail in Section <a 
href="#x1-6000A1.2.1">A1.2.1<!--tex4ht:ref: sec:configurations --></a>.
</p><!--l. 96--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">A1.2   </span> <a 
 id="x1-5000A1.2"></a>Compiling a Cactus application</h3>
<!--l. 101--><p class="noindent" >Cactus can be built in different configurations from the same copy of the source files, and these different
configurations coexist in the <span 
class="cmtt-10">Cactus/configs </span>directory. Here are several instances in which this can be
useful:
</p><!--l. 106--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-5002x1">
     <!--l. 107--><p class="noindent" >Different configurations can be for <span 
class="cmti-10">different architectures</span>. You can keep executables for multiple
     architectures based on a single copy of source code, shared on a common file system.
     </p></li>
<li 
  class="enumerate" id="x1-5004x2">
                                                                                       
                                                                                       
     <!--l. 111--><p class="noindent" > You can compare different <span 
class="cmti-10">compiler options</span>, and <span 
class="cmti-10">debug-modes</span>. You might want to compile different
     communication protocols (e.g. MPI or Globus), or leave them out all together.
     </p></li>
<li 
  class="enumerate" id="x1-5006x3">
     <!--l. 114--><p class="noindent" > You can have different configurations for <span 
class="cmti-10">different thorn collections </span>compiled into your executable.</p></li></ol>
<!--l. 119--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">A1.2.1   </span> <a 
 id="x1-6000A1.2.1"></a>Creating a Configuration</h4>
<!--l. 122--><p class="noindent" >At its simplest, this is done by <span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;</span>. This generates a configuration with the name <span 
class="cmsltt-10">config</span>, doing its
best to automatically determine the default compilers and compilation flags suitable for the current
architecture.
</p><!--l. 128--><p class="noindent" >There are a number of additional command-line arguments which may be supplied to override some parts of the
procedure; they are listed in Section <a 
href="#x1-19000B2.1">B2.1<!--tex4ht:ref: sec:confopts --></a>.
</p><!--l. 131--><p class="noindent" >Once you have created a new configuration, the command <br 
class="newline" /><br 
class="newline" /><span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">configuration name</span><span 
class="cmtt-10">&#x003E; </span><br 
class="newline" /><br 
class="newline" />will build an executable, prompting you along the way for the thorns which should be included. There is a range
of <span 
class="cmtt-10">gmake </span>targets and options which are detailed in Section <a 
href="#x1-25000B2.4.1">B2.4.1<!--tex4ht:ref: sec:gmtafobuanadco --></a>.
</p><!--l. 142--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">A1.3   </span> <a 
 id="x1-7000A1.3"></a>Running a Cactus application</h3>
<!--l. 144--><p class="noindent" >Cactus executables always run from a parameter file (which may be provided as a command-line argument taken
from standard input), which specifies which thorns to use and sets the values of each thorn’s parameters (the
parameters that are not set will take on default values, see <a 
href="#x1-185000D2.3">D2.3<!--tex4ht:ref: sec:Appendix.param --></a>).
</p><!--l. 150--><p class="noindent" >There is no restriction on the name of the parameter file, although it is conventional to use the file extension
<span 
class="cmtt-10">.par</span>. Optional command-line arguments can be used to customise runtime behaviour, and to provide
information about the thorns used in the executable. The general syntax for running Cactus from a parameter
file is then
</p><!--l. 158--><p class="noindent" ><span 
class="cmtt-10">./cactus</span><span 
class="cmtt-10">_&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E; &#x003C;</span><span 
class="cmsltt-10">parameter file</span><span 
class="cmtt-10">&#x003E; [</span><span 
class="cmsltt-10">command-line options</span><span 
class="cmtt-10">]</span>
</p><!--l. 160--><p class="noindent" >A parameter file is a text file whose lines are either comments or parameter statements. Comments are blank
lines or lines that begin with ‘<span 
class="cmtt-10">#</span>’. A parameter statement consists of one or more parameter names, followed by
an ‘<span 
class="cmtt-10">=</span>’, followed by the value(s) for this (these) parameter(s). Note that all string parameters are case
insensitive.
                                                                                       
                                                                                       
</p><!--l. 167--><p class="noindent" >The first parameter statement in any parameter file should set <span 
class="cmtt-10">ActiveThorns</span>, which is a special parameter that
tells the program which <span 
class="cmti-10">thorns </span>are to be activated. Only parameters from active thorns can be set (and only
those routines <span 
class="cmti-10">scheduled </span>by active thorns are run). By default all thorns are inactive. For example, the first entry
in a parameter file which is using just the two thorns <span 
class="cmtt-10">CactusPUGH/PUGH </span>and <span 
class="cmtt-10">CactusBase/CartGrid3D </span>should
be
</p><!--l. 175--><p class="noindent" ><span 
class="cmtt-10">ActiveThorns = &#x0022;PUGH CartGrid3D&#x0022;</span>
</p><!--l. 177--><p class="noindent" >Parameter specifications following <span 
class="cmtt-10">ActiveThorns </span>usually are carried out by listing the name of the <span 
class="cmti-10">thorn </span>which
defined the parameter, two colons, and the name of the parameter — e.g. <span 
class="cmtt-10">wavetoyF77::amplitude </span>(see
Section <a 
href="#x1-74000C1.4.2">C1.4.2<!--tex4ht:ref: sec:Cactus_parameters.scope --></a> for more information).
</p><!--l. 183--><p class="noindent" >Notes:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 187--><p class="noindent" > You can obtain lists of the parameters associated with each thorn using the command-line options
     <span 
class="cmtt-10">-o </span>and <span 
class="cmtt-10">-O </span>(Section <a 
href="#x1-32000B3.1">B3.1<!--tex4ht:ref: sec:command_line_options --></a>).
     </p></li>
     <li class="itemize">
     <!--l. 191--><p class="noindent" > For examples of parameter files, look in the <span 
class="cmtt-10">par </span>directory which can be found in most thorns.
     </p></li>
     <li class="itemize">
     <!--l. 194--><p class="noindent" > The Cactus make system provides a mechanism for generating a <span 
class="cmti-10">Thorn Guide </span>containing separate
     chapters for each thorn and arrangement in your configuration. Details about parameters, grid
     variables and scheduling are automatically included in from a thorn’s CCL files into the Thorn
     Guide. To construct a Thorn Guide for the configuration \(&lt;\)<span 
class="cmsltt-10">config</span>\(&gt;\) use
     </p><!--l. 203--><p class="noindent" ><span 
class="cmtt-10">gmake</span> \(&lt;\)<span 
class="cmsltt-10">config</span>\(&gt;\)<span 
class="cmtt-10">-ThornGuide </span>.
</p>
     </li></ul>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter A2</span><br /><a 
 id="x1-8000A2"></a>Getting and looking at output</h2>
<h3 class="sectionHead"><span class="titlemark">A2.1   </span> <a 
 id="x1-9000A2.1"></a>Screen output</h3>
<!--l. 216--><p class="noindent" >As your Cactus executable runs, standard output and standard error are usually written to the screen. Standard
output provides you with information about the run, and standard error reports warnings and errors from the
flesh and thorns.
</p><!--l. 221--><p class="noindent" >As the program runs, the normal output provides the following information:
</p><!--l. 223--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">Active thorns</span>        </dt><dd 
class="list">
                  <!--l. 225--><p class="noindent" >A report is made as each of the thorns in the <span 
class="cmtt-10">ActiveThorns </span>parameters from the
                  parameter file (see Section <a 
href="#x1-33000B3.2">B3.2<!--tex4ht:ref: sec:Parameter_File --></a>) is attempted to be activated. This report shows
                  whether the thorn activation was successful, and if successful gives the thorn’s
                  implementation. For example
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-1">
                  Activating thorn idscalarwave...Success -&#x003E; active implementation idscalarwave
</pre>
                  <!--l. 234--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">Failed parameters</span>    </dt><dd 
class="list">
                  <!--l. 236--><p class="noindent" >If any of the parameters in the parameter file does not belong to any of the active thorns,
                  or if the parameter value is not in the allowed range (see Section <a 
href="#x1-68000C1.4.1">C1.4.1<!--tex4ht:ref: sec:Parameters.Types_and_Ranges --></a>), an error is
                  registered. For example, if the parameter is not recognised
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-2">
                  Unknown parameter time::ddtfac
</pre>
                  <!--l. 244--><p class="nopar" >or if the parameter value is not in the allowed range
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-3">
                  Unable to set keyword CartGrid3D::type - ByMouth not in any active range
</pre>
                  <!--l. 249--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">Scheduling information</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 251--><p class="noindent" >The scheduled routines (see Section <a 
href="#x1-76000C1.5">C1.5<!--tex4ht:ref: chap:scheduling --></a>), are listed, in the order that they will be
                  executed. For example
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-4">
                  ----------------------------------------------------------------------
                    Startup routines
                      Cactus: Register banner for Cactus
                      CartGrid3D: Register GH Extension for GridSymmetry
                      CartGrid3D: Register coordinates for the Cartesian grid
                      IOASCII: Startup routine
                      IOBasic: Startup routine
                      IOUtil: IOUtil startup routine
                      PUGH: Startup routine
                      WaveToyC: Register banner
                  
                    Parameter checking routines
                      CartGrid3D: Check coordinates for CartGrid3D
                      IDScalarWave: Check parameters
                  
                    Initialisation
                      CartGrid3D: Set up spatial 3D Cartesian coordinates on the GH
                      PUGH: Report on PUGH set up
                      Time: Set timestep based on speed one Courant condition
                      WaveToyC: Schedule symmetries
                      IDScalarWave: Initial data for 3D wave equation
                  
                    do loop over timesteps
                      WaveToyC: Evolution of 3D wave equation
                      t = t+dt
                      if (analysis)
                      endif
                    enddo
                  ----------------------------------------------------------------------
</pre>
                  <!--l. 285--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">Thorn banners</span>       </dt><dd 
class="list">
                  <!--l. 287--><p class="noindent" >Usually a thorn registers a short piece of text as a <span 
class="cmti-10">banner</span>. This banner of each thorn is
                  displayed in the standard output when the thorn is initialised.
</p>
                  </dd></dl>
<!--l. 295--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">A2.2   </span> <a 
 id="x1-10000A2.2"></a>File output</h3>
                                                                                       
                                                                                       
<!--l. 296--><p class="noindent" >Output methods in Cactus are all provided by thorns. Any number of output methods can be used for each run.
The behaviour of the output thorns in the standard arrangements are described in those thorns’
documentation.
</p><!--l. 301--><p class="noindent" >In general, output thorns decide what to output by parsing a string parameter containing the names of those
grid variables, or groups of variables, for which output is required. The names should be fully qualified with the
implementation and group or variable names.
</p><!--l. 306--><p class="noindent" >There is usually a parameter for each method to denote how often, in evolution iterations, this output should be
performed. There is also usually a parameter to define the directory in which the output should be placed,
defaulting to the directory from which the executable is run.
</p><!--l. 311--><p class="noindent" >See Chapter <a 
href="#x1-167000C2.7">C2.7<!--tex4ht:ref: chap:io_methods --></a> for details on creating your own IO method.
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter A3</span><br /><a 
 id="x1-11000A3"></a>Checkpointing/Recovery</h2>
<!--l. 319--><p class="noindent" >Checkpointing is defined as saving the current state of a run (parameter settings, contents of grid variables, and
other relevant information) to a file. At a later time, this run can then be restarted from that state by recovering
all the data from the checkpoint file.
</p><!--l. 324--><p class="noindent" >Cactus checkpointing and recovery methods are provided by thorns. In general, these thorns decide how often to
generate a checkpoint. They also register their recovery routines with the flesh; these recovery routines may then
be called during initialisation of a subsequent run to perform the recovery of the state of the run. Such a
recovery is requested by setting a parameter in the parameter file.
</p><!--l. 331--><p class="noindent" >See Chapter <a 
href="#x1-172000C2.8">C2.8<!--tex4ht:ref: chap:cp_recovery_methods --></a> for details of how to create your own checkpointing and recovery methods.
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter A4</span><br /><a 
 id="x1-12000A4"></a>Reporting bugs</h2>
<!--l. 343--><p class="noindent" >For tracking problem reports and bugs, we use the Bitbucket issue tracker at
<a 
href="https://bitbucket.org/einsteintoolkit/tickets/" class="url" ><span 
class="cmtt-10">https://bitbucket.org/einsteintoolkit/tickets/</span></a> which allows easy submission and browsing of problem
tickets.
</p><!--l. 347--><p class="noindent" >A description of the issue categories we use is provided in Appendix <a 
href="#x1-211000D6">D6<!--tex4ht:ref: sec:Appendix.tickets --></a>.
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
<h1 class="partHead"><span class="titlemark">Part B<br /></span><a 
 id="x1-13000B"></a>Additional notes</h1>
<!--l. 11--><p class="noindent" >
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter B1</span><br /><a 
 id="x1-14000B1"></a>Installation</h2>
<h3 class="sectionHead"><span class="titlemark">B1.1   </span> <a 
 id="x1-15000B1.1"></a>Required Software</h3>
<!--l. 28--><p class="noindent" >In general, Cactus <span 
class="cmti-10">requires </span>the following set of software to function in single processor mode. Please refer to the
architecture section <a 
href="#x1-16000B1.2">B1.2<!--tex4ht:ref: sec:suar --></a> for architecture specific items.
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">Perl5.0</span>             </dt><dd 
class="list">
                  <!--l. 32--><p class="noindent" >Perl  is  used  extensively  during  the  Cactus  thorn  configuration  phase.  Perl  is
                  available for nearly all operating systems known to man, and can be obtained at
                  <a 
href="http://www.perl.org" class="url" ><span 
class="cmtt-10">http://www.perl.org</span></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">GNU make</span>         </dt><dd 
class="list">
                  <!--l. 36--><p class="noindent" >The  make  process  works  with  the  GNU  make  utility  (referred  to  as  <span 
class="cmtt-10">gmake</span>
                  henceforth).  While  other  make  utilities  may  also  work,  this  is  not  guaranteed.
                  Gmake can be obtained from your favorite GNU site, or from <a 
href="http://www.gnu.org" class="url" ><span 
class="cmtt-10">http://www.gnu.org</span></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">C</span>                 </dt><dd 
class="list">
                  <!--l. 41--><p class="noindent" >C compiler. Cactus requires it to support the C99 standard. For example, the GNU
                  compiler. This is available for most supported platforms. Platform specific compilers
                  should also work.
                  </p></dd><dt class="list">
<span 
class="cmss-10">CPP</span>              </dt><dd 
class="list">
                  <!--l. 44--><p class="noindent" >C Preprocessor. For example, the GNU <span 
class="cmtt-10">cpp</span>. These are normally provided on most
                  platforms, and many C compilers have an option to just run as a preprocessor.
                  </p></dd><dt class="list">
<span 
class="cmss-10">C++</span>              </dt><dd 
class="list">
                  <!--l. 47--><p class="noindent" >C++ compiler. Cactus requires it to support the C++11 standard. For example,
                  the GNU compiler. This is available for most supported platforms. Platform specific
                  compilers should also work.
                  </p></dd><dt class="list">
<span 
class="cmss-10">GIT</span>               </dt><dd 
class="list">
                  <!--l. 50--><p class="noindent" ><span 
class="cmti-10">git </span>is not needed to run/compile Cactus, but you are strongly encouraged to install
                  this software to take advantage of the update procedures. It can be downloaded
                  from <a 
href="https://git-scm.com/" class="url" ><span 
class="cmtt-10">https://git-scm.com/</span></a>.</p></dd></dl>
<!--l. 56--><p class="noindent" >To use Cactus, with the default driver<span class="footnote-mark"><a 
href="UsersGuide2.html#fn1x5"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-15001f1"></a> 
                                                                                       
                                                                                       
(<span 
class="cmtt-10">CactusPUGH/PUGH</span>) on multiple processors you also need to include the thorn <span 
class="cmtt-10">ExternalLibraries/MPI </span>in your
thornlist, to include support for
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">MPI</span>               </dt><dd 
class="list">
                  <!--l. 63--><p class="noindent" >The  <span 
class="cmti-10">Message  Passing  Interface</span>,  which  provides  inter-processor  communication.
                  Supercomputing sites often supply a native MPI implementation that is very likely
                  to be compatible with Cactus. Otherwise, there are various freely available ones
                  available, e.g. the OpenMPI version of MPI is available for various architectures
                  and operating systems at <a 
href="http://www.open-mpi.org/" class="url" ><span 
class="cmtt-10">http://www.open-mpi.org/</span></a>.</p></dd></dl>
<!--l. 72--><p class="noindent" >If you are using any thorns containing routines written in CUDA (Compute Unified Device Architecture), a
parallel computing architecture developed by NVIDIA, you also need
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">CUCC</span>             </dt><dd 
class="list">
                  <!--l. 77--><p class="noindent" >a CUDA compiler. For example, the NVIDIA C compiler. In many cases, you can
                  compile your C and C++ code with a CUDA compiler without encountering any
                  problems, but you are advised to use a CUDA compiler exclusively for CUDA code.</p></dd></dl>
<!--l. 83--><p class="noindent" >If you are using any thorns containing routines written in Fortran you also need
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">F90</span>               </dt><dd 
class="list">
                  <!--l. 87--><p class="noindent" >a Fortran compiler.</p></dd></dl>
<!--l. 90--><p class="noindent" >While not required for compiling or running Cactus, for thorn development it is useful to install
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">ctags/etags</span>       </dt><dd 
class="list">
                  <!--l. 94--><p class="noindent" >These programs enable you browse through the calling structure of a program by
                  help of a function call database. Navigating the flesh and arrangements becomes
                  very easy. Emacs and <span 
class="cmtt-10">vi </span>both support this method. See <a 
href="#x1-212000D7">D7<!--tex4ht:ref: sec:Appendix.tags --></a> for a short guide to
                  tags.</p></dd></dl>
<h3 class="sectionHead"><span class="titlemark">B1.2   </span> <a 
 id="x1-16000B1.2"></a>Supported Architectures</h3>
<!--l. 106--><p class="noindent" >Cactus runs on many machines, under a large number of operating systems, on a large number of CPU
architectures. Here, we list the machines we have recently (in the past few years) compiled and verified Cactus
on, including some architecture specific notes.
</p><!--l. 111--><p class="noindent" >If your system is not on the list, the it is very likely that Cactus will work anyway. As a rule of thumb, if the
GCC compiler is available, Cactus will run.
</p><!--l. 115--><p class="noindent" >Operating systems:
                                                                                       
                                                                                       
                  </p><dl class="list1"><dt class="list">
<span 
class="cmssbx-10">Linux</span>             </dt><dd 
class="list">
                  <!--l. 117--><p class="noindent" >(this includes Blue Gene and Cray systems)
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">OS X</span>             </dt><dd 
class="list">
                  <!--l. 118--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Cygwin</span>            </dt><dd 
class="list">
                  <!--l. 119--><p class="noindent" ></p></dd></dl>
<!--l. 122--><p class="noindent" >CPU architectures:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmssbx-10">ARM</span>             </dt><dd 
class="list">
                  <!--l. 124--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Blue Gene/P</span>       </dt><dd 
class="list">
                  <!--l. 125--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">IBM PowerA2</span>      </dt><dd 
class="list">
                  <!--l. 126--><p class="noindent" >(aka Blue Gene/Q)
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">IBM Power</span>        </dt><dd 
class="list">
                  <!--l. 127--><p class="noindent" >(Power 5, 6, 7)
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">MIC</span>              </dt><dd 
class="list">
                  <!--l. 128--><p class="noindent" >(aka Xeon Phi)
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">x86</span>               </dt><dd 
class="list">
                  <!--l. 129--><p class="noindent" >(aka IA32)
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">x86-64</span>            </dt><dd 
class="list">
                  <!--l. 130--><p class="noindent" >(aka AMD64)</p></dd></dl>
<!--l. 133--><p class="noindent" >Systems that are of historic interest only:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmssbx-10">SGI</span>               </dt><dd 
class="list">
                  <!--l. 135--><p class="noindent" >32 or 64 bit running Irix.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Cray T3E</span>          </dt><dd 
class="list">
                  <!--l. 136--><p class="noindent" >
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Compaq Alpha</span>     </dt><dd 
class="list">
                  <!--l. 137--><p class="noindent" >Compaq operating system and Linux. Single processor mode and MPI supported.
                  The Alphas need to have the GNU C/C++ compilers installed.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">IA64</span>              </dt><dd 
class="list">
                  <!--l. 141--><p class="noindent" >running Linux.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Macintosh PowerPC</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 142--><p class="noindent" >(MacOS X and Linux PPC)
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">IBM SP2,SP3,SP4</span>  </dt><dd 
class="list">
                  <!--l. 143--><p class="noindent" >32 or 64 bit running AIX.
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Hitachi SR8000-F1</span>  </dt><dd 
class="list">
                  <!--l. 144--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Sun </span><span 
class="cmss-10">Solaris</span>         </dt><dd 
class="list">
                  <!--l. 145--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">Fujitsu</span>            </dt><dd 
class="list">
                  <!--l. 146--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">NEC SX-5, SX-6</span>   </dt><dd 
class="list">
                  <!--l. 147--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmssbx-10">HP Exemplar</span>       </dt><dd 
class="list">
                  <!--l. 148--><p class="noindent" >(only partially supported)</p></dd></dl>
<!--l. 151--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B1.2.1   </span> <a 
 id="x1-17000B1.2.1"></a>Note</h4>
<!--l. 152--><p class="noindent" >Disk space may be a problem on supercomputers where home directories are small. A workaround is to first
create a configs directory on scratch space, say <span 
class="cmtt-10">scratch/cactus</span><span 
class="cmtt-10">_configs/ </span>(where <span 
class="cmtt-10">scratch/ </span>is your scratch
directory), and then either </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 157--><p class="noindent" > set the environment variable <span 
class="cmtt-10">CACTUS</span><span 
class="cmtt-10">_CONFIGS</span><span 
class="cmtt-10">_DIR </span>to point to this directory</p></li></ul>
                                                                                       
                                                                                       
<!--l. 160--><p class="noindent" >or </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 162--><p class="noindent" >  soft  link  this  directory  (<span 
class="cmtt-10">ln -s scratch/cactus</span><span 
class="cmtt-10">_configs Cactus/configs/</span>)  to  the  Cactus
     directory, if your filesystem supports soft links.</p></li></ul>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter B2</span><br /><a 
 id="x1-18000B2"></a>Compilation</h2>
<h3 class="sectionHead"><span class="titlemark">B2.1   </span> <a 
 id="x1-19000B2.1"></a>Configuration Options</h3>
<!--l. 175--><p class="noindent" >There are four ways to pass options to the configuration process.
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-19001xB2.1">
     <!--l. 178--><p class="noindent" > Pass options individually in shell environment variables:
     </p><!--l. 181--><p class="noindent" ><span 
class="cmtt-10">export &#x003C;option name&#x003E;=&#x003C;chosen value&#x003E; # for bash</span><br 
class="newline" /><span 
class="cmtt-10">setenv &#x003C;option name&#x003E; &#x003C;chosen value&#x003E; # for (t)csh</span><br 
class="newline" /><span 
class="cmtt-10">gmake &#x003C;configuration name&#x003E;-config</span>
     </p></li>
<li 
  class="enumerate" id="x1-19002xB2.1">
     <!--l. 185--><p class="noindent" > Either: create a default configuration file <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config</span>.
     </p><!--l. 188--><p class="noindent" >All available configuration options may be set in a default options file <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config</span>,
     any option which are not set will take a default value. The file should contain lines of the form:
     </p><!--l. 192--><p class="noindent" ><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E; [=] ...</span>
     </p><!--l. 194--><p class="noindent" >The equals sign is optional. Spaces are allowed everywhere. Text starting wit a <span 
class="cmtt-10">’#’ </span>character will
     be ignored as a comment.
     </p></li>
<li 
  class="enumerate" id="x1-19003xB2.1">
     <!--l. 197--><p class="noindent" > Or: list your Cactus configuration files in an environment variable <span 
class="cmtt-10">CACTUS</span><span 
class="cmtt-10">_CONFIG</span><span 
class="cmtt-10">_FILES</span>:
     </p><!--l. 202--><p class="noindent" ><span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config name</span><span 
class="cmtt-10">&#x003E;-config CACTUS</span><span 
class="cmtt-10">_CONFIG</span><span 
class="cmtt-10">_FILES=</span>\(&lt;\)<span 
class="cmsltt-10">list of config files</span>\(&gt;\)
     </p><!--l. 204--><p class="noindent" >Multiple configuration files, with their file names separated by a <span 
class="cmtt-10">’:’ </span>character, will be processed
     in  order.  Each  file  should  be  given  by  its  full  path.  The  options  file  has  the  same  format  as
     <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config</span>.
     </p></li>
<li 
  class="enumerate" id="x1-19004xB2.1">
     <!--l. 209--><p class="noindent" > Add the options to a configuration file and use,
     </p><!--l. 212--><p class="noindent" ><span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config name</span><span 
class="cmtt-10">&#x003E;-config options=&#x003C;</span><span 
class="cmsltt-10">filename</span><span 
class="cmtt-10">&#x003E;</span>
     </p><!--l. 214--><p class="noindent" >The options file has the same format as <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config</span>. (Note that these options are
     <span 
class="cmti-10">added </span>to those from the <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config </span>file.)
     </p></li>
<li 
  class="enumerate" id="x1-19005xB2.1">
     <!--l. 218--><p class="noindent" > Pass the options individually on the command line,
     </p><!--l. 222--><p class="noindent" ><span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config name</span><span 
class="cmtt-10">&#x003E;-config &#x003C;</span><span 
class="cmsltt-10">option name</span><span 
class="cmtt-10">&#x003E;=&#x003C;</span><span 
class="cmsltt-10">chosen value</span><span 
class="cmtt-10">&#x003E;, ...</span>
                                                                                       
                                                                                       
     </p><!--l. 224--><p class="noindent" >Not all configuration options can be set on the command line. Those that can be set are indicated
     in the table below.</p></li></ol>
<!--l. 228--><p class="noindent" >The options are listed here in order of increasing precedence, e.g. options set on the command line will take
priority over (potentially conflicting) options set in <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config </span>or other Cactus configuration
files. Default options from <span 
class="tctt-1000">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">HOME</span><span 
class="cmsy-10">}</span><span 
class="cmtt-10">/.cactus/config </span>will only be read if the environment variable
<span 
class="cmtt-10">CACTUS</span><span 
class="cmtt-10">_CONFIG</span><span 
class="cmtt-10">_FILES </span>is not set.
</p><!--l. 235--><p class="noindent" >Options read from configuration files can use expressions of the form <span class="obeylines-h"><code class="verb">${VARIABLE}</code></span> which are replaced
by the value of the environment variable <span class="obeylines-h"><code class="verb">$VARIABLE</code></span> at the time <span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config name</span><span 
class="cmtt-10">&#x003E;-config</span>
runs. The <span class="obeylines-h"><code class="verb">$</code></span> sign can be escaped by duplicating it <span class="obeylines-h"><code class="verb">$$</code></span>, and <span class="obeylines-h"><code class="verb">$</code></span> followed by any character other than <span class="obeylines-h"><code class="verb">$</code></span>
or <span class="obeylines-h"><code class="verb">{</code></span> is left as is (this may change in the future as more expansions are added). Since <span 
class="cmtt-10">gmake </span>also
interprets <span class="obeylines-h"><code class="verb">$$</code></span> in order to have a <span class="obeylines-h"><code class="verb">$</code></span> show up to the shell it must be quadrupled <span class="obeylines-h"><code class="verb">$$$$</code></span>. For example
setting
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-5">
CC = $${CXX} $(CXXFLAGS) $$(CPPFLAGS) -license ${HOME}/.license -I$$$${HDF5_HOME}/include
</pre>
<!--l. 246--><p class="nopar" >expands <span class="obeylines-h"><code class="verb">${CXX}</code></span>, <span class="obeylines-h"><code class="verb">$(CXXFLAGS)</code></span>, and <span class="obeylines-h"><code class="verb">$(CPPFLAGS)</code></span> in the Makefile, <span class="obeylines-h"><code class="verb">${HOME}</code></span> when <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">config name</span><span 
class="cmtt-10">&#x003E;-config </span>runs,
and <span class="obeylines-h"><code class="verb">${HDF5_HOME}</code></span> when the compiler <span class="obeylines-h"><code class="verb">${CXX}</code></span> runs.
</p><!--l. 251--><p class="noindent" >It is important to note that these methods cannot be used to, for example, add options to the default values for
<span 
class="cmtt-10">CFLAGS</span>. Setting any variable in the configuration file or the command line will overwrite completely the default
values.
</p><!--l. 256--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B2.1.1   </span> <a 
 id="x1-20000B2.1.1"></a>Available Options</h4>
<!--l. 259--><p class="noindent" >There is a plethora of available options.
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 263--><p class="noindent" >Cross compiling
     </p><!--l. 265--><p class="noindent" >If you are compiling on an architecture other than the one you are producing an executable for,
     you will need to pass the
     </p><!--l. 268--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">HOST</span><span 
class="cmtt-10">_MACHINE=</span><span 
class="cmsltt-10">x-x-x</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 269--><p class="noindent" ></p></dd></dl>
     <!--l. 271--><p class="noindent" >option, where <span 
class="cmsltt-10">x-x-x </span>is the canonical name of the architecture you are compiling for, such as
     <span 
class="cmtt-10">sx6-nec-superux</span>; the format is <span 
class="cmsltt-10">processor</span><span 
class="cmtt-10">-</span><span 
class="cmsltt-10">vendor</span><span 
class="cmtt-10">-</span><span 
class="cmsltt-10">OS</span>.
     </p></li>
     <li class="itemize">
     <!--l. 275--><p class="noindent" >Compiled thorns
     </p><!--l. 277--><p class="noindent" >These specify the chosen set of thorns for compilation. If the thorn choice is not provided during
     configuration, a list containing all thorns in the <span 
class="cmtt-10">arrangements </span>directory is automatically created, and the
     user is prompted for any changes.
     </p><!--l. 282--><p class="noindent" >
                                                                                       
                                                                                       
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">THORNLIST</span>         </dt><dd 
class="list">
                       <!--l. 284--><p class="noindent" >Name  of  file  containing  a  list  of  thorns  with  the  syntax  <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">arrangement</span>
                       <span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;/&#x003C;</span><span 
class="cmsltt-10">thorn name</span><span 
class="cmtt-10">&#x003E;</span>. Lines beginning with <span class="obeylines-h"><code class="verb">#</code></span> or <span 
class="cmtt-10">! </span>are ignored.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">THORNLIST</span><span 
class="cmtt-10">_DIR</span>     </dt><dd 
class="list">
                       <!--l. 288--><p class="noindent" >Location  of  directory  containing  <span 
class="cmtt-10">THORNLIST</span>.  This  defaults  to  the  current
                       working directory.
</p>
                       </dd></dl>
     </li>
     <li class="itemize">
     <!--l. 295--><p class="noindent" >Compiler and tool specification
     </p><!--l. 297--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">CC</span>                </dt><dd 
class="list">
                       <!--l. 298--><p class="noindent" >The C compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span>               </dt><dd 
class="list">
                       <!--l. 299--><p class="noindent" >The C++ compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span>              </dt><dd 
class="list">
                       <!--l. 300--><p class="noindent" >The CUDA compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span>               </dt><dd 
class="list">
                       <!--l. 301--><p class="noindent" >The Fortran compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span>               </dt><dd 
class="list">
                       <!--l. 302--><p class="noindent" >Ignored
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CPP</span>               </dt><dd 
class="list">
                       <!--l. 303--><p class="noindent" >The preprocessor used to generate dependencies for and to preprocess C and
                       C++ code.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">FPP</span>               </dt><dd 
class="list">
                       <!--l. 305--><p class="noindent" >The preprocessor used to generate dependencies for and to preprocess Fortran
                       code.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span>                </dt><dd 
class="list">
                       <!--l. 307--><p class="noindent" >The linker.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">AR</span>                </dt><dd 
class="list">
                       <!--l. 308--><p class="noindent" >The archiver used for generating libraries.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">RANLIB</span>            </dt><dd 
class="list">
                       <!--l. 309--><p class="noindent" >The archive indexer to use.
                                                                                       
                                                                                       
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">MKDIR</span>             </dt><dd 
class="list">
                       <!--l. 310--><p class="noindent" >The program to use to create a directory.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">PERL</span>              </dt><dd 
class="list">
                       <!--l. 311--><p class="noindent" >The name of the Perl executable.</p></dd></dl>
     </li>
     <li class="itemize">
     <!--l. 314--><p class="noindent" >Output Directory
     </p><!--l. 316--><p class="noindent" >By default, Cactus generates intermediate and object files underneath a directory named “configs” inside
     the Cactus directory. This location may be changed through the use of the <span 
class="cmtt-10">CACTUS</span><span 
class="cmtt-10">_CONFIGS</span><span 
class="cmtt-10">_DIR</span>
     environment variable. See the section on File Layout <a 
href="#x1-23000B2.3">B2.3<!--tex4ht:ref: file_layout --></a>.
     </p></li>
     <li class="itemize">
     <!--l. 322--><p class="noindent" >Compilation and tool flags
     </p><!--l. 324--><p class="noindent" >Flags which are passed to the compilers and the tools.
     </p><!--l. 326--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">CFLAGS</span>            </dt><dd 
class="list">
                       <!--l. 327--><p class="noindent" >Flags for the C compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCCFLAGS</span>         </dt><dd 
class="list">
                       <!--l. 330--><p class="noindent" >Flags for the CUDA compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXXFLAGS</span>          </dt><dd 
class="list">
                       <!--l. 333--><p class="noindent" >Flags for the C++ compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90FLAGS</span>          </dt><dd 
class="list">
                       <!--l. 336--><p class="noindent" >Flags for the Fortran compiler.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77FLAGS</span>          </dt><dd 
class="list">
                       <!--l. 339--><p class="noindent" >Ignored
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CPPFLAGS</span>          </dt><dd 
class="list">
                       <!--l. 342--><p class="noindent" >Flags for the preprocessor (used to generate compilation dependencies for and
                       preprocess C and C++ code).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">FPPFLAGS</span>          </dt><dd 
class="list">
                       <!--l. 346--><p class="noindent" >Flags for the preprocessor (used to generate compilation dependencies for and
                       preprocess Fortran code).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">MKDIRFLAGS</span>        </dt><dd 
class="list">
                       <!--l. 350--><p class="noindent" >Flags for <span 
class="cmtt-10">MKDIR</span>, so that no error is given if the directory exists.
                                                                                       
                                                                                       
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LDFLAGS</span>           </dt><dd 
class="list">
                       <!--l. 353--><p class="noindent" >Flags for the linker. <span 
class="cmti-10">Warning: </span>This variable is ignored while the compilers and
                       linkers are autodetected. This can lead to strange errors while configuring.
                       You can pass the linker flags in the variable <span 
class="cmtt-10">LD </span>instead.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">BEGIN</span><span 
class="cmtt-10">_WHOLE</span><span 
class="cmtt-10">_ARCHIVE</span><span 
class="cmtt-10">_FLAGS</span><span 
class="cmss-10">, </span><span 
class="cmtt-10">END</span><span 
class="cmtt-10">_WHOLE</span><span 
class="cmtt-10">_ARCHIVE</span><span 
class="cmtt-10">_FLAGS</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 360--><p class="noindent" >Optional set of flags for the linker that change the behaviour how archives are
                       handled. These flags are used just before and just after listing the flesh and
                       all thorn libraries. This mechanism can be used to force linking in all object
                       files from the flesh and all thorns, which can help detect duplicate definitions.
                       Otherwise, duplicate routines may go undetected.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">ARFLAGS</span>           </dt><dd 
class="list">
                       <!--l. 368--><p class="noindent" >Flags for the archiver.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_LINE</span><span 
class="cmtt-10">_DIRECTIVES</span> </dt><dd 
class="list">
                       <!--l. 371--><p class="noindent" >Whether error messages and debug information in the compiled C and C++
                       files should point to the original source file or to an internal file created by
                       Cactus. The only options available are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>, the default is <span 
class="cmtt-10">yes</span>. Set this
                       to <span 
class="cmtt-10">no </span>if your compiler reports error messages about unrecognised <span class="obeylines-h"><code class="verb">#</code></span> directives.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F</span><span 
class="cmtt-10">_LINE</span><span 
class="cmtt-10">_DIRECTIVES</span> </dt><dd 
class="list">
                       <!--l. 378--><p class="noindent" >Whether error messages and debug information in the compiled Fortran files
                       should point to the original source file or to an internal file created by Cactus.
                       The only options available are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>, the default is <span 
class="cmtt-10">yes</span>. Set this to <span 
class="cmtt-10">no</span>
                       if your compiler reports error messages about unrecognised <span class="obeylines-h"><code class="verb">#</code></span> directives.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CROSS</span><span 
class="cmtt-10">_COMPILE</span>     </dt><dd 
class="list">
                       <!--l. 385--><p class="noindent" >Enables cross compilation. Available options are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>, the default is <span 
class="cmtt-10">no</span>.
                       To create a cross-compiled configuration one must explicitly set this option
                       to <span 
class="cmtt-10">yes</span>. You will also have to set <span 
class="cmtt-10">ENDIAN</span>.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">ENDIAN</span>            </dt><dd 
class="list">
                       <!--l. 390--><p class="noindent" >Explicitly sets the endianess of multi-byte types. Normally this is detected
                       automatically  but  needs  to  be  specified  for  cross-compilations.  Available
                       options are <span 
class="cmtt-10">little </span>and <span 
class="cmtt-10">big</span>.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">DISABLE</span><span 
class="cmtt-10">_INT16</span>     </dt><dd 
class="list">
                       <!--l. 394--><p class="noindent" >Disable support for the data type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT16</span>. The only options available are
                       <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>, the default is <span 
class="cmtt-10">no</span>. Cactus autodetects this data type only for C.
                       If the C compiler supports it, but the Fortran compiler does not, it may be
                       necessary to disable <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT16 </span>altogether, since Cactus assumes that data
                       types are fully supported if they exist.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">DISABLE</span><span 
class="cmtt-10">_REAL16</span>    </dt><dd 
class="list">
                       <!--l. 402--><p class="noindent" >Disable support for the data type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL16</span>. The only options available
                       are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>, the default is <span 
class="cmtt-10">no</span>. Cactus autodetects this data type only for
                                                                                       
                                                                                       
                       C. If the C compiler supports it, but the Fortran compiler does not, it may
                       be necessary to disable <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL16 </span>altogether, since Cactus assumes that
                       data types are fully supported if they exist.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">DEBUG</span>             </dt><dd 
class="list">
                       <!--l. 410--><p class="noindent" >Specifies what type of debug mode should be used, the default is no debugging.
                       Current  options  are  <span 
class="cmtt-10">yes</span>,  <span 
class="cmtt-10">no</span>,  or  <span 
class="cmtt-10">memory</span>.  The  option  <span 
class="cmtt-10">yes </span>switches  on  all
                       debugging features, whereas <span 
class="cmtt-10">memory </span>just employs memory tracing (Section
                       <a 
href="#x1-127000C1.9.3">C1.9.3<!--tex4ht:ref: sec:metr --></a>).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS</span>     </dt><dd 
class="list">
                       <!--l. 417--><p class="noindent" >Debug flags for the C compiler, their use depends on the type of debugging
                       being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS</span>  </dt><dd 
class="list">
                       <!--l. 421--><p class="noindent" >Debug  flags  for  the  CUDA  compiler,  their  use  depends  on  the  type  of
                       debugging being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS</span>   </dt><dd 
class="list">
                       <!--l. 425--><p class="noindent" >Debug flags for the C++ compiler, their use depends on the type of debugging
                       being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS</span>   </dt><dd 
class="list">
                       <!--l. 429--><p class="noindent" >Debug flags for the Fortran 90 compiler, their use depends on the type of
                       debugging being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS</span>   </dt><dd 
class="list">
                       <!--l. 433--><p class="noindent" >Ignored.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS</span>    </dt><dd 
class="list">
                       <!--l. 436--><p class="noindent" >Debug flags for the linker, their use depends on the type of debugging being
                       used. Default to <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_DEBUG</span><span 
class="cmtt-10">_FLAGS </span>if <span class="obeylines-h"><code class="verb">LD</code></span> is not set.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">OPTIMISE, OPTIMIZE</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 442--><p class="noindent" >Specifies what type of optimisation should be used. The only options currently
                       available are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>. The default is to use optimisation.<br 
class="newline" />Note that the British spelling <span 
class="cmtt-10">OPTIMISE </span>will be checked first and, if set, will
                       override any setting of the American-spelled <span 
class="cmtt-10">OPTIMIZE</span>.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span>  </dt><dd 
class="list">
                       <!--l. 448--><p class="noindent" >Optimisation  flags  for  the  C  compiler,  their  use  depends  on  the  type  of
                       optimisation being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 452--><p class="noindent" >Optimisation  flags  for  the  C  compiler,  their  use  depends  on  the  type  of
                       optimisation being used.
                                                                                       
                                                                                       
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 456--><p class="noindent" >Optimisation flags for the C++ compiler, their use depends on the type of
                       optimisation being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 460--><p class="noindent" >Optimisation flags for the Fortran 90 compiler, their use depends on the type
                       of optimisation being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 464--><p class="noindent" >Ignored.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 467--><p class="noindent" >Optimisation flags for the linker, their use depends on the type of optimisation
                       being used. Default to <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS </span>if <span class="obeylines-h"><code class="verb">LD</code></span> is not set.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 472--><p class="noindent" >Optimisation flags used to indicate that no optimisation should be performed.
                       These are invoked when OPTIMISE=no is used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 476--><p class="noindent" >Optimisation flags used to indicate that no optimisation should be performed.
                       These are invoked when OPTIMISE=no is used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 480--><p class="noindent" >Optimisation flags used to indicate that no optimisation should be performed.
                       These are invoked when OPTIMISE=no is used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 484--><p class="noindent" >Optimisation flags used to indicate that no optimisation should be performed.
                       These are invoked when OPTIMISE=no is used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span><br 
class="newline" />                  </dt><dd 
class="list">
                       <!--l. 488--><p class="noindent" >Ignored.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 491--><p class="noindent" >Optimisation  flags  used  to  indicate  that  no  optimisation  should  be
                       performed.  These  are  invoked  when  OPTIMISE=no  is  used.  Default  to
                       <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_NO</span><span 
class="cmtt-10">_OPTIMISE</span><span 
class="cmtt-10">_FLAGS </span>if <span class="obeylines-h"><code class="verb">LD</code></span> is not set.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">OPENMP</span>            </dt><dd 
class="list">
                       <!--l. 497--><p class="noindent" >Specifies  if  OpenMP  multi-threading  should  be  used.  The  only  options
                       currently available are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>. The default is to use no OpenMP.
                                                                                       
                                                                                       
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS</span>    </dt><dd 
class="list">
                       <!--l. 502--><p class="noindent" >OpenMP flags for the C compiler, their use depends on the type of OpenMP
                       stack being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 506--><p class="noindent" >OpenMP flags for the CUDA compiler, their use depends on the type of
                       OpenMP stack being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS</span>  </dt><dd 
class="list">
                       <!--l. 510--><p class="noindent" >OpenMP  flags  for  the  C++  compiler,  their  use  depends  on  the  type  of
                       OpenMP stack being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS</span>  </dt><dd 
class="list">
                       <!--l. 514--><p class="noindent" >OpenMP flags for the Fortran 90 compiler, their use depends on the type of
                       OpenMP stack being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS</span>  </dt><dd 
class="list">
                       <!--l. 518--><p class="noindent" >Ignored.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS</span>   </dt><dd 
class="list">
                       <!--l. 521--><p class="noindent" >OpenMP flags for the linker, their use depends on the type of OpenMP stack
                       being used. Default to <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_OPENMP</span><span 
class="cmtt-10">_FLAGS </span>if <span class="obeylines-h"><code class="verb">LD</code></span> is not set.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">PROFILE</span>           </dt><dd 
class="list">
                       <!--l. 527--><p class="noindent" >Specifies what type of profiling should be used. The only options currently
                       available are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>. The default is to use no profiling.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS</span>   </dt><dd 
class="list">
                       <!--l. 532--><p class="noindent" >Profile flags for the C compiler, their use depends on the type of profiling
                       being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 536--><p class="noindent" >Profile flags for the CUDA compiler, their use depends on the type of profiling
                       being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 540--><p class="noindent" >Profile flags for the C++ compiler, their use depends on the type of profiling
                       being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 544--><p class="noindent" >Profile flags for the Fortran 90 compiler, their use depends on the type of
                       profiling being used.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS</span> </dt><dd 
class="list">
                       <!--l. 548--><p class="noindent" >Ignored.
                                                                                       
                                                                                       
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS</span>  </dt><dd 
class="list">
                       <!--l. 551--><p class="noindent" >Profile flags for the linker, their use depends on the type of profiling being
                       used. Default to <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_PROFILE</span><span 
class="cmtt-10">_FLAGS </span>if <span class="obeylines-h"><code class="verb">LD</code></span> is not set.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">WARN</span>              </dt><dd 
class="list">
                       <!--l. 556--><p class="noindent" >Specifies  what  type  of  build  warnings  should  be  used.  The  only  options
                       currently available are <span 
class="cmtt-10">yes </span>and <span 
class="cmtt-10">no</span>. The default is to produce no warnings.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">C</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS</span>      </dt><dd 
class="list">
                       <!--l. 561--><p class="noindent" >Warning flags for the C compiler, their use depends on the type of warnings
                       used during compilation (Section <a 
href="#x1-28000B2.4.4">B2.4.4<!--tex4ht:ref: sec:gmopfobuco --></a>).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CUCC</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS</span>   </dt><dd 
class="list">
                       <!--l. 565--><p class="noindent" >Warning  flags  for  the  CUCC  compiler,  their  use  depends  on  the  type  of
                       warnings used during compilation (Section <a 
href="#x1-28000B2.4.4">B2.4.4<!--tex4ht:ref: sec:gmopfobuco --></a>).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS</span>    </dt><dd 
class="list">
                       <!--l. 569--><p class="noindent" >Warning flags for the C++ compiler, their use depends on the type of warnings
                       used during compilation (Section <a 
href="#x1-28000B2.4.4">B2.4.4<!--tex4ht:ref: sec:gmopfobuco --></a>).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F90</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS</span>    </dt><dd 
class="list">
                       <!--l. 573--><p class="noindent" >Warning flags for the Fortran 90 compiler, their use depends on the type of
                       warnings used during compilation (Section <a 
href="#x1-28000B2.4.4">B2.4.4<!--tex4ht:ref: sec:gmopfobuco --></a>).
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">F77</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS</span>    </dt><dd 
class="list">
                       <!--l. 577--><p class="noindent" >Ignored.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LD</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS</span>     </dt><dd 
class="list">
                       <!--l. 580--><p class="noindent" >Warning flags for the linker, their use depends on the type of warnings used
                       during linking (Section <a 
href="#x1-28000B2.4.4">B2.4.4<!--tex4ht:ref: sec:gmopfobuco --></a>). Default to <span 
class="cmtt-10">CXX</span><span 
class="cmtt-10">_WARN</span><span 
class="cmtt-10">_FLAGS </span>if <span class="obeylines-h"><code class="verb">LD</code></span> is not set.
</p>
                       </dd></dl>
     </li>
     <li class="itemize">
     <!--l. 587--><p class="noindent" >Architecture-specific flags
     </p><!--l. 589--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">IRIX</span><span 
class="cmtt-10">_BITS=32|64</span>   </dt><dd 
class="list">
                       <!--l. 590--><p class="noindent" >For Irix SGI systems: whether to build a 32- or 64-bit configuration.</p></dd></dl>
     <!--l. 593--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">AIX</span><span 
class="cmtt-10">_BITS=32|64</span>    </dt><dd 
class="list">
                       <!--l. 594--><p class="noindent" >For IBM SP systems: whether to build a 32- or 64-bit configuration.</p></dd></dl>
                                                                                       
                                                                                       
     </li>
     <li class="itemize">
     <!--l. 597--><p class="noindent" >Library flags
     </p><!--l. 599--><p class="noindent" >Used to specify auxiliary libraries and directories to find them in.
     </p><!--l. 601--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">LIBS</span>              </dt><dd 
class="list">
                       <!--l. 602--><p class="noindent" >Additional  libraries.  This  variable  can  also  contain  linker  options,  e.g. to
                       switch between static and dynamic linking. (Cactus adds a <span class="obeylines-h"><code class="verb">-l</code></span> prefix to library
                       names, but does not modify linker options.) <span 
class="cmti-10">Warning: </span>This variable is ignored
                       while the compilers and linkers are autodetected. This can lead to strange
                       errors while configuring. You can pass the additional libraries in the variable
                       <span 
class="cmtt-10">LD </span>instead.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">LIBDIRS</span>           </dt><dd 
class="list">
                       <!--l. 612--><p class="noindent" >Any other library directories. This variable can also contain linker options.
                       (Cactus adds an <span class="obeylines-h"><code class="verb">-L</code></span> prefix to library directories, but does not modify linker
                       options.)</p></dd></dl>
     </li>
     <li class="itemize">
     <!--l. 618--><p class="noindent" >Extra include directories
     </p><!--l. 620--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">SYS</span><span 
class="cmtt-10">_INC</span><span 
class="cmtt-10">_DIRS</span>      </dt><dd 
class="list">
                       <!--l. 621--><p class="noindent" >Used to specify any additional directories for system include files.</p></dd></dl>
     </li>
     <li class="itemize">
     <!--l. 626--><p class="noindent" >Precision options
     </p><!--l. 628--><p class="noindent" >Used to specify the precision of the default real and integer data types, by the number of bytes the data
     takes up. Note that not all values will be valid on all architectures.
     </p><!--l. 632--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">REAL</span><span 
class="cmtt-10">_PRECISION</span>    </dt><dd 
class="list">
                       <!--l. 634--><p class="noindent" >Allowed values are <span 
class="cmtt-10">16, 8, 4</span>.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">INTEGER</span><span 
class="cmtt-10">_PRECISION</span> </dt><dd 
class="list">
                       <!--l. 637--><p class="noindent" >Allowed values are <span 
class="cmtt-10">8, 4, 2</span>.
</p>
                       </dd></dl>
     </li>
     <li class="itemize">
     <!--l. 642--><p class="noindent" >Executable name
     </p><!--l. 644--><p class="noindent" >
                                                                                       
                                                                                       
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">EXEDIR</span>            </dt><dd 
class="list">
                       <!--l. 645--><p class="noindent" >The directory in which to place the executable.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">EXE</span>               </dt><dd 
class="list">
                       <!--l. 646--><p class="noindent" >The name of the executable.</p></dd></dl>
     </li>
     <li class="itemize">
     <!--l. 649--><p class="noindent" >Extra packages
     </p><!--l. 651--><p class="noindent" >Compiling with extra packages is described fully in Section <a 
href="#x1-21000B2.2">B2.2<!--tex4ht:ref: subsec:cowiexpa --></a>, which should be consulted for the full
     range of configuration options.
     </p></li>
     <li class="itemize">
     <!--l. 655--><p class="noindent" >Miscellaneous
     </p><!--l. 657--><p class="noindent" >
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">PROMPT</span>            </dt><dd 
class="list">
                       <!--l. 658--><p class="noindent" >Setting this to <span 
class="cmtt-10">no </span>turns off all prompts from the make system.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">VERBOSE</span>           </dt><dd 
class="list">
                       <!--l. 660--><p class="noindent" >Setting this to <span 
class="cmtt-10">yes </span>instructs <span 
class="cmtt-10">gmake </span>to print the commands that it is executing.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">SILENT</span>            </dt><dd 
class="list">
                       <!--l. 662--><p class="noindent" >Setting this to <span 
class="cmtt-10">no </span>is an depreciated way of using <span 
class="cmtt-10">VERBOSE = yes</span>.</p></dd></dl>
     </li></ul>
<!--l. 671--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">B2.2   </span> <a 
 id="x1-21000B2.2"></a>Compiling with Extra Packages</h3>
<!--l. 674--><p class="noindent" >Extra packages are provided through the <span 
class="cmti-10">ExternalLibraries </span>thorns each of which usually supports a set of
variables <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_DIR</span>, <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_LIBS</span>, <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_LIB</span><span 
class="cmsltt-10">_DIRS</span>, and <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_INC</span><span 
class="cmsltt-10">_DIRS </span>to control where include and library
files are located, where <span 
class="cmtt-10">THORN </span>is the name of the <span 
class="cmtt-10">ExternalLibrary</span>. The actual list of supported variables can be
found in each thorn’s <span 
class="cmtt-10">configuration.ccl </span>file.
</p><!--l. 682--><p class="noindent" >While not all <span 
class="cmtt-10">ExternalLibraries </span>interpret all options in the same way, typically options have the following
meaning and allowed values:
</p><!--l. 685--><p class="noindent" ><span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_DIR </span>can take the values:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">BUILD</span>             </dt><dd 
class="list">
                  <!--l. 687--><p class="noindent" >compile included <span 
class="cmtt-10">THORN </span>copy.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">NO</span><span 
class="cmtt-10">_BUILD</span>          </dt><dd 
class="list">
                  <!--l. 688--><p class="noindent" >search for <span 
class="cmtt-10">THORN </span>in <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_DIR</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CUSTOM</span>            </dt><dd 
class="list">
                  <!--l. 690--><p class="noindent" >do not search for or build <span 
class="cmtt-10">THORN</span>, instead use information provided in <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_LIBS</span>,
                  <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_LIB</span><span 
class="cmsltt-10">_DIRS</span>, and <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_INC</span><span 
class="cmsltt-10">_DIRS</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">NONE</span>              </dt><dd 
class="list">
                  <!--l. 693--><p class="noindent" >use native <span 
class="cmtt-10">THORN </span>implementation provided by the compiler or operating system; no
                  further options are used.
                  </p></dd><dt class="list">
<span 
class="cmss-10">any valid path</span>       </dt><dd 
class="list">
                  <!--l. 695--><p class="noindent" >search for <span 
class="cmtt-10">THORN </span>in the given directory.
                  </p></dd><dt class="list">
<span 
class="cmss-10">missing</span>            </dt><dd 
class="list">
                  <!--l. 696--><p class="noindent" >if <span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_DIR </span>is missing <span 
class="cmtt-10">THORN </span>is searched for in a number of well known locations
                  and built from the included copy if it is not found.</p></dd></dl>
<!--l. 702--><p class="noindent" >The location of include files, modules and Fortran module files is given via:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_DIR</span>         </dt><dd 
class="list">
                  <!--l. 704--><p class="noindent" >where to search for THORN.
                  </p></dd><dt class="list">
<span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_LIBS</span>        </dt><dd 
class="list">
                  <!--l. 705--><p class="noindent" >libraries.
                  </p></dd><dt class="list">
<span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_LIB</span><span 
class="cmsltt-10">_DIRS</span>    </dt><dd 
class="list">
                  <!--l. 706--><p class="noindent" >library directories.
                  </p></dd><dt class="list">
<span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_INC</span><span 
class="cmsltt-10">_DIRS</span>    </dt><dd 
class="list">
                  <!--l. 707--><p class="noindent" >include file directories.
                  </p></dd><dt class="list">
<span 
class="cmsltt-10">THORN</span><span 
class="cmsltt-10">_INSTALL</span><span 
class="cmsltt-10">_DIR</span> </dt><dd 
class="list">
                  <!--l. 708--><p class="noindent" >where to install <span 
class="cmtt-10">THORN </span>if the built in copy is used.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 712--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B2.2.1   </span> <a 
 id="x1-22000B2.2.1"></a>Note on possible ExternalLibraries’ location stripping</h4>
<!--l. 715--><p class="noindent" >Each thorn which is compiled as one external library will automatically use the library version
contained in the <span 
class="cmtt-10">&#x003C;library&#x003E;/dist </span>folder. In particular, the tarball in <span 
class="cmtt-10">&#x003C;library&#x003E;/dist </span>is only used if
either <span 
class="cmtt-10">THORN</span><span 
class="cmtt-10">_DIR </span>is set to <span 
class="cmtt-10">BUILD </span>or is left empty and no precompiled copy of the library is found. If
another location is specified via the <span 
class="cmtt-10">THORN</span><span 
class="cmtt-10">_DIR </span>variable in the configuration file at compilation,
then the <span 
class="cmtt-10">lib/sbin/strip-incdirs.sh </span>script will automatically strip away (for safety reasons) the
locations:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">/include</span>          </dt><dd 
class="list">
                  <!--l. 725--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/usr/include</span>      </dt><dd 
class="list">
                  <!--l. 726--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/usr/local/include</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 727--><p class="noindent" ></p></dd></dl>
<!--l. 729--><p class="noindent" >from <span 
class="cmtt-10">THORN</span><span 
class="cmtt-10">_INC</span><span 
class="cmtt-10">_DIRS </span>which default to <span 
class="cmtt-10">THORN</span><span 
class="cmtt-10">_DIR/include</span>. Therefore, if there is any need for using one
already installed version of one external library, the aforementioned location should be avoided (e.g. indicating
<span 
class="cmtt-10">/home </span>as the <span 
class="cmtt-10">THORN</span><span 
class="cmtt-10">_DIR </span>will work with no problems if the required library is installed there) or
should be carefully checked, in order to avoid unwanted stripping. It is worth mentioning that the
compiler normally automatically searches in <span 
class="cmtt-10">/usr </span>and <span 
class="cmtt-10">/usr/local </span>so stripping does not prevent it
from being found (basically they are only found later in the search order of the compiler). The
same stripping happens to <span 
class="cmtt-10">THORN</span><span 
class="cmtt-10">_LIB</span><span 
class="cmtt-10">_DIRS </span>in <span 
class="cmtt-10">lib/sbin/strip-libdirs.sh </span>with a larger list of
directories:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">/lib</span>              </dt><dd 
class="list">
                  <!--l. 742--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/usr/lib</span>          </dt><dd 
class="list">
                  <!--l. 743--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/usr/local/lib</span>    </dt><dd 
class="list">
                  <!--l. 744--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/lib64</span>            </dt><dd 
class="list">
                  <!--l. 745--><p class="noindent" >
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/usr/lib64</span>        </dt><dd 
class="list">
                  <!--l. 746--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">/usr/local/lib64</span>  </dt><dd 
class="list">
                  <!--l. 747--><p class="noindent" ></p></dd></dl>
<!--l. 750--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">B2.3   </span> <a 
 id="x1-23000B2.3"></a>File Layout</h3>
<!--l. 753--><p class="noindent" >The configuration process sets up various subdirectories and files in the configuration directory (this is either a
directory <span 
class="cmtt-10">configs </span>inside the main Cactus directory, or the directory pointed to by the <span 
class="cmtt-10">CACTUS</span><span 
class="cmtt-10">_CONFIGS</span><span 
class="cmtt-10">_DIR</span>
environment variable). to contain the configuration specific files; these are placed in a directory with the name of
the configuration.
</p><!--l. 762--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">config-data</span>       </dt><dd 
class="list">
                  <!--l. 764--><p class="noindent" >contains the files created by the configure script:
                  </p><!--l. 767--><p class="noindent" >The most important ones are
                  </p><!--l. 769--><p class="noindent" >
                                    </p><dl class="list2"><dt class="list">
                  <span 
class="cmtt-10">make.config.defn</span>  </dt><dd 
class="list">
                                    <!--l. 771--><p class="noindent" >contains compilers and compilation flags for a configuration.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">make.extra.defn</span>   </dt><dd 
class="list">
                                    <!--l. 774--><p class="noindent" >contains   details   about   extra   packages   used   in   the
                                    configuration.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_Config.h</span>     </dt><dd 
class="list">
                                    <!--l. 777--><p class="noindent" >The main configuration header file, containing architecture
                                    specific definitions.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_Archdefs.h</span>   </dt><dd 
class="list">
                                    <!--l. 781--><p class="noindent" >An architecture specific header file containing things which
                                    cannot  be  automatically  detected,  and  have  thus  been
                                    hand-coded for this architecture.</p></dd></dl>
                  <!--l. 786--><p class="noindent" >These are the first files which should be checked or modified to suit any peculiarities of this
                  configuration.
                  </p><!--l. 789--><p class="noindent" >In addition, the following files may be informative:
                  </p><!--l. 791--><p class="noindent" >
                                                                                       
                                                                                       
                                    </p><dl class="list2"><dt class="list">
                  <span 
class="cmtt-10">fortran</span><span 
class="cmtt-10">_name.pl</span>   </dt><dd 
class="list">
                                    <!--l. 792--><p class="noindent" >A Perl script used to determine how the Fortran compiler
                                    names subroutines. This is used to make some C routines
                                    callable from Fortran, and Fortran routines callable from C.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">make.config.deps</span>  </dt><dd 
class="list">
                                    <!--l. 797--><p class="noindent" >Initially empty. It can be edited to add extra architecture
                                    specific dependencies needed to generate the executable.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">make.config.rule</span>  </dt><dd 
class="list">
                                    <!--l. 801--><p class="noindent" >The <span 
class="cmtt-10">make </span>rules for generating object files from source files.
</p>
                                    </dd></dl>
                  <!--l. 806--><p class="noindent" >Finally, <span 
class="cmtt-10">autoconf </span>generates the following files.
                  </p><!--l. 808--><p class="noindent" >
                                    </p><dl class="list2"><dt class="list">
                  <span 
class="cmtt-10">config.log</span>        </dt><dd 
class="list">
                                    <!--l. 810--><p class="noindent" >A log of the <span 
class="cmtt-10">autoconf </span>process.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">config.status</span>     </dt><dd 
class="list">
                                    <!--l. 813--><p class="noindent" >A script which may be used to regenerate the configuration.
                                    </p></dd><dt class="list">
                  <span 
class="cmtt-10">config.cache</span>      </dt><dd 
class="list">
                                    <!--l. 816--><p class="noindent" >An internal file used by <span 
class="cmtt-10">autoconf</span>.
</p>
                                    </dd></dl>
                  </dd><dt class="list">
<span 
class="cmtt-10">lib</span>               </dt><dd 
class="list">
                  <!--l. 821--><p class="noindent" >An empty directory which will contain the libraries created for each thorn.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">build</span>             </dt><dd 
class="list">
                  <!--l. 824--><p class="noindent" >An empty directory which will contain the object files generated for this configuration, and
                  preprocessed source files.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">config-info</span>       </dt><dd 
class="list">
                  <!--l. 828--><p class="noindent" >A file containing information about the configuration (including the options used to
                  configure the configuration).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">bindings</span>          </dt><dd 
class="list">
                  <!--l. 831--><p class="noindent" >A directory which contains all the files generated by the CST from the <span 
class="cmtt-10">.ccl</span>
                  files.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">scratch</span>           </dt><dd 
class="list">
                  <!--l. 834--><p class="noindent" >A scratch directory which is used to accommodate Fortran 90 modules.
</p>
                  </dd></dl>
<!--l. 840--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">B2.4   </span> <a 
 id="x1-24000B2.4"></a>Building and Administering a Configuration</h3>
<!--l. 843--><p class="noindent" >Once you have created a new configuration, the command <br 
class="newline" /><br 
class="newline" /><span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">configuration name</span><span 
class="cmtt-10">&#x003E; </span><br 
class="newline" /><br 
class="newline" />will build an executable, prompting you along the way for the thorns which should be included. There is a range
of <span 
class="cmtt-10">gmake </span>targets and options which are detailed in the following sections.
</p><!--l. 852--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B2.4.1   </span> <a 
 id="x1-25000B2.4.1"></a>gmake Targets for Building and Administering Configurations</h4>
<!--l. 855--><p class="noindent" >A target for <span 
class="cmtt-10">gmake </span>can be naively thought of as an argument that tells it which of several things listed in the
<span 
class="cmtt-10">Makefile </span>it is to do. The command <span 
class="cmtt-10">gmake help </span>lists all <span 
class="cmtt-10">gmake </span>targets:
</p><!--l. 860--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;</span>    </dt><dd 
class="list">
                  <!--l. 862--><p class="noindent" >builds a configuration. If the configuration doesn’t exist, it will create it.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-build BUILDLIST=&#x0022;&#x003C;list of thorns&#x003E;&#x0022;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 866--><p class="noindent" >compiles only the thorns listed.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-clean</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 869--><p class="noindent" >removes all object and dependency files from a configuration.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-cleandeps</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 872--><p class="noindent" >removes all dependency files from a configuration.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-cleanobjs</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 875--><p class="noindent" >removes all object files from a configuration.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-config</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 878--><p class="noindent" >creates a new configuration or reconfigures an existing one overwriting any previous
                  configuration options.<br 
class="newline" />The configuration options are stored in a file <span 
class="cmtt-10">configs/&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;/config-info</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-configinfo</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 883--><p class="noindent" >displays the options of the configuration (<span 
class="cmtt-10">cat configs/&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;/config-info</span>).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-delete</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 886--><p class="noindent" >deletes a configuration (<span 
class="cmtt-10">rm -r configs/&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;</span>).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;config&#x003E;-editthorns</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 889--><p class="noindent" >edits the <span 
class="cmtt-10">ThornList</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-examples</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 891--><p class="noindent" >copies all the example parameter files relevant for this configuration to the directory
                  <span 
class="cmtt-10">examples </span>in the Cactus home directory. If a file of the same name is already there,
                  it will not overwrite it.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-realclean</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 893--><p class="noindent" >removes  from  a  configuration  all  object  and  dependency  files,  as  well  as  files
                  generated from the CST (stands for <span 
class="cmti-10">Cactus Specification Tool</span>, which is the set of
                  Perl scripts which parse the thorn configuration files). Only the files generated by
                  configure and the <span 
class="cmtt-10">ThornList </span>file remain.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-rebuild</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 899--><p class="noindent" >rebuilds a configuration (reruns the CST).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-reconfig</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 901--><p class="noindent" >reconfigures an existing configuration using its previous configuration options from
                  the file <span 
class="cmtt-10">configs/&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;/config-info</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-testsuite</span><br 
class="newline" />                  </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 905--><p class="noindent" >runs the test programs associated with each thorn in the configuration. See section
                  <a 
href="#x1-30000B2.6">B2.6<!--tex4ht:ref: sec:testing --></a> for information about the test suite mechanism.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-ThornGuide</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 909--><p class="noindent" >builds documentation for the thorns in this configuration (see section <a 
href="#x1-29000B2.5">B2.5<!--tex4ht:ref: sec:OtherGmakeTargetsDoc --></a>, page
                  <a 
href="#x1-29000B2.5">B30<!--tex4ht:ref: sec:OtherGmakeTargetsDoc --></a>, for other targets to build documentation for thorns).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-thornlist</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 915--><p class="noindent" >regenerates the <span 
class="cmtt-10">ThornList </span>for a configuration.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-utils [UTILS</span>\(=\)<span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">list</span><span 
class="cmtt-10">&#x003E;]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 918--><p class="noindent" >builds all utility programs provided by the thorns of a configuration. Individual
                  utilities can be selected by giving their names (i.e. name of the source file without
                  extension) in the <span 
class="cmtt-10">UTILS </span>variable.
</p>
                  </dd></dl>
<!--l. 926--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B2.4.2   </span> <a 
 id="x1-26000B2.4.2"></a>Compiling in Thorns</h4>
<!--l. 929--><p class="noindent" >Cactus will try to compile all thorns listed in <span 
class="cmtt-10">configs/&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;/ThornList</span>. The <span 
class="cmtt-10">ThornList </span>file is
simply a list of the form <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">arrangement</span><span 
class="cmtt-10">&#x003E;/&#x003C;</span><span 
class="cmsltt-10">thorn</span><span 
class="cmtt-10">&#x003E;</span>. All text after a pound sign ‘<span 
class="cmtt-10">#</span>’ or exclamation
mark ‘<span 
class="cmtt-10">!</span>’ on a line is treated as a comment and ignored. If you did not specify a ThornList already,
the first time that you compile a configuration you will be shown a list of all the thorns in your
arrangement directory, and asked if you with to edit them. You can regenerate this list at anytime by
typing
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">gmake</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-thornlist</span>
</div>
</div>,
<!--l. 945--><p class="noindent" >or you can edit it using
</p>
<div class="alltt">
                                                                                       
                                                                                       
<div class="obeylines-v">
<br /><span 
class="cmtt-10">gmake</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;-editthorns</span>
</div>
</div>.
<!--l. 951--><p class="noindent" >Instead of using the editor to specify the thorns you want to have compiled, you can <span 
class="cmti-10">edit </span>the <span 
class="cmtt-10">ThornList </span>outside
the make process. It is located in <span 
class="cmtt-10">configs/&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;/ThornList</span>, where <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E; </span>refers to the name of
your configuration. The directory <span 
class="cmtt-10">./configs </span>exists  <span 
class="cmti-10">after </span>the very first make phase for the first
configuration.
</p><!--l. 958--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B2.4.3   </span> <a 
 id="x1-27000B2.4.3"></a>Notes and Caveats</h4>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 960--><p class="noindent" > If during the build you see the error “<span 
class="cmtt-10">missing separator</span>”, you are probably not using GNU
     make.
     </p></li>
     <li class="itemize">
     <!--l. 962--><p class="noindent" > <span 
class="cmti-10">The EDITOR environment variable</span>. You may not be aware of this, but this thing very often exists
     and, may be set by default to something scary like <span 
class="cmtt-10">vi</span>. If you don’t know how to use <span 
class="cmtt-10">vi</span>, or wish to
     use your favorite editor instead, reset this environment variable. (To exit <span 
class="cmtt-10">vi </span>type <span 
class="cmtt-10">&#x003C;ESC&#x003E; :q!</span>)</p></li></ul>
<!--l. 970--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">B2.4.4   </span> <a 
 id="x1-28000B2.4.4"></a><span 
class="cmtt-10">gmake </span>Options for building configurations</h4>
<!--l. 973--><p class="noindent" >An <span 
class="cmti-10">option </span>for <span 
class="cmtt-10">gmake </span>can be thought of as an argument which tells it how it should make a <span 
class="cmti-10">target</span>. Note that the
final result is always the same.
</p><!--l. 977--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">target</span><span 
class="cmtt-10">&#x003E; PROMPT=no</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 978--><p class="noindent" >turns off all prompts from the make system.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">target</span><span 
class="cmtt-10">&#x003E; VERBOSE=yes</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 980--><p class="noindent" >prints the commands that gmake is executing.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">target</span><span 
class="cmtt-10">&#x003E; WARN=yes</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 982--><p class="noindent" >shows compiler warnings during compilation.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">target</span><span 
class="cmtt-10">&#x003E; FJOBS=&#x003C;</span><span 
class="cmsltt-10">number</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 984--><p class="noindent" >compiles in parallel, across files within each thorn.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">target</span><span 
class="cmtt-10">&#x003E; TJOBS=&#x003C;</span><span 
class="cmsltt-10">number</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 986--><p class="noindent" >compiles in parallel, across thorns.
</p>
                  </dd></dl>
<!--l. 991--><p class="noindent" >Note that with more modern versions of gmake, it is sufficient to pass the normal <span 
class="cmtt-10">-j &#x003C;</span><span 
class="cmsltt-10">number</span><span 
class="cmtt-10">&#x003E; </span>flag to gmake to
get parallel compilation.
</p><!--l. 1000--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">B2.5   </span> <a 
 id="x1-29000B2.5"></a>Other gmake Targets</h3>
<!--l. 1002--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">gmake help</span>        </dt><dd 
class="list">
                  <!--l. 1004--><p class="noindent" >lists all make options.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake configinfo</span>  </dt><dd 
class="list">
                  <!--l. 1006--><p class="noindent" >prints  configuration  options  for  every  configuration  found  in  user’s  <span 
class="cmtt-10">configs</span>
                  subdirectory.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake default</span>     </dt><dd 
class="list">
                  <!--l. 1009--><p class="noindent" >creates a new configuration with a default name.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake distclean</span>   </dt><dd 
class="list">
                  <!--l. 1011--><p class="noindent" >deletes your <span 
class="cmtt-10">configs </span>directory, and hence all your configurations.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake downsize</span>    </dt><dd 
class="list">
                  <!--l. 1013--><p class="noindent" >removes  non-essential  files  as  documents  and  test  suites  to  allow  for  minimal
                  installation size.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake newthorn</span>    </dt><dd 
class="list">
                  <!--l. 1016--><p class="noindent" >creates a new thorn, prompting for the necessary information and creating template
                  files.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake TAGS</span>        </dt><dd 
class="list">
                  <!--l. 1019--><p class="noindent" >creates an Emacs style TAGS file. See section <a 
href="#x1-212000D7">D7<!--tex4ht:ref: sec:Appendix.tags --></a> for using tags within Cactus.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake tags</span>        </dt><dd 
class="list">
                  <!--l. 1022--><p class="noindent" >creates a <span 
class="cmtt-10">vi </span>style tags file. See section <a 
href="#x1-212000D7">D7<!--tex4ht:ref: sec:Appendix.tags --></a> for using tags within Cactus.
</p>
                  </dd></dl>
<!--l. 1027--><p class="noindent" ><span 
class="cmbx-10">Targets to generate Cactus documentation:</span>
</p><!--l. 1030--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">arrangement</span><span 
class="cmtt-10">&#x003E;-ArrangementDoc</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1032--><p class="noindent" >builds the documentation for the arrangement.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake ArrangementDoc</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1035--><p class="noindent" >builds the documentation for all arrangements.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake MaintGuide</span>  </dt><dd 
class="list">
                  <!--l. 1038--><p class="noindent" >runs LaTeX to produce a copy of the Maintainers’ Guide.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake ReferenceManual</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1041--><p class="noindent" >runs LaTeX to produce a copy of the Reference Manual.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">thorn</span><span 
class="cmtt-10">&#x003E;-ThornDoc</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1044--><p class="noindent" >builds the documentation for the thorn.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake ThornDoc</span>    </dt><dd 
class="list">
                  <!--l. 1047--><p class="noindent" >builds the documentation for all thorns.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake UsersGuide</span>  </dt><dd 
class="list">
                  <!--l. 1049--><p class="noindent" >runs LaTeX to produce a copy of the Users’ Guide.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">gmake AllDoc</span>      </dt><dd 
class="list">
                  <!--l. 1052--><p class="noindent" >creates all of the above documentations.
</p>
                  </dd></dl>
<!--l. 1057--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">B2.6   </span> <a 
 id="x1-30000B2.6"></a>Testing</h3>
<!--l. 1060--><p class="noindent" >Some thorns come with a test suite, consisting of test parameter files and the output files generated by running
these. To run the test suite for the all thorns you have compiled use
</p><!--l. 1064--><p class="noindent" ><span 
class="cmtt-10">gmake &#x003C;</span><span 
class="cmsltt-10">configuration</span><span 
class="cmtt-10">&#x003E;-testsuite</span>
</p><!--l. 1066--><p class="noindent" >which interactively query for which tests to run and how many MPI processes to use.
</p><!--l. 1069--><p class="noindent" >You can use environment variables or variables set on the <span 
class="cmtt-10">gmake </span>command line to choose defaults for these for
non-interactive use.
</p><!--l. 1072--><p class="noindent" >Setting <span 
class="cmsltt-10">CCTK</span><span 
class="cmsltt-10">_TESTSUITE</span><span 
class="cmsltt-10">_RUN</span><span 
class="cmsltt-10">_TESTS </span>to a space separated list of <span 
class="cmsltt-10">thorn </span>and <span 
class="cmsltt-10">thorn/test </span>entries lets you choose
which tests to run.
</p><!--l. 1075--><p class="noindent" >Setting <span 
class="cmsltt-10">CCTK</span><span 
class="cmsltt-10">_TESTSUITE</span><span 
class="cmsltt-10">_PARALLEL</span><span 
class="cmsltt-10">_TESTS </span>to a non-zero value lets you run that many tests simulataneously.
Depending on your MPI stack used this may require disabling automatic core binding avoid binding rank 0 of
multiple tests to the same compute core.
</p><!--l. 1080--><p class="noindent" >Setting <span 
class="cmsltt-10">TESTS</span><span 
class="cmsltt-10">_DIR </span>lets you choose the directory where tests are run in, by default this is the <span 
class="cmtt-10">TEST </span>directory in
the Cactus main directory.
</p><!--l. 1084--><p class="noindent" >Setting <span 
class="cmsltt-10">CCTK</span><span 
class="cmsltt-10">_TESTSUITE</span><span 
class="cmsltt-10">_RUN</span><span 
class="cmsltt-10">_PROCESSORS </span>chooses the number MPI processes (ranks) to use. It defaults to
\(2\).
</p><!--l. 1087--><p class="noindent" >Setting <span 
class="cmsltt-10">CCTK</span><span 
class="cmsltt-10">_TESTSUITE</span><span 
class="cmsltt-10">_RUN</span><span 
class="cmsltt-10">_COMMAND </span>sets the command to execute to start a single test. Cactus will replace
the strings <span 
class="tcst-1000">$</span><span 
class="cmsltt-10">nprocs</span>, <span 
class="tcst-1000">$</span><span 
class="cmsltt-10">exe</span>, and <span 
class="tcst-1000">$</span><span 
class="cmsltt-10">parfile </span>by the requested number of MPI processes, the Cactus executable of
the configuration being tested and the test parameter file. It defaults to <span 
class="cmtt-10">mpirun -np </span><span 
class="tctt-1000">$</span><span 
class="cmtt-10">nprocs </span><span 
class="tctt-1000">$</span><span 
class="cmtt-10">exe </span><span 
class="tctt-1000">$</span><span 
class="cmtt-10">parfile </span>if
MPI is used and <span 
class="tctt-1000">$</span><span 
class="cmtt-10">exe </span><span 
class="tctt-1000">$</span><span 
class="cmtt-10">parfile </span>otherwise.
</p><!--l. 1094--><p class="noindent" >Setting <span 
class="cmsltt-10">PROMPT </span>to <span 
class="cmtt-10">no </span>skips the interactive prompts and uses the (potentially customized) defaults.
</p><!--l. 1097--><p class="noindent" >These test suite serve the dual purpose of
</p><!--l. 1099--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
                                                                                       
                                                                                       
<span 
class="cmss-10">Regression testing</span>    </dt><dd 
class="list">
                  <!--l. 1100--><p class="noindent" >i.e. making sure that changes to the thorn or the flesh don’t affect the output from
                  a known parameter file.
                  </p></dd><dt class="list">
<span 
class="cmss-10">Portability testing</span>    </dt><dd 
class="list">
                  <!--l. 1103--><p class="noindent" >i.e. checking that the results are independent of the architecture—this is also of use
                  when trying to get Cactus to work on a new architecture.</p></dd></dl>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter B3</span><br /><a 
 id="x1-31000B3"></a>Runtime options</h2>
<!--l. 1113--><p class="noindent" >This chapter covers all aspects for running your Cactus executable. These include: command-line options,
parameter file syntax, understanding screen output, environment variables, and creating thorn
documentation.
</p>
<h3 class="sectionHead"><span class="titlemark">B3.1   </span> <a 
 id="x1-32000B3.1"></a>Command-Line Options</h3>
<!--l. 1121--><p class="noindent" >Cactus uses the standard GNU style of long-named command-line options; many of these options also have
traditional Unix single-letter short forms. The options follow the usual GNU rules: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1125--><p class="noindent" >A long-named option <span class="obeylines-h"><code class="verb">--foo</code></span> which takes an argument <span class="obeylines-h"><code class="verb">bar</code></span> may be written as either <span class="obeylines-h"><code class="verb">--foo bar</code></span> or
     as <span class="obeylines-h"><code class="verb">--foo=bar</code></span>.
     </p></li>
     <li class="itemize">
     <!--l. 1127--><p class="noindent" >A long-named option may be abbreviated, so long as the abbreviation is unambiguous.
     </p></li>
     <li class="itemize">
     <!--l. 1129--><p class="noindent" >The preferred way of spelling a long-named option is <span class="obeylines-h"><code class="verb">--foo</code></span>, but <span class="obeylines-h"><code class="verb">-foo</code></span> also accepted, though this is
     deprecated.
     </p></li>
     <li class="itemize">
     <!--l. 1131--><p class="noindent" >A short option, <span class="obeylines-h"><code class="verb">-X</code></span>, which takes an argument <span class="obeylines-h"><code class="verb">bar</code></span> may be written as either <span class="obeylines-h"><code class="verb">-Xbar</code></span> or as <span class="obeylines-h"><code class="verb">-X=bar</code></span>.
     </p></li>
     <li class="itemize">
     <!--l. 1133--><p class="noindent" >An option which can be interpreted as either a short option, or as an abbreviated <span class="obeylines-h"><code class="verb">-foo</code></span>-style
     long option, is interpreted as the former. In particular, <span class="obeylines-h"><code class="verb">-re</code></span> is interpreted as an abbreviation for
     <span class="obeylines-h"><code class="verb">-redirect</code></span>, rather than as <span class="obeylines-h"><code class="verb">-r=e</code></span>.</p></li></ul>
<!--l. 1139--><p class="noindent" >The Cactus command-line options are specified in Table <a 
href="#x1-320011">B3.1<!--tex4ht:ref: tab:command-line-options --></a>, and are as follows:
</p>
<div class="table">
                                                                                       
                                                                                       
<!--l. 1144--><p class="noindent" ><a 
 id="x1-320011"></a></p><hr class="float" /><div class="float" 
>
                                                                                       
                                                                                       
<!--tex4ht:inline--><div class="tabular"> <table id="TBL-1" class="tabular" 
 
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1" /></colgroup><colgroup id="TBL-1-2g"><col 
id="TBL-1-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-1"  
class="td11"> <span 
class="cmtt-10">Short Version        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-2"  
class="td11"> <span 
class="cmtt-10">Long Version                              </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-1"  
class="td11"> <span 
class="cmtt-10">-O[v]                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-2"  
class="td11"> <span 
class="cmtt-10">--describe-all-parameters                 </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-1"  
class="td11"> <span 
class="cmtt-10">-o&#x003C;</span><span 
class="cmsltt-10">param</span><span 
class="cmtt-10">&#x003E;             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-2"  
class="td11"> <span 
class="cmtt-10">--describe-parameter=&#x003C;</span><span 
class="cmsltt-10">param</span><span 
class="cmtt-10">&#x003E;              </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-4-1"  
class="td11"> <span 
class="cmtt-10">-S                    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-4-2"  
class="td11"> <span 
class="cmtt-10">--print-schedule                          </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-5-1"  
class="td11"> <span 
class="cmtt-10">-T                    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-5-2"  
class="td11"> <span 
class="cmtt-10">--list-thorns                             </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-6-1"  
class="td11">
 <span 
class="cmtt-10">-t&#x003C;</span><span 
class="cmsltt-10">arrangement/thorn</span><span 
class="cmtt-10">&#x003E; </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-6-2"  
class="td11"> <span 
class="cmtt-10">--test-thorn-compiled=&#x003C;</span><span 
class="cmsltt-10">arrangement/thorn</span><span 
class="cmtt-10">&#x003E; </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-7-1"  
class="td11">
 <span 
class="cmtt-10">-h,-?                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-7-2"  
class="td11"> <span 
class="cmtt-10">--help                                    </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-8-1"  
class="td11"> <span 
class="cmtt-10">-v </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-8-2"  
class="td11"> <span 
class="cmtt-10">--version </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-9-1"  
class="td11"> <span 
class="cmtt-10">-L&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-9-2"  
class="td11"> <span 
class="cmtt-10">--logging-level=&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;                   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-10-1"  
class="td11"> <span 
class="cmtt-10">-W&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-10-2"  
class="td11"> <span 
class="cmtt-10">--warning-level=&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;                   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-11-1"  
class="td11"> <span 
class="cmtt-10">-E&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-11-2"  
class="td11"> <span 
class="cmtt-10">--error-level=&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;                     </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-12-1"  
class="td11"> <span 
class="cmtt-10">-r[o|e|oe|eo]         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-12-2"  
class="td11"> <span 
class="cmtt-10">--redirect=[o|e|oe|eo]                    </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-13-1"  
class="td11"> <span 
class="cmtt-10">-R[o|e|oe|eo]         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-13-2"  
class="td11"> <span 
class="cmtt-10">--Redirect=[o|e|oe|eo]                    </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-14-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-14-1"  
class="td11">                        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-14-2"  
class="td11"> <span 
class="cmtt-10">--logdir=&#x003C;</span><span 
class="cmsltt-10">directory</span><span 
class="cmtt-10">&#x003E;                      </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-15-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-15-1"  
class="td11"> <span 
class="cmtt-10">-b[no|line|full]      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-15-2"  
class="td11"> <span 
class="cmtt-10">--buffering=[no|line|full]                </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-16-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-16-1"  
class="td11">                        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-16-2"  
class="td11"> <span 
class="cmtt-10">--parameter-level=&#x003C;strict|normal|relaxed&#x003E; </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-17-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-17-1"  
class="td11"> <span 
class="cmtt-10">-i                    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-17-2"  
class="td11"> <span 
class="cmtt-10">--ignore-next                             </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-18-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-18-1"  
class="td11">                        </td></tr></table>                                                             </div>
<br /> <div class="caption" 
><span class="id">Table B3.1: </span><span  
class="content">This table shows all the Cactus command-line options.</span></div><!--tex4ht:label?: x1-320011 -->
                                                                                       
                                                                                       
</div><hr class="endfloat" />
</div>
                  <dl class="list1"><dt class="list">
<span 
class="cmtt-10">-O </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--describe-all-parameters</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1194--><p class="noindent" >Prints a full list of all parameters from all thorns which were compiled, along with
                  descriptions and allowed values. This can take an optional extra parameter <span 
class="cmtt-10">v </span>(i.e.
                  <span 
class="cmtt-10">-Ov </span>to give verbose information about all parameters).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-o&#x003C;</span><span 
class="cmsltt-10">param</span><span 
class="cmtt-10">&#x003E; </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--describe-parameter=&#x003C;</span><span 
class="cmsltt-10">param</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1200--><p class="noindent" >Prints  the  description  and  allowed  values  for  a  given  parameter—takes  one
                  argument.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-S </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--print-schedule</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1204--><p class="noindent" >Print only the schedule tree.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-T </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--list-thorns</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1207--><p class="noindent" >Prints a list of all the thorns which were compiled in.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-t&#x003C;</span><span 
class="cmsltt-10">arrangement or thorn</span><span 
class="cmtt-10">&#x003E; </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--test-thorn-compiled=&#x003C;</span><span 
class="cmsltt-10">arrangement or thorn&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1210--><p class="noindent" >Checks if a given thorn was compiled in—takes one argument.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-h</span><span 
class="cmss-10">, </span><span 
class="cmtt-10">-? </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--help</span>    </dt><dd 
class="list">
                  <!--l. 1213--><p class="noindent" >Prints a help message.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-v </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--version</span>    </dt><dd 
class="list">
                  <!--l. 1216--><p class="noindent" >Prints version information of the code.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-L&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E; </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--logging-level=&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1224--><p class="noindent" >Sets the logging level of the code. All warning messages are given a level—the lower
                  the level the greater the severity. This parameter <span 
class="cmtt-10">-L </span>controls the level of messages
                  to be seen, with all warnings of level \(\le \) <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E; </span>printed to standard output. The
                  default is a logging level of 0, meaning that only level 0 messages should be printed
                  to standard output.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-W&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E; </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--warning-level=&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1232--><p class="noindent" >Similar to <span 
class="cmtt-10">-W</span>, but for standard error instead of standard output. All warnings of
                  level \(\le \) <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E; </span>are printed to standard error. The default is a warning level of 1,
                  meaning that level 0 and level 1 messages should be printed to standard error.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-E&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E; </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--error-level=&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1239--><p class="noindent" >Similar to <span 
class="cmtt-10">-W</span>, but for fatal errors: Cactus treats all warnings with level \(\le \) <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">level</span><span 
class="cmtt-10">&#x003E;</span>
                  as fatal errors, and aborts the Cactus run immediately (after printing the warning
                  message<span class="footnote-mark"><a 
href="UsersGuide3.html#fn1x7"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-32002f1"></a> ).
                  The default value is zero, i.e. only level 0 warnings will abort the Cactus run.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-r[o|e|oe|eo] </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--redirect=[o|e|oe|eo]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1251--><p class="noindent" >Redirects the standard output (‘<span 
class="cmtt-10">o</span>’) and/or standard error (‘<span 
class="cmtt-10">e</span>’) of each processor
                  to a file. By default, the standard outputs from processors other than processor 0
                  are discarded.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-R[o|e|oe|eo] </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--Redirect=[o|e|oe|eo]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1256--><p class="noindent" >Redirects the standard output (‘<span 
class="cmtt-10">o</span>’) and/or standard error (‘<span 
class="cmtt-10">e</span>’) of each processor
                  to a file like <span 
class="cmtt-10">-r </span>does, however different from <span 
class="cmtt-10">-r </span>it also redirects standard output
                  and/or standard error from processor 0.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">--logdir=&#x003C;</span><span 
class="cmsltt-10">directory</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1262--><p class="noindent" >Sets the output directory for logfiles created by the <span 
class="cmtt-10">-r </span>option. If the directory
                  doesn’t exist yet, it will be created by Cactus.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-b[no|line|full] </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--buffering=[no|line|full]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1266--><p class="noindent" >Set the <span 
class="cmtt-10">stdout </span>buffering mode. Buffered I/O is a standard feature of C programmes.
                  This  delays  writing  the  actual  output;  instead,  the  output  is  collected  into  an
                  internal buffer, and is then written in large chunks. This improves performance
                  considerably.  Line  buffering  means  that  output  is  written  whenever  a  newline
                  character is encountered; full buffering means that output is written, say, once 1000
                  characters have accumulated. The default setting is line buffering for I/O that goes
                  to a terminal, and full buffering for I/O that goes to a file. For debugging purposes,
                  it is sometimes useful to reduce the amount of buffering. Error messages, i.e. the
                  <span 
class="cmtt-10">stderr </span>stream, is always unbuffered (and hence usually slower than <span 
class="cmtt-10">stdout</span>).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">--parameter-level=&#x003C;strict|normal|relaxed&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1280--><p class="noindent" >Sets the level of parameter checking to be used, one of <span 
class="cmtt-10">strict </span>(the default), <span 
class="cmtt-10">normal</span>,
                  or <span 
class="cmtt-10">relaxed</span>. See Section <a 
href="#x1-33000B3.2">B3.2<!--tex4ht:ref: sec:Parameter_File --></a> for details.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">-i </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">--ignore-next</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1285--><p class="noindent" >Causes the next argument on the command line to be ignored.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 1289--><p class="noindent" >A dash (“<span 
class="cmtt-10">-</span>”) appended at the end of the command line like this:
</p><!--l. 1291--><p class="noindent" ><span 
class="cmtt-10">./cactus</span><span 
class="cmtt-10">_&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E; [</span><span 
class="cmsltt-10">command-line options</span><span 
class="cmtt-10">] -</span>
</p><!--l. 1293--><p class="noindent" >lets the user specify parameter values from standard input rather than from a parameter file.
</p>
<h3 class="sectionHead"><span class="titlemark">B3.2   </span> <a 
 id="x1-33000B3.2"></a>Parameter File Syntax</h3>
<!--l. 1302--><p class="noindent" >A <span 
class="cmti-10">parameter file </span>(or <span 
class="cmti-10">par file</span>) is used to control the behaviour of a Cactus executable. It specifies initial values for
parameters as defined in the various thorns’ <span 
class="cmtt-10">param.ccl </span>files (see Chapter <a 
href="#x1-67000C1.4">C1.4<!--tex4ht:ref: chap:Cactus_parameters --></a>). The name of a parameter file is
often given the suffix <span 
class="cmtt-10">.par</span>, but this is not mandatory.
</p><!--l. 1309--><p class="noindent" >A parameter file is a text file whose lines are either blank lines, or parameter statements. Comments may also be
included and consist of a ‘<span 
class="cmtt-10">#</span>’ and all following characters. A parameter statement is an expression of the form
<span 
class="cmti-10">Left-Hand-Side </span>= <span 
class="cmti-10">Right-Hand-Side</span>. The <span 
class="cmti-10">Left-Hand-Side </span>may be a fully qualified parameter name (i.e. a thorn or
implementation name, two colons, and a name defined in a <span class="obeylines-h"><code class="verb">param.ccl</code></span> file), a variable name (the ‘<span 
class="tcti-1000">$</span>’
character followed by a C-identifier), or the special variable <span 
class="cmti-10">ActiveThorns</span>. The <span 
class="cmti-10">Right-Hand-Side </span>is a
value.
</p><!--l. 1319--><p class="noindent" >Values can be any of the following (all of which are case insensitive): </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1321--><p class="noindent" >Booleans: Booleans are either <span 
class="cmti-10">true </span>(i.e. 1, <span class="obeylines-h"><code class="verb">true</code></span>, <span class="obeylines-h"><code class="verb">on</code></span>, <span class="obeylines-h"><code class="verb">&#x0022;true&#x0022;</code></span>, or <span class="obeylines-h"><code class="verb">&#x0022;on&#x0022;</code></span>) or <span 
class="cmti-10">false </span>(i.e. 0, <span class="obeylines-h"><code class="verb">false</code></span>, <span class="obeylines-h"><code class="verb">off</code></span>,
     <span class="obeylines-h"><code class="verb">&#x0022;false&#x0022;</code></span>, or <span class="obeylines-h"><code class="verb">&#x0022;off&#x0022;</code></span>).
     </p></li>
     <li class="itemize">
     <!--l. 1324--><p class="noindent" >Integers: Integers can be positive or negative.
     </p></li>
     <li class="itemize">
     <!--l. 1325--><p class="noindent" >Real numbers: Real numbers can be positive or negative and may be written with exponents (e.g.
     <span class="obeylines-h"><code class="verb">1.0e-3</code></span>, or <span class="obeylines-h"><code class="verb">-2.94d+10</code></span>).
     </p></li>
     <li class="itemize">
     <!--l. 1327--><p class="noindent" >Keywords: For keyword parameters, only the values enumerated in the parameter file are allowed.
     Like booleans, keywords may be put inside quotes. If they contain characters other than those found
     in C-identifiers, they must be.
     </p></li>
     <li class="itemize">
     <!--l. 1330--><p class="noindent" >Strings: Sequences of characters delimited by quotes. If a quote is preceded by a backslash, it is not
     counted as a closing quote. A sequence of two backslashes will be interpreted as a single backslash.
     </p></li>
     <li class="itemize">
                                                                                       
                                                                                       
     <!--l. 1337--><p class="noindent" >Variables: Parameter values can also contain variables of the form <span class="obeylines-h"><code class="verb">${VARIABLE}</code></span> or <span class="obeylines-h"><code class="verb">$ENV{VARIABLE}</code></span>. In the
     first form, braces are required when <span class="obeylines-h"><code class="verb">VARIABLE</code></span> is followed by a character which is not to be interpreted as
     part of its name and optional otherwise. The second form provides access to all environment variables
     defined in the environment of the executable. Table <a 
href="#x1-330012">B3.2<!--tex4ht:ref: tab:variable-expansions --></a> provides a list of recognized variable strings.
     </p><div class="table">
     <!--l. 1345--><p class="noindent" ><a 
 id="x1-330012"></a></p><hr class="float" /><div class="float" 
> <!--tex4ht:inline--><div class="tabular"> <table id="TBL-2" class="tabular" 
 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /><col 
id="TBL-2-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11"> variable string  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"  
class="td11"> expands to                                                                </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11"> <span class="obeylines-h"><code class="verb">$ENV{envname}</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"  
class="td11"> the value of the environment variable <span class="obeylines-h"><code class="verb">$envname</code></span>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11"> <span class="obeylines-h"><code class="verb">$parfile</code></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"  
class="td11"> the path to the variable file with <span class="obeylines-h"><code class="verb">.par</code></span> removed at the end  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11"> <span class="obeylines-h"><code class="verb">$pi</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"  
class="td11"> the numerical value of \(\pi \)                                                </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"  
class="td11">               </td></tr></table>                                                                     </div>
<br /> <div class="caption" 
><span class="id">Table B3.2: </span><span  
class="content">Variable expansions recognized by the variable file parser when expanding variables in
parameter files</span></div><!--tex4ht:label?: x1-330012 -->
     </div><hr class="endfloat" />
     </div>
     <!--l. 1362--><p class="noindent" >In addition to the above, it is possible to create and use other variables by assignment, e.g.
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-6">
     $my_factor = 0.5
     CoordBase::dx = 3.0*$my_factor
     CoordBase::dy = 3.0*$my_factor
</pre>
     <!--l. 1368--><p class="nopar" >
     </p></li>
     <li class="itemize">
     <!--l. 1369--><p class="noindent" >Expressions: Parameters statements of numeric or boolean type can use arithmetic expressions in place of
     explicit values. The usual arithmetic operations as well as C-like transcendental functions and relational
     operations are supported. Integer division is handled as in C. Logical comparisons and variables expect
     a boolean type. The exponentiation operator <span class="obeylines-h"><code class="verb">**</code></span> is supported, but can only apply to two
     values. The expression <span class="obeylines-h"><code class="verb">3**4**2</code></span> is not supported, but <span class="obeylines-h"><code class="verb">(3**4)**2</code></span> or <span class="obeylines-h"><code class="verb">3**(4**2)</code></span> is supported.
     Operator precedence follows the C language, but when in doubt use explicit parenthesis to force a
     desired order of evaluation. Table <a 
href="#x1-330023">B3.3<!--tex4ht:ref: tab:expression_functions --></a> lists the supported functions. Expressions can refer to
     parameters which are already set by using the fully qualified name <span 
class="cmtt-10">thorn::parameter </span>as described
     below.
     </p><!--l. 1384--><p class="noindent" >The <span class="obeylines-h"><code class="verb">%</code></span> operator is applicable only to integers. In cases where this is clear, types will be converted, e.g. <span class="obeylines-h"><code class="verb">3.0</code></span>
     will convert to an integer, but not <span class="obeylines-h"><code class="verb">3.1</code></span>. If you wish to prevent the parser from evaluating an expression,
     you can put it in double quotes and make it a string.
     </p></li>
     <li class="itemize">
     <!--l. 1389--><p class="noindent" >Array assignments:
     </p><!--l. 1391--><p class="noindent" >Arrays of parameters can be set by including an integer expression inside the square brackets following the
     name, e.g. <span 
class="cmtt-10">thorn::parameters[0]</span>. Optionally, an array of parameters may be set by means of a
     comma delimited list of values inside square brackets. E.g. the following two examples are
     equivalent.
     </p><!--l. 1397--><p class="noindent" >Example 1:
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-7">
     thorn::parameters[0] = 4.8
     thorn::parameters[1] = 3.2
</pre>
     <!--l. 1401--><p class="nopar" >
     </p><!--l. 1403--><p class="noindent" >Example 2:
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-8">
     thorn::parameters = [4.8, 3.2]
</pre>
     <!--l. 1406--><p class="nopar" >
     </p><!--l. 1408--><p class="noindent" >Please see the file <span 
class="cmtt-10">par.peg </span>in the directory <span 
class="cmtt-10">Cactus/src/piraha/pegs </span>for the full grammar describing the
     par file.</p></li></ul>
<div class="table">
<!--l. 1411--><p class="noindent" ><a 
 id="x1-330023"></a></p><hr class="float" /><div class="float" 
>
                                                                                       
                                                                                       
<div class="tabular"> <table id="TBL-3" class="tabular" 
 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1" /><col 
id="TBL-3-2" /></colgroup><colgroup id="TBL-3-3g"><col 
id="TBL-3-3" /><col 
id="TBL-3-4" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td colspan="2" style="white-space:nowrap; text-align:center;" id="TBL-3-1-1"  
class="td11">        <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Logical operators</div>             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-3"  
class="td01"> <span class="obeylines-h"><code class="verb">!</code></span>             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-4"  
class="td11"> logical not                            </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-1"  
class="td11"> <span class="obeylines-h"><code class="verb">&#x0026;&#x0026;</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-2"  
class="td10"> logical and                       </td><td colspan="2" style="white-space:nowrap; text-align:center;" id="TBL-3-2-3"  
class="td01">            <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Mathematical functions</div>                    
</td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-1"  
class="td11"> <span class="obeylines-h"><code class="verb">||</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-2"  
class="td10"> logical or                         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-3"  
class="td01"> <span class="obeylines-h"><code class="verb">acos</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-4"  
class="td11"> inverse cosine                        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td colspan="2" style="white-space:nowrap; text-align:center;" id="TBL-3-4-1"  
class="td11">       <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Relational operators</div>            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-3"  
class="td01"> <span class="obeylines-h"><code class="verb">asin</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-4"  
class="td11"> inverse sine                          </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-1"  
class="td11"> <span class="obeylines-h"><code class="verb">==</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-2"  
class="td10"> tests for equality               </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-3"  
class="td01"> <span class="obeylines-h"><code class="verb">atan</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-4"  
class="td11"> inverse tangent                     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-1"  
class="td11"> <span class="obeylines-h"><code class="verb">!=</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-2"  
class="td10"> tests for inequality             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-3"  
class="td01"> <span class="obeylines-h"><code class="verb">ceil</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-4"  
class="td11"> round up to nearest integer     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-1"  
class="td11"> <span class="obeylines-h"><code class="verb">&#x003C;</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-2"  
class="td10"> tests for less than              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-3"  
class="td01"> <span class="obeylines-h"><code class="verb">cos</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-4"  
class="td11"> cosine                                 </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-8-1"  
class="td11">
 <span class="obeylines-h"><code class="verb">&#x003E;</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-8-2"  
class="td10"> tests for greater than          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-8-3"  
class="td01"> <span class="obeylines-h"><code class="verb">cosh</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-8-4"  
class="td11"> hyperbolic cosine                   </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-9-1"  
class="td11">
 <span class="obeylines-h"><code class="verb">&#x003C;=</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-9-2"  
class="td10"> tests for less or equal          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-9-3"  
class="td01"> <span class="obeylines-h"><code class="verb">exp</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-9-4"  
class="td11"> exponentiation \(e^x\)                     </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-10-1"  
class="td11">
 <span class="obeylines-h"><code class="verb">&#x003E;=</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-10-2"  
class="td10"> tests for greater or equal     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-10-3"  
class="td01"> <span class="obeylines-h"><code class="verb">abs</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-10-4"  
class="td11"> absolute value \(|x|\)                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-11-"><td colspan="2" style="white-space:nowrap; text-align:center;" id="TBL-3-11-1"  
class="td11">         <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Binary operators</div>              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-11-3"  
class="td01"> <span class="obeylines-h"><code class="verb">floor</code></span>         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-11-4"  
class="td11"> round down to nearest integer  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-12-1"  
class="td11"> <span class="obeylines-h"><code class="verb">+</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-12-2"  
class="td10"> addition                           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-12-3"  
class="td01"> <span class="obeylines-h"><code class="verb">log</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-12-4"  
class="td11"> natural logarithm                  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-13-1"  
class="td11"> <span class="obeylines-h"><code class="verb">-</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-13-2"  
class="td10"> subtraction                       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-13-3"  
class="td01"> <span class="obeylines-h"><code class="verb">bool,int,real</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-13-4"  
class="td11"> convert to bool, int, or real      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-14-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-14-1"  
class="td11"> <span class="obeylines-h"><code class="verb">/</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-14-2"  
class="td10"> C-like division                   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-14-3"  
class="td01"> <span class="obeylines-h"><code class="verb">sin</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-14-4"  
class="td11"> sine                                    </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-15-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-15-1"  
class="td11"> <span class="obeylines-h"><code class="verb">%</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-15-2"  
class="td10"> remainder of division          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-15-3"  
class="td01"> <span class="obeylines-h"><code class="verb">sinh</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-15-4"  
class="td11"> hyperbolic sine                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-16-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-16-1"  
class="td11"> <span class="obeylines-h"><code class="verb">*</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-16-2"  
class="td10"> multiplication                   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-16-3"  
class="td01"> <span class="obeylines-h"><code class="verb">sqrt</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-16-4"  
class="td11"> square root                          </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-17-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-17-1"  
class="td11"> <span class="obeylines-h"><code class="verb">**</code></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-17-2"  
class="td10"> exponentiation \(x^y\)                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-17-3"  
class="td01"> <span class="obeylines-h"><code class="verb">cbrt</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-17-4"  
class="td11"> cube root                             </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-18-"><td colspan="2" style="white-space:nowrap; text-align:center;" id="TBL-3-18-1"  
class="td11">         <div class="multicolumn"  style="white-space:nowrap; text-align:center;">Unary operators</div>              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-18-3"  
class="td01"> <span class="obeylines-h"><code class="verb">tan</code></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-18-4"  
class="td11"> tangent                               </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-19-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-19-1"  
class="td11"> <span class="obeylines-h"><code class="verb">-</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-19-2"  
class="td10"> negate sign                       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-19-3"  
class="td01"> <span class="obeylines-h"><code class="verb">tanh</code></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-19-4"  
class="td11"> hyperbolic tangent                 </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-20-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-20-1"  
class="td11"> <span class="obeylines-h"><code class="verb">+</code></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-20-2"  
class="td10"> no-op                              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-20-3"  
class="td01"> <span class="obeylines-h"><code class="verb">trunc</code></span>         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-20-4"  
class="td11"> integer part of \(x\)                     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-21-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-21-1"  
class="td11">    </td></tr></table>                                                                                </div>
<br /> <div class="caption" 
><span class="id">Table B3.3: </span><span  
class="content">Supported functions inside of expressions, in increasing order of precedence.</span></div><!--tex4ht:label?: x1-330023 -->
                                                                                       
                                                                                       
</div><hr class="endfloat" />
</div>
<!--l. 1460--><p class="noindent" >Every parameter file should set <span 
class="cmtt-10">ActiveThorns</span>, which is a special parameter that tells the program which <span 
class="cmti-10">thorns</span>
are to be activated. One may set <span 
class="cmtt-10">ActiveThorns </span>on any line or lines of the par file. In the case where multiple
specifications of ActiveThorns are supplied, the values will be concatenated.
</p><!--l. 1466--><p class="noindent" >Only parameters belonging to active thorns can be set (and only those routines <span 
class="cmti-10">scheduled </span>by active thorns are
run). By default, all thorns are inactive. For example, the first entry in a parameter file which is using just the
two thorns <span 
class="cmtt-10">CactusPUGH/PUGH </span>and <span 
class="cmtt-10">CactusBase/CartGrid3D </span>should be
</p><!--l. 1472--><p class="noindent" ><span 
class="cmtt-10">ActiveThorns = &#x0022;PUGH CartGrid3D&#x0022;</span>
</p><!--l. 1474--><p class="noindent" >All parameters following the <span 
class="cmtt-10">ActiveThorns </span>parameter have names whose syntax depends on the scope (see
Section <a 
href="#x1-74000C1.4.2">C1.4.2<!--tex4ht:ref: sec:Cactus_parameters.scope --></a>) of the parameter:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">Restricted parameters</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1482--><p class="noindent" >The name of the <span 
class="cmti-10">implementation </span>which defined the parameter, followed by two
                  colons, then the name of the parameter—e.g. <span 
class="cmtt-10">driver::global</span><span 
class="cmtt-10">_nx</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Private parameters</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1486--><p class="noindent" >The name of the <span 
class="cmti-10">thorn </span>which defined the parameter, two colons, and the name of
                  the parameter—e.g. <span 
class="cmtt-10">wavetoyF77::amplitude</span>.</p></dd></dl>
<!--l. 1491--><p class="noindent" >This notation is not currently strictly enforced in the code. It is sufficient to specify the first part of the
parameter name using either the implementation name, or the thorn name. However, we recommend that the
above convention be followed.
</p><!--l. 1496--><p class="noindent" >The Cactus flesh performs checks for consistency and range of parameters. The severity of these checks
is controlled by the command-line argument <span 
class="cmtt-10">--parameter-level</span>, which can take the following
values
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">relaxed</span>           </dt><dd 
class="list">
                  <!--l. 1500--><p class="noindent" >Cactus will issue a level 0 warning (that is, the default behaviour will be to terminate) if
                  </p>
                      <ul class="itemize1">
                      <li class="itemize">
                      <!--l. 1503--><p class="noindent" > The specified parameter value is outside of the allowed range.</p></li></ul>
                  </dd><dt class="list">
<span 
class="cmtt-10">normal</span>            </dt><dd 
class="list">
                  <!--l. 1506--><p class="noindent" >This provides the same warnings as the <span 
class="cmtt-10">relaxed </span>level, with the addition of a level 0
                  warning issued for </p>
                      <ul class="itemize1">
                      <li class="itemize">
                                                                                       
                                                                                       
                      <!--l. 1510--><p class="noindent" > An implementation and/or thorn <span 
class="cmtt-10">foo </span>is active, but the parameter <span 
class="cmtt-10">foo::bar</span>
                      was not defined.
                      </p></li>
                      <li class="itemize">
                      <!--l. 1512--><p class="noindent" >   The   parameter   <span 
class="cmtt-10">foo::bar  </span>was   successfully   set   for   both   an   active
                      implementation <span 
class="cmtt-10">foo </span>not implemented by a thorn <span 
class="cmtt-10">foo</span>, and to a thorn <span 
class="cmtt-10">foo</span>.</p></li></ul>
                  </dd><dt class="list">
<span 
class="cmtt-10">strict</span>            </dt><dd 
class="list">
                  <!--l. 1517--><p class="noindent" >This is the default, and provides the same warnings as the <span 
class="cmtt-10">normal </span>level, with the addition
                  of a level 0 warning issued for </p>
                      <ul class="itemize1">
                      <li class="itemize">
                      <!--l. 1521--><p class="noindent" >  The  parameter  <span 
class="cmtt-10">foo::bar </span>is  specified  in  the  parameter  file,  but  no
                      implementation or thorn with the name <span 
class="cmtt-10">bar </span>is active.</p></li></ul>
                  </dd></dl>
<!--l. 1526--><p class="noindent" >Notes:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1530--><p class="noindent" > You can obtain lists of the parameters associated with each thorn using the command-line options
     <span 
class="cmtt-10">-o </span>and <span 
class="cmtt-10">-O </span>(Section <a 
href="#x1-32000B3.1">B3.1<!--tex4ht:ref: sec:command_line_options --></a>).
     </p></li>
     <li class="itemize">
     <!--l. 1534--><p class="noindent" > String parameter values can be specified either as unquoted tokens (not containing any whitespace),
     or  as  quoted  values.  If  a  quoted  string  parameter  value  spans  multiple  lines,  all  whitespaces,
     including newline characters, are preserved.
     </p></li>
     <li class="itemize">
     <!--l. 1539--><p class="noindent" > Some parameters are <span 
class="cmti-10">steerable</span>, and can be changed during the execution of a Cactus program using
     parameter steering interfaces, for example, thorn <span 
class="cmtt-10">CactusConnect/HTTPD</span>, or using a parameter file
     when recovering from a checkpoint file.
     </p></li>
     <li class="itemize">
     <!--l. 1544--><p class="noindent" > For examples of parameter files, look in the <span 
class="cmtt-10">par </span>directory contained in most thorns.
</p>
     </li></ul>
<h3 class="sectionHead"><span class="titlemark">B3.3   </span> <a 
 id="x1-34000B3.3"></a>Thorn Documentation</h3>
<!--l. 1552--><p class="noindent" >The Cactus make system provides a mechanism for generating a <span 
class="cmti-10">Thorn Guide </span>containing separate
                                                                                       
                                                                                       
chapters for each thorn and arrangement in your configuration. The documentation provided for an
individual thorn, obviously depends on what the thorn authors added, but the Thorn Guide is a good
place to first look for special instructions on how to run and interpret the output from a thorn.
Details about parameters, grid variables and scheduling are automatically read from a thorn’s CCL
files and included in the Thorn Guide. To construct a Thorn Guide for the configuration \(&lt;\)<span 
class="cmsltt-10">config</span>\(&gt;\)
use
</p><!--l. 1563--><p class="noindent" ><span 
class="cmtt-10">gmake</span> \(&lt;\)<span 
class="cmsltt-10">config</span>\(&gt;\)<span 
class="cmtt-10">-ThornGuide</span>
</p><!--l. 1565--><p class="noindent" >or to make a Thorn Guide for all the thorns in the <span 
class="cmtt-10">arrangements </span>directory
</p><!--l. 1567--><p class="noindent" ><span 
class="cmtt-10">gmake</span> \(&lt;\)<span 
class="cmsltt-10">config</span>\(&gt;\).
</p><!--l. 1569--><p class="noindent" >See Section <a 
href="#x1-115000C1.8.4">C1.8.4<!--tex4ht:ref: sec:Adding_documentation --></a> for a guide to adding documentation to your own thorns.
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter B4</span><br /><a 
 id="x1-35000B4"></a>Getting and Looking at Output</h2>
<h3 class="sectionHead"><span class="titlemark">B4.1   </span> <a 
 id="x1-36000B4.1"></a>Screen Output</h3>
<!--l. 1582--><p class="noindent" >As your Cactus executable runs, standard output and standard error are usually written to the screen. Standard
output provides you with information about the run, and standard error reports warnings and errors from the
flesh and thorns.
</p><!--l. 1587--><p class="noindent" >As the program runs, the normal output provides the following information:
</p><!--l. 1589--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">Active thorns</span>        </dt><dd 
class="list">
                  <!--l. 1591--><p class="noindent" >A report is made as each of the thorns in the <span 
class="cmtt-10">ActiveThorns </span>parameters from the
                  parameter file (see Section <a 
href="#x1-33000B3.2">B3.2<!--tex4ht:ref: sec:Parameter_File --></a>) is attempted to be activated. This report shows
                  whether the thorn activation was successful, and if successful, gives the thorn’s
                  implementation. For example
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-9">
                  Activating thorn idscalarwave...Success -&#x003E; active implementation idscalarwave
</pre>
                  <!--l. 1600--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">Failed parameters</span>    </dt><dd 
class="list">
                  <!--l. 1602--><p class="noindent" >If any of the parameters in the parameter file does not belong to any of the active thorns,
                  or if the parameter value is not in the allowed range (see Section <a 
href="#x1-68000C1.4.1">C1.4.1<!--tex4ht:ref: sec:Parameters.Types_and_Ranges --></a>), an error is
                  registered. For example, if the parameter is not recognised,
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-10">
                  Unknown parameter time::ddtfac
</pre>
                  <!--l. 1610--><p class="nopar" >or if the parameter value is not in the allowed range,
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-11">
                  Unable to set keyword CartGrid3D::type - ByMouth not in any active range
</pre>
                  <!--l. 1615--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">Scheduling information</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1617--><p class="noindent" >The scheduled routines (see Section <a 
href="#x1-76000C1.5">C1.5<!--tex4ht:ref: chap:scheduling --></a>) are listed, in the order that they will be
                  executed. For example,
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-12">
                  ----------------------------------------------------------------------
                    Startup routines
                      Cactus: Register banner for Cactus
                      CartGrid3D: Register GH Extension for GridSymmetry
                      CartGrid3D: Register coordinates for the Cartesian grid
                      IOASCII: Startup routine
                      IOBasic: Startup routine
                      IOUtil: IOUtil startup routine
                      PUGH: Startup routine
                      WaveToyC: Register banner
                  
                    Parameter checking routines
                      CartGrid3D: Check coordinates for CartGrid3D
                      IDScalarWave: Check parameters
                  
                    Initialisation
                      CartGrid3D: Set up spatial 3D Cartesian coordinates on the GH
                      PUGH: Report on PUGH set up
                      Time: Set timestep based on speed one Courant condition
                      WaveToyC: Schedule symmetries
                      IDScalarWave: Initial data for 3D wave equation
                  
                    do loop over timesteps
                      WaveToyC: Evolution of 3D wave equation
                      t = t+dt
                      if (analysis)
                      endif
                    enddo
                  ----------------------------------------------------------------------
</pre>
                  <!--l. 1651--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">Thorn banners</span>       </dt><dd 
class="list">
                  <!--l. 1653--><p class="noindent" >Usually a thorn registers a short piece of text as a <span 
class="cmti-10">banner</span>. The banner of each thorn is
                  displayed in the standard output when the thorn is initialised.
</p>
                  </dd></dl>
<!--l. 1661--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">B4.2   </span> <a 
 id="x1-37000B4.2"></a>Output</h3>
                                                                                       
                                                                                       
<!--l. 1662--><p class="noindent" >Output methods in Cactus are all provided by thorns. Any number of output methods can be used for each run.
The behaviour of the output thorns in the standard arrangements are described in those thorns’
documentation.
</p><!--l. 1667--><p class="noindent" >In general, output thorns decide what to output by parsing a string parameter containing the names of those
grid variables, or groups of variables, for which output is required. The names should be fully qualified with the
implementation and group or variable names.
</p><!--l. 1672--><p class="noindent" >There is usually a parameter for each method to denote how often, in evolution iterations, this output should be
performed. There is also usually a parameter to define the directory in which the output should be placed,
defaulting to the directory from which the executable is run.
</p><!--l. 1677--><p class="noindent" >See Chapter <a 
href="#x1-167000C2.7">C2.7<!--tex4ht:ref: chap:io_methods --></a> for details on creating your own I/O method.
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
<h1 class="partHead"><span class="titlemark">Part C<br /></span><a 
 id="x1-38000C"></a>Thorn Writing</h1>
<!--l. 20--><p class="noindent" >
                                                                                       
                                                                                       
</p><!--l. 20--><p class="noindent" >C3
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter C1</span><br /><a 
 id="x1-39000C1"></a>Application thorns</h2>
<!--l. 29--><p class="noindent" >This chapter goes into the nitty-gritty of writing a thorn. It introduces key concepts for thorns, then goes
on to give a brief outline of how to configure a thorn. There is then some detail about concepts
introduced by the configuration step, followed by discussion of code which you must put into your
files in order to use Cactus functionality, and details of utility functions you may use to gain extra
functionality.
</p>
<h3 class="sectionHead"><span class="titlemark">C1.1   </span> <a 
 id="x1-40000C1.1"></a>Thorn Concepts</h3>
<!--l. 45--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.1.1   </span> <a 
 id="x1-41000C1.1.1"></a>Thorns</h4>
<!--l. 47--><p class="noindent" >A thorn is the basic working module within Cactus. All user supplied code goes into thorns, which are, by and
large, independent of each other. Thorns communicate with each other via calls to the flesh API, plus, more
rarely, custom APIs of other thorns.
</p><!--l. 52--><p class="noindent" >The connection from a thorn to the flesh, or to other thorns, is specified in configuration files which are parsed
at compile time and used to generate glue code which encapsulates the external appearance of a
thorn.
</p><!--l. 56--><p class="noindent" >Thorn names must be (case independently) unique, must start with a letter, can only contain letters, numbers or
underscores, and must contain 27 characters or less. In addition, a thorn cannot have the name <span 
class="cmtt-10">doc</span>, this is
reserved for arrangement documentation. Arrangement names which start with a ‘<span 
class="cmtt-10">#</span>’, or finish with ‘<span 
class="cmtt-10">~</span>’ or ‘<span 
class="cmtt-10">.bak</span>’
will be ignored.
</p><!--l. 66--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.1.2   </span> <a 
 id="x1-42000C1.1.2"></a>Arrangements</h4>
<!--l. 69--><p class="noindent" >Thorns are grouped into <span 
class="cmti-10">arrangements</span>. This is a logical grouping of thorns which is purely for organisational
purposes. For example, you might wish to keep all your initial data thorns in one arrangement, and all your
evolution thorns in another arrangement, or you may want to have separate arrangements for your
developments, private and shared thorns.
</p><!--l. 76--><p class="noindent" >The arrangements live in the <span 
class="cmtt-10">arrangements </span>directory of the main Cactus directory. Arrangement
names must be (case independently) unique, must start with a letter, and can only contain letters,
numbers or underscores. Arrangement names which start with a ‘<span 
class="cmtt-10">#</span>’, or finish with ‘<span 
class="cmtt-10">~</span>’ or ‘<span 
class="cmtt-10">.bak</span>’ will be
ignored.
                                                                                       
                                                                                       
</p><!--l. 84--><p class="noindent" >Inside an arrangement directory there are directories for each thorn belonging to the arrangement.
</p><!--l. 89--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.1.3   </span> <a 
 id="x1-43000C1.1.3"></a>Implementations</h4>
<!--l. 93--><p class="noindent" >One of the key concepts for thorns is the concept of the <span 
class="cmti-10">implementation</span>. Relationships among thorns are all
based upon relationships among the implementations they provide. In principle, it should be possible to swap
one thorn providing an implementation with another thorn providing that implementation, without affecting any
other thorn.
</p><!--l. 100--><p class="noindent" >An implementation defines a group of variables and parameters which are used to implement some functionality.
For example, the thorn <span 
class="cmtt-10">CactusPUGH/PUGH </span>provides the implementation <span 
class="cmtt-10">driver</span>. This implementation is
responsible for providing memory for grid variables and for communication. Another thorn can
also implement <span 
class="cmtt-10">driver</span>, and both thorns can be compiled in <span 
class="cmti-10">at the same time</span>. At runtime, the
user can decide which thorn providing <span 
class="cmtt-10">driver </span>is used. No other thorn should be affected by this
choice.
</p><!--l. 109--><p class="noindent" >When a thorn decides it needs access to a variable or a parameter provided by another thorn, it defines a
relationship between itself and the other thorn’s <span 
class="cmti-10">implementation</span>, not explicitly with the other <span 
class="cmti-10">thorn</span>. This allows
the transparent replacement, at compile or runtime, of one thorn with another thorn providing the same
functionality as seen by the other thorns.
</p><!--l. 119--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.2   </span> <a 
 id="x1-44000C1.2"></a>Anatomy of a Thorn</h3>
<!--l. 124--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.2.1   </span> <a 
 id="x1-45000C1.2.1"></a>Thorns</h4>
<!--l. 126--><p class="noindent" >A thorn consists of a subdirectory of an arrangement containing four administrative files:
</p><!--l. 129--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">interface.ccl</span>     </dt><dd 
class="list">
                  <!--l. 130--><p class="noindent" >the Cactus interface, which defines the grid functions, variables, etc. See Appendix
                  <a 
href="#x1-180000D2.2">D2.2<!--tex4ht:ref: sec:Appendix.interface --></a>.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">param.ccl</span>         </dt><dd 
class="list">
                  <!--l. 132--><p class="noindent" >the parameters introduced by this thorn, and the parameters needed from other
                  thorns. See Appendix <a 
href="#x1-185000D2.3">D2.3<!--tex4ht:ref: sec:Appendix.param --></a>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">schedule.ccl</span>      </dt><dd 
class="list">
                  <!--l. 135--><p class="noindent" >scheduling information for routines called by the flesh. See Appendix <a 
href="#x1-188000D2.4">D2.4<!--tex4ht:ref: sec:Appendix.schedule --></a>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">configuration.ccl</span> </dt><dd 
class="list">
                  <!--l. 137--><p class="noindent" >configuration options for the thorn. See Appendix <a 
href="#x1-193000D2.5">D2.5<!--tex4ht:ref: sec:Appendix.configuration.ccl --></a>.</p></dd></dl>
<!--l. 141--><p class="noindent" >Thorns can also contain </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 143--><p class="noindent" >a subdirectory called <span 
class="cmtt-10">src</span>, which should hold source files and compilation instructions for the thorn
     </p></li>
     <li class="itemize">
     <!--l. 145--><p class="noindent" >a subdirectory <span 
class="cmtt-10">src/include </span>for include files
     </p></li>
     <li class="itemize">
     <!--l. 146--><p class="noindent" >a <span 
class="cmtt-10">README </span>containing a brief description of the thorn
     </p></li>
     <li class="itemize">
     <!--l. 147--><p class="noindent" >a <span 
class="cmtt-10">doc </span>directory for documentation
     </p></li>
     <li class="itemize">
     <!--l. 148--><p class="noindent" >a <span 
class="cmtt-10">par </span>directory for example parameter files
     </p></li>
     <li class="itemize">
     <!--l. 149--><p class="noindent" >a <span 
class="cmtt-10">test </span>subdirectory may also be added, to hold the thorn’s test suite. See Section <a 
href="#x1-118000C1.8.5">C1.8.5<!--tex4ht:ref: sec:adding_test_suite --></a> for details.</p></li></ul>
<!--l. 155--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.2.2   </span> <a 
 id="x1-46000C1.2.2"></a>Creating a Thorn</h4>
<!--l. 158--><p class="noindent" >To simplify the creation of a thorn, a <span 
class="cmtt-10">make </span>target <span 
class="cmtt-10">gmake newthorn </span>has been provided. When this is
run:
</p><!--l. 161--><p class="noindent" >
                                                                                       
                                                                                       
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-46002x1">
     <!--l. 162--><p class="noindent" > You will be prompted for the name of the new thorn.
     </p></li>
<li 
  class="enumerate" id="x1-46004x2">
     <!--l. 163--><p class="noindent" > You will be prompted for the name of the arrangement in which you would like to include your
     thorn. Either enter a new arrangement name or pick one from the list of available arrangements
     that are shown.</p></li></ol>
<!--l. 170--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.2.3   </span> <a 
 id="x1-47000C1.2.3"></a>Configuring your Thorn</h4>
<!--l. 172--><p class="noindent" >The interaction of a thorn with the flesh and other thorns is controlled by certain configuration
files.
</p><!--l. 175--><p class="noindent" >These are:
</p><!--l. 177--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">interface.ccl</span>     </dt><dd 
class="list">
                  <!--l. 179--><p class="noindent" >This  defines  the  <span 
class="cmti-10">implementation  </span>(Section <a 
href="#x1-43000C1.1.3">C1.1.3<!--tex4ht:ref: sec:implementations --></a>)  the  thorn  provides,  and  the
                  variables the thorn needs, along with their visibility to other implementations.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">param.ccl</span>         </dt><dd 
class="list">
                  <!--l. 184--><p class="noindent" >This defines the parameters that are used to control the thorn, along with their
                  visibility to other implementations.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">schedule.ccl</span>      </dt><dd 
class="list">
                  <!--l. 188--><p class="noindent" >This defines which functions are called from the thorn and when they are called. It
                  also handles memory and communication assignment for grid variables.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">configuration.ccl</span> </dt><dd 
class="list">
                  <!--l. 192--><p class="noindent" >This file is optional for a thorn. If it exists, it contains extra configuration options
                  of this thorn.
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<!--l. 198--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-48000"></a>General Syntax of CCL Files</h5>
<!--l. 200--><p class="noindent" ><span 
class="cmti-10">Cactus Configuration Language </span>(CCL) files are text files used to define configuration information for a thorn.
Their formal syntax is described using Piraha, a parsing expression grammar engine that supports multiple
languages (see https://github.com/stevenrbrandt/piraha-peg for a description of Piraha patterns and Grammar
Files).
</p><!--l. 206--><p class="noindent" >A Grammar File for each type of CCL file is provided in the src/piraha/pegs directory of the Cactus source tree.
These may be consulted for the precise details of any given Cactus CCL file.
</p><!--l. 210--><p class="noindent" >CCL files are (mostly) case independent, and may contain comments introduced by the hash ‘<span 
class="cmtt-10">#</span>’
character, which indicates that the rest of the line is a comment. If the last non-blank character of a
line in a CCL file is a backslash ‘\(\backslash \)’, the following line is treated as a continuation of the current
line.
</p><!--l. 217--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-49000"></a>The <span 
class="cmtt-10">interface.ccl </span>File</h5>
<a 
 id="x1-49000doc"></a>
<!--l. 220--><p class="noindent" >The <span 
class="cmtt-10">interface.ccl </span>file is used to declare
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 223--><p class="noindent" >the implementation provided by the thorn
     </p></li>
     <li class="itemize">
     <!--l. 224--><p class="noindent" >the variables provided by the thorn
     </p></li>
     <li class="itemize">
     <!--l. 225--><p class="noindent" >the include files provided by the thorn
     </p></li>
     <li class="itemize">
     <!--l. 226--><p class="noindent" >the functions provided by the thorn (in development)</p></li></ul>
<!--l. 230--><p class="noindent" >The implementation is declared by a single line at the top of the file </p><div class="alltt">
                                                                                       
                                                                                       
<div class="obeylines-v">
<br /><span 
class="cmtt-10">implements:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> Where <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E; </span>can be any combination of alphanumeric characters and underscores, and is case
independent.
<!--l. 237--><p class="noindent" >There are three different access levels available for variables
</p><!--l. 239--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">Public</span>            </dt><dd 
class="list">
                  <!--l. 240--><p class="noindent" >Can be ‘inherited’ by other implementations (see below).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Protected</span>         </dt><dd 
class="list">
                  <!--l. 242--><p class="noindent" >Can be shared with other implementations which declare themselves to be friends
                  of this one (see below).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Private</span>           </dt><dd 
class="list">
                  <!--l. 245--><p class="noindent" >Can only be seen by this thorn.</p></dd></dl>
<!--l. 249--><p class="noindent" >Corresponding to the first two access levels there are two relationship statements that can be used to get
variables (actually groups of variables, see below) from other implementations.
</p><!--l. 253--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">Inherits: &#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>  </dt><dd 
class="list">
                  <!--l. 254--><p class="noindent" >This gets all <span 
class="cmtt-10">Public </span>variables from implementation <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>, and all variables that
                  <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E; </span>has in turn inherited. An implementation may inherit from any number of
                  other implementations.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Friend: &#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>    </dt><dd 
class="list">
                  <!--l. 258--><p class="noindent" >This  gets  all  <span 
class="cmtt-10">Protected </span>variables  from  implementation  <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>,  but,  unlike
                  <span 
class="cmtt-10">inherits</span>, it is symmetric and also defines a transitive relation by pushing its own
                  implementation’s <span 
class="cmtt-10">Protected </span>variables onto implementation <span 
class="cmsltt-10">name</span>. This keyword is
                  used to define a group of implementations which all end up with the same <span 
class="cmtt-10">Protected</span>
                  variables.</p></dd></dl>
<!--l. 266--><p class="noindent" >So, for example, an <span 
class="cmtt-10">interface.ccl </span>starting </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">implements:</span><span 
class="cmtt-10"> wavetoy</span>
<br /><span 
class="cmtt-10">inherits:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> grid</span>
<br /><span 
class="cmtt-10">friend:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> wave_extract</span>
                                                                                       
                                                                                       
</div>
</div> declares that the thorn provides an implementation called <span 
class="cmtt-10">wavetoy</span>, gets all the <span 
class="cmtt-10">public </span>variables declared by
an implementation called <span 
class="cmtt-10">grid</span>, and shares all <span 
class="cmtt-10">protected </span>variables with <span 
class="cmtt-10">wave</span><span 
class="cmtt-10">_extract </span>and its
friends.
<!--l. 277--><p class="noindent" >Cactus variables, described in Chapter <a 
href="#x1-59000C1.3">C1.3<!--tex4ht:ref: chap:cactus_variables --></a>, are placed in groups with homogeneous attributes, where the
attributes describe properties such as the data type, group type, dimension, ghostsize, number of timelevels, and
distribution.
</p><!--l. 283--><p class="noindent" >For example, a group, called <span 
class="cmtt-10">realfields </span>of 5 real grid functions (<span 
class="cmtt-10">phi</span>, <span 
class="cmtt-10">a</span>, <span 
class="cmtt-10">b</span>, <span 
class="cmtt-10">c</span>, <span 
class="cmtt-10">d</span>), on a 3D grid, would be defined
by
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-13">
CCTK_REAL realfields type=GF TimeLevels=3 Dim=3
{
  phi
  a,b,c,d
} &#x0022;Example grid functions&#x0022;
</pre>
<!--l. 292--><p class="nopar" >or, for a group called <span 
class="cmtt-10">intfields </span>consisting of just one distributed 2D array of integers,
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-14">
CCTK_INT intfields type=ARRAY size=xsize,ysize ghostsize=gxsize,gysize dim=2
{
 anarray
} &#x0022;My 2D arrays&#x0022;
</pre>
<!--l. 300--><p class="nopar" >where <span 
class="cmtt-10">xsize</span>, <span 
class="cmtt-10">ysize</span>, <span 
class="cmtt-10">gxsize</span>, <span 
class="cmtt-10">gysize </span>are all parameters defined in the thorn’s <span 
class="cmtt-10">param.ccl</span>.
</p><!--l. 305--><p class="noindent" >By default, all groups are <span 
class="cmtt-10">private</span>, to change this, an access specification of the form <span 
class="cmtt-10">public: </span>or <span 
class="cmtt-10">protected:</span>
(or <span 
class="cmtt-10">private: </span>to change it back) may be placed on a line by itself. This changes the access level for any group
defined in the file from that point on.
</p><!--l. 310--><p class="noindent" >All variables seen by any one thorn must have distinct names.
</p><!--l. 312--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-50000"></a>The <span 
class="cmtt-10">param.ccl </span>File</h5>
<a 
 id="x1-50000doc"></a>
<!--l. 315--><p class="noindent" >Users control the operation of thorns via parameters given in a file at runtime. The <span 
class="cmtt-10">param.ccl </span>file is used to
specify the parameters used to control an individual thorn, and to specify the values these parameters are
allowed to take. When the code is run, it reads a parameter file and sets the parameters if they fall
within the allowed values. If a parameter is not assigned in a parameter file, it is given its default
value.
</p><!--l. 323--><p class="noindent" >There are three access levels available for parameters:
</p><!--l. 325--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">Global</span>            </dt><dd 
class="list">
                  <!--l. 326--><p class="noindent" >These parameters are seen by all thorns.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Restricted</span>        </dt><dd 
class="list">
                  <!--l. 328--><p class="noindent" >These parameters may be used by other implementations if they so desire.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Private</span>           </dt><dd 
class="list">
                  <!--l. 330--><p class="noindent" >These are only seen by this thorn.</p></dd></dl>
<!--l. 334--><p class="noindent" >A parameter specification consists of: </p>
                                                                                       
                                                                                       
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 337--><p class="noindent" >The parameter type (each may have an optional <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_</span></span> in front)
                       </p><dl class="list2"><dt class="list">
     <span 
class="cmtt-10">REAL</span>              </dt><dd 
class="list">
                       <!--l. 339--><p class="noindent" >
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">INT</span>               </dt><dd 
class="list">
                       <!--l. 340--><p class="noindent" >
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">KEYWORD</span>           </dt><dd 
class="list">
                       <!--l. 341--><p class="noindent" >A distinct string with only a few known allowed values.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">STRING</span>            </dt><dd 
class="list">
                       <!--l. 343--><p class="noindent" >An arbitrary string, which must conform to a given regular expression.
                       </p></dd><dt class="list">
     <span 
class="cmtt-10">BOOLEAN</span>           </dt><dd 
class="list">
                       <!--l. 345--><p class="noindent" >A boolean type which can take values <span class="obeylines-h"><span 
class="cmtt-10">1</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">t</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">true</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">yes</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">0</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">f</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">false</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">no</span></span>.</p></dd></dl>
     </li>
     <li class="itemize">
     <!--l. 350--><p class="noindent" >The parameter name
     </p></li>
     <li class="itemize">
     <!--l. 352--><p class="noindent" >An optional size (in square brackets)–if this is present, the parameter is a “parameter array”, i.e. it will
     actually be an array of parameters, each of which has the same properties, but a different value. Such
     arrays appear as normal arrays in C or Fortran, 0-based in C, and 1-based in Fortran. In the parameter file
     the value of each element is specified with square brackets and is 0-based. The size must be an
     integer.
     </p></li>
     <li class="itemize">
     <!--l. 360--><p class="noindent" >A description of the parameter
     </p></li>
     <li class="itemize">
     <!--l. 362--><p class="noindent" >An allowed value block–this consists of a brace-delimited block of
     lines<span class="footnote-mark"><a 
href="UsersGuide4.html#fn1x9"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-50001f1"></a> 
     describing the allowed values of the parameter. Each range may have a description associated with it by
     placing a <span 
class="cmtt-10">:: </span>on the line, and putting the description afterwards.
     </p></li>
     <li class="itemize">
     <!--l. 369--><p class="noindent" >The default value–this must be one of the allowed values.
</p>
     </li></ul>
                                                                                       
                                                                                       
<!--l. 373--><p class="noindent" >For the numeric types <span 
class="cmtt-10">INT </span>and <span 
class="cmtt-10">REAL</span>, a range consists of a string of the form lower-bound:upper-bound:step,
where a missing number or an asterisk ‘<span 
class="cmtt-10">*</span>’ denotes anything (i.e. infinite bounds or an infinitesimal
step).
</p><!--l. 378--><p class="noindent" >For example,
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-15">
REAL Coeff &#x0022;Important coefficient&#x0022;
{
0:3.14 :: &#x0022;Range has to be from zero to Pi, default is zero&#x0022;
} 0.0

#No need to define a range for BOOLEAN
BOOLEAN nice &#x0022;Nice weather?&#x0022;
{
}&#x0022;yes&#x0022;

# A example for a set of keywords and its default (which has to be
# defined in the body)
KEYWORD confused &#x0022;Are we getting confused?&#x0022;
{
  &#x0022;yes&#x0022;    :: &#x0022;absolutely positively&#x0022;
  &#x0022;perhaps&#x0022; :: &#x0022;we are not sure&#x0022;
  &#x0022;never&#x0022;   :: &#x0022;never&#x0022;
} &#x0022;never&#x0022;

REAL Length[2] &#x0022;Length in each direction&#x0022;
{
0:* :: &#x0022;Range has to be from zero to infinity, default is one&#x0022;
} 1.0

</pre>
<!--l. 404--><p class="nopar" >defines a <span 
class="cmtt-10">REAL </span>parameter, a <span 
class="cmtt-10">BOOLEAN </span>parameter, a <span 
class="cmtt-10">KEYWORD</span>, and an array of <span 
class="cmtt-10">REAL </span>parameters.
</p><!--l. 408--><p class="noindent" >By default, all parameters are <span 
class="cmtt-10">private</span>; to change this, an access specification of the form <span 
class="cmtt-10">global: </span>or
<span 
class="cmtt-10">restricted: </span>(or <span 
class="cmtt-10">private: </span>to change it back) may be placed on a line by itself. This changes the access level for
any parameter defined in the file from that point on.
</p><!--l. 413--><p class="noindent" >To access <span 
class="cmtt-10">restricted </span>parameters from another implementation, a line containing <span 
class="cmtt-10">shares: &#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>
declares that all parameters mentioned in the file, from now until the next access specification,
originate in implementation <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span>. (Note that only one implementation can be specified on each
<span 
class="cmtt-10">shares: </span>line.) Each of these parameters must be qualified by the initial token <span 
class="cmtt-10">USES </span>or <span 
class="cmtt-10">EXTENDS</span>,
where
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">USES</span>              </dt><dd 
class="list">
                  <!--l. 419--><p class="noindent" >indicates that the parameters range remains unchanged.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">EXTENDS</span>           </dt><dd 
class="list">
                  <!--l. 420--><p class="noindent" >indicates that the parameters range is going to be extended.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 423--><p class="noindent" >In contrast to parameter declarations in other access blocks, the default value must be omitted—it is impossible
to set the default value of any parameter not originating in this thorn. For example, the following block adds
possible values to the keyword <span 
class="cmtt-10">initial</span><span 
class="cmtt-10">_data </span>originally defined in the implementation <span 
class="cmtt-10">einstein</span>, and uses the
<span 
class="cmtt-10">REAL </span>parameter <span 
class="cmtt-10">speed</span>.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-16">
shares:einstein

EXTENDS KEYWORD initial_data
{
  &#x0022;bl_bh&#x0022;         :: &#x0022;Brill Lindquist black holes&#x0022;
  &#x0022;misner_bh&#x0022;     :: &#x0022;Misner black holes&#x0022;
  &#x0022;schwarzschild&#x0022; :: &#x0022;One Schwarzschild black hole&#x0022;
}

USES CCTK_REAL speed

</pre>
<!--l. 442--><p class="nopar" >
</p><!--l. 444--><p class="noindent" >Note that you must compile at least one thorn which implements <span 
class="cmtt-10">einstein</span>.
</p><!--l. 450--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-51000"></a>The <span 
class="cmtt-10">schedule.ccl </span>File</h5>
<a 
 id="x1-51000doc"></a>
<!--l. 452--><p class="noindent" >By default, no routine of a thorn will be run. The <span 
class="cmtt-10">schedule.ccl </span>file defines those that should be run, and when
and under which conditions they should be run.
</p><!--l. 456--><p class="noindent" >The specification of routine scheduling is via a schedule block which consists of lines of the form
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">schedule</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">time</span><span 
class="cmsltt-10"> bin</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">other</span><span 
class="cmsltt-10"> options</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> LANG:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;FORTRAN|C&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> OPTIONS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">list</span><span 
class="cmsltt-10"> of</span><span 
class="cmsltt-10"> options</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> TAGS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">list</span><span 
class="cmsltt-10"> of</span><span 
class="cmsltt-10"> keyword=value</span><span 
class="cmsltt-10"> definitions</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> STORAGE:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10"> list</span><span 
class="cmsltt-10"> with</span><span 
class="cmsltt-10"> timelevels</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> READS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">variable</span><span 
class="cmsltt-10"> or</span><span 
class="cmsltt-10"> group</span><span 
class="cmsltt-10"> list</span><span 
class="cmsltt-10"> with</span><span 
class="cmsltt-10"> region</span><span 
class="cmsltt-10"> specification</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> WRITES:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">variable</span><span 
class="cmsltt-10"> or</span><span 
class="cmsltt-10"> group</span><span 
class="cmsltt-10"> list</span><span 
class="cmsltt-10"> with</span><span 
class="cmsltt-10"> region</span><span 
class="cmsltt-10"> specification</span><span 
class="cmtt-10">]</span>
                                                                                       
                                                                                       
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> TRIGGERS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10"> list</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> SYNC:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10"> list</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> &#x0022;</span><span 
class="cmsltt-10">A</span><span 
class="cmsltt-10"> description</span><span 
class="cmtt-10">&#x0022;</span>
</div>
</div> where <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">name</span><span 
class="cmtt-10">&#x003E; </span>is the name of the routine, and <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">time bin</span><span 
class="cmtt-10">&#x003E; </span>is the name of a schedule bin (the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ </span>prefix is
optional). A list of the most useful schedule bins for application thorns is given here, a complete and more
descriptive list is provided in Appendix <a 
href="#x1-207000D4">D4<!--tex4ht:ref: sec:Appendix.schedule_bins --></a>:
<!--l. 478--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span>      </dt><dd 
class="list">
                  <!--l. 480--><p class="noindent" >For  routines,  run  before  the  grid  hierarchy  is  set  up,  for  example,  function
                  registration.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PARAMCHECK</span>   </dt><dd 
class="list">
                  <!--l. 484--><p class="noindent" >For routines that check parameter combinations, routines registered here only have
                  access to the grid size and the parameters.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_BASEGRID</span>     </dt><dd 
class="list">
                  <!--l. 488--><p class="noindent" >Responsible for setting up coordinates, etc.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INITIAL</span>      </dt><dd 
class="list">
                  <!--l. 491--><p class="noindent" >For generating initial data.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTINITIAL</span>  </dt><dd 
class="list">
                  <!--l. 494--><p class="noindent" >Tasks which must be applied after initial data is created.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PRESTEP</span>      </dt><dd 
class="list">
                  <!--l. 497--><p class="noindent" >Stuff done before the evolution step.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EVOL</span>         </dt><dd 
class="list">
                  <!--l. 500--><p class="noindent" >The evolution step.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTSTEP</span>     </dt><dd 
class="list">
                  <!--l. 503--><p class="noindent" >Stuff done after the evolution step.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS</span>     </dt><dd 
class="list">
                  <!--l. 506--><p class="noindent" >For analysing data.
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<!--l. 511--><p class="noindent" >The <span 
class="cmsltt-10">other options </span>allow finer-grained control of the scheduling. It is possible to state that the routine must
run <span 
class="cmtt-10">BEFORE </span>or <span 
class="cmtt-10">AFTER </span>another routine or set of routines. It is also possible to schedule the routine under an alias
name by using <span 
class="cmtt-10">AS &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmsltt-10">_name</span><span 
class="cmtt-10">&#x003E;</span>.
</p><!--l. 517--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">LANG</span>              </dt><dd 
class="list">
                  <!--l. 519--><p class="noindent" >The <span 
class="cmtt-10">LANG </span>keyword specifies the linkage of the scheduled routine which determines
                  how to call it from the scheduler. C and Fortran linkage are possible here. C++
                  routines should be defined as <span 
class="cmtt-10">extern &#x0022;C&#x0022; </span>and registered as <span 
class="cmtt-10">LANG: C</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">OPTIONS</span>           </dt><dd 
class="list">
                  <!--l. 525--><p class="noindent" >Schedule options are used for mesh refinement and multi-block simulations, and they
                  determine “where” a routine executes. Often used schedule options are <span 
class="cmtt-10">local </span>(also
                  the default, may be omitted), <span 
class="cmtt-10">level</span>, or <span 
class="cmtt-10">global</span>. Routines scheduled in <span 
class="cmti-10">local mode</span>
                  can access individual grid points, routines scheduled in <span 
class="cmti-10">level mode </span>are used e.g. to
                  select boundary conditions, and routines schedule in <span 
class="cmti-10">global mode </span>are e.g. used to
                  calculate reductions (norms).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">TAGS</span>              </dt><dd 
class="list">
                  <!--l. 534--><p class="noindent" >Schedule tags, e.g. <span 
class="cmtt-10">Device=1 </span>to specify that a routine executes on an OpenCL or
                  CUDA device instead of on the host.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">STORAGE</span>           </dt><dd 
class="list">
                  <!--l. 538--><p class="noindent" >The <span 
class="cmtt-10">STORAGE </span>keyword specifies any groups for which memory should be allocated
                  for the duration of the routine. The storage status reverts to its previous status
                  after the routine returns. The format of the <span 
class="cmtt-10">STORAGE </span>statement includes specifying
                  the number of timelevels of each group for which storage should be activated.
                  </p><!--l. 545--><p class="noindent" ><span 
class="cmtt-10">STORAGE: &#x003C;</span><span 
class="cmsltt-10">group1</span><span 
class="cmtt-10">&#x003E;[</span><span 
class="cmsltt-10">timelevels1</span><span 
class="cmtt-10">], &#x003C;</span><span 
class="cmsltt-10">group2</span><span 
class="cmtt-10">&#x003E;[</span><span 
class="cmsltt-10">timelevels2</span><span 
class="cmtt-10">]</span>
                  </p><!--l. 547--><p class="noindent" >This number can range from one to the maximum number of timelevels for the
                  group, as specified in the group definition in its <span 
class="cmtt-10">interface.ccl </span>file. If this maximum
                  number  is  one,  the  timelevel  specification  can  be  omitted  from  the  <span 
class="cmtt-10">STORAGE</span>
                  statement. Alternatively <span 
class="cmsltt-10">timelevels </span>can be the name of a parameter accessible
                  to the thorn. The parameter name is the same as used in C routines of the thorn,
                  fully qualified parameter names of the form <span 
class="cmsltt-10">thorn</span><span 
class="cmtt-10">::</span><span 
class="cmsltt-10">parameter </span>are not allowed. In
                  this case 0 (zero) <span 
class="cmsltt-10">timelevels </span>can be requested, which is equivalent to the <span 
class="cmtt-10">STORAGE</span>
                  statement being absent.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">READS/WRITES</span>      </dt><dd 
class="list">
                  <!--l. 556--><p class="noindent" ><span 
class="cmtt-10">READS/WRITES </span>are used to declare which grid variables are read/written by the
                  routine. This information is used e.g. to determine which variables need to be
                  synchronized, copied between host and device for OpenCL or CUDA kernel, or
                  poisoned as part of error checking.
                  </p><!--l. 561--><p class="noindent" >READS/WRITE  directives  can  be  applied  to  either  a  variable  or  a  group  of
                  variables and may also contain a region specification. The region specification can
                  be EVERYWHERE, INTERIOR, or BOUNDARY. If a function needs to read a
                                                                                       
                                                                                       
                  given grid function everywhere and only the interior is valid (i.e. has been written
                  to), then a synchronization is required and will happen automatically if enabled
                  with the Cactus parameter <span 
class="cmtt-10">presync</span><span 
class="cmtt-10">_mode</span>.
                  </p><!--l. 567--><p class="noindent" >When  grid  functions  are  updated  in  this  way,  not  only  ghost  zones,  but
                  boundary   zones   will   be   updated   by   the   drier.   Use   either   the   function
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SelectGroupForBC </span>or <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SelectVarForBC </span>to tell the driver how it
                  should update a group or variable. The arguments to both functions are the same
                  as those found in the Boundary thorn, but with the prefix <span 
class="cmtt-10">Boundary</span><span 
class="cmtt-10">_ </span>instead of
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_</span>:
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-17">
                  Driver_SelectGroupForBC(CCTK_ARGUMENTS,
                                          CCTK_INT faces,
                                          CCTK_INT width,
                                          CCTK_INT table_handle,
                                          CCTK_STRING group_name,
                                          CCTK_STRING bc_name)
                  
                  Driver_SelectVarForBC(CCTK_ARGUMENTS,
                                        CCTK_INT faces,
                                        CCTK_INT width,
                                        CCTK_INT table_handle,
                                        CCTK_STRING var_name,
                                        CCTK_STRING bc_name)
</pre>
                  <!--l. 588--><p class="nopar" >
                  </p><!--l. 590--><p class="noindent" >Note that the above two functions, unlike their similarly named components in the
                  Boundary thorn, only need to be called once. The information they provide will
                  then be used each time the driver synchronizes the named grid function or
                  group.
                  </p><!--l. 592--><p class="noindent" >It is possible, however, that the thorn you are creating does not know the correct
                  READS/WRITES information at compile time. I/O thorns, for example, do not know
                  which grid functions they will access until run time. Likewise, the Method of
                  Lines thorn does not know which grid functions it is operating on until run
                  time.
                  </p><!--l. 595--><p class="noindent" >For situations like these, we have the following functions which can be used
                  to check READS/WRITES data and perform synchronization at run time:
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_RequireValidData</span>, <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_NotifyDataModified</span>, <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_GetValidRegion</span>, and
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SetValidRegion</span>. For details on these functions, please consult the Reference
                  Manual.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">TRIGGERS</span>          </dt><dd 
class="list">
                  <!--l. 598--><p class="noindent" ><span 
class="cmtt-10">TRIGGERS </span>is used when the routine is registered at <span 
class="cmtt-10">ANALYSIS</span>. This is a special time bin; a
                  routine registered here will only be called if one of the variables from a group in <span 
class="cmtt-10">TRIGGERS</span>
                  is due for output. (A routine without <span 
class="cmtt-10">TRIGGERS </span>declaration will always be
                  called.)
                  </p></dd><dt class="list">
<span 
class="cmtt-10">SYNC</span>              </dt><dd 
class="list">
                  <!--l. 604--><p class="noindent" >The keyword <span 
class="cmtt-10">SYNC </span>specifies groups of variables which should be synchronised (that is, their
                  ghostzones should be exchanged between processors) on exit from the routine. Specifying
                  synchronisation of grid variables in <span 
class="cmtt-10">schedule.ccl </span>is an alternative to calling the functions
                  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroup() </span>or <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroupsI() </span>(see the Reference Manual) from inside a
                  routine. Using the <span 
class="cmtt-10">SYNC </span>keyword in the <span 
class="cmtt-10">schedule.ccl </span>is the preferred method,
                  since it provides the flesh with more information about the behaviour of your
                  code.
                                                                                       
                                                                                       
                  </p><!--l. 614--><p class="noindent" >As an alternative to this mechanism, synchornization can happen automatically as
                  variables are read/written.
</p>
                  </dd></dl>
<!--l. 620--><p class="noindent" >Besides schedule blocks, it’s possible to embed C style <span 
class="cmtt-10">if/else </span>statements in the <span 
class="cmtt-10">schedule.ccl </span>file. These can
be used to schedule things based upon the value of a parameter.
</p><!--l. 625--><p class="noindent" ><span 
class="cmbx-10">Example I:</span>
</p><!--l. 627--><p class="noindent" >If the parameter <span 
class="cmtt-10">evolve</span><span 
class="cmtt-10">_hydro </span>is positively set, the Fortran routine <span 
class="cmtt-10">hydro</span><span 
class="cmtt-10">_predictor </span>is scheduled to run in the
<span 
class="cmti-10">evolution </span>loop, after the routine <span 
class="cmtt-10">metric</span><span 
class="cmtt-10">_predictor </span>and before <span 
class="cmtt-10">metric</span><span 
class="cmtt-10">_corrector</span>. The routine names
<span 
class="cmtt-10">metric</span><span 
class="cmtt-10">_predictor </span>and <span 
class="cmtt-10">metric</span><span 
class="cmtt-10">_corrector</span>, may either be real routine names from the same or a different
thorn, or they may be <span 
class="cmtt-10">aliased </span>routine names (see the next example).
</p><!--l. 635--><p class="noindent" >Before entry to <span 
class="cmtt-10">hydro</span><span 
class="cmtt-10">_predictor</span>, storage will be allocated for one timelevel for the group of grid variables
<span 
class="cmtt-10">hydro</span><span 
class="cmtt-10">_variables </span>on exit from the routine this storage will be deallocated and the contents of the variables will
be lost.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-18">
if(CCTK_Equals(evolve_hydro,&#x0022;yes&#x0022;))
{
  SCHEDULE hydro_predictor AT evol AFTER metric_predictor BEFORE metric_corrector
  {
    LANG:     FORTRAN
    STORAGE:  hydro_variables[1]
  } &#x0022;Do a predictor step on the hydro variables&#x0022;
}
</pre>
<!--l. 648--><p class="nopar" >
</p><!--l. 650--><p class="noindent" >If the parameter <span 
class="cmtt-10">evolve</span><span 
class="cmtt-10">_hydro </span>is set negatively, the <span 
class="cmtt-10">hydro</span><span 
class="cmtt-10">_predictor </span>routine will not be called by the
scheduler. Note that if the <span 
class="cmtt-10">evolve</span><span 
class="cmtt-10">_hydro </span>parameter is <span 
class="cmtt-10">STEERABLE</span>, it can be dynamically scheduled and
de-scheduled during a run if a steering interface is available.
</p><!--l. 657--><p class="noindent" ><span 
class="cmbx-10">Example II:</span>
</p><!--l. 659--><p class="noindent" >The thorns <span 
class="cmtt-10">WaveToy77 </span>and <span 
class="cmtt-10">WaveToyC</span>, each provide a routine to evolve the 3D wave equation:
<span 
class="cmtt-10">WaveToyF77</span><span 
class="cmtt-10">_Evolution </span>and <span 
class="cmtt-10">WaveToyC</span><span 
class="cmtt-10">_Evolution</span>. The routine names have to be different, so that both thorns
can be compiled at the same time, their functionality is identical though. Either one of them can then be
activated at run time in the parameter file via <span 
class="cmtt-10">ActiveThorns</span>.
</p><!--l. 666--><p class="noindent" >Since each evolution routine provides the same functionality, it makes sense to schedule them under the common
alias <span 
class="cmtt-10">WaveToy</span><span 
class="cmtt-10">_Evolution </span>to allow relative scheduling (<span 
class="cmtt-10">BEFORE/AFTER</span>) independent of the actual routine name
(which may change depending on the activation in the parameter file).
</p><!--l. 672--><p class="noindent" >In both cases, the group of variables <span 
class="cmtt-10">scalarfield </span>are synchronised across processes when the routine is
exited.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-19">
schedule WaveToyF77_Evolution AS WaveToy_Evolution AT evol
{
  LANG: Fortran
  STORAGE: scalartmps
  SYNC: scalarfield
} &#x0022;Evolution of 3D wave equation&#x0022;

schedule WaveToyC_Evolution AS WaveToy_Evolution AT evol
{
  LANG: C
  STORAGE: scalartmps
  SYNC: scalarfield
} &#x0022;Evolution of 3D wave equation&#x0022;
</pre>
<!--l. 688--><p class="nopar" >The thorn <span 
class="cmtt-10">IDScalarWave </span>schedules the routine <span 
class="cmtt-10">WaveBinary </span>after the alias <span 
class="cmtt-10">WaveToy</span><span 
class="cmtt-10">_Evolution</span>. It is scheduled
independently of the C or Fortran routine name.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-20">
schedule WaveBinary AT evol AFTER WaveToy_Evolution
{
  STORAGE: wavetoy::scalarevolve
  LANG:    Fortran
} &#x0022;Provide binary source during evolution&#x0022;
</pre>
<!--l. 698--><p class="nopar" >
</p>
<!--l. 700--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-52000"></a><span 
class="cmbx-10">Storage Outside of Schedule Blocks</span></span>
The keyword <span 
class="cmtt-10">STORAGE </span>can also be used outside of the schedule blocks to indicate that storage for these groups
should be switched on at the start of the run. Note that the storage is only allocated in this way at the start; a
thorn could explicitly switch the storage off (although this is not recommended practise). As for the <span 
class="cmtt-10">STORAGE</span>
statement in schedule blocks, each group must also specify how many timelevels to activate storage
for.
</p><!--l. 712--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-53000"></a>The <span 
class="cmtt-10">configuration.ccl</span></h5>
<a 
 id="x1-53000doc"></a>
<!--l. 715--><p class="noindent" >The <span 
class="cmtt-10">configuration.ccl </span>file is optional. It can be used for two purposes: to detect certain features of the
host system, such as the presence or absence of libraries, variable types, etc, or the location of
libraries; or to provide access to certain functions too complex or otherwise not suitable for function
aliasing.
</p><!--l. 721--><p class="noindent" >The basic concept here is that a thorn can either provide or use a <span 
class="cmbx-10">capability</span>. A thorn providing a capability
can specify a script which is run by the CST to detect features and write any configuration files; the script may
output lines to its standard output to inform the CST of features to: add to the header files included by thorns
using this capability; add to the make files used to build thorns using this capability; or add to the main Cactus
link line. The script may also indicate that this capability is not present by returning a non-zero exit code—e.g.
if the thorn is providing access to an external library, it should return an error if the library is not installed on
the system.
</p><!--l. 733--><p class="noindent" >A thorn may either require a capability to be present, in which case it is an error if there is no thorn
providing that capability in the configuration’s <span 
class="cmtt-10">ThornList</span>, or it may optionally use a capability,
in which case a macro is defined in the thorn’s header file if a thorn providing the capability is
present.
                                                                                       
                                                                                       
</p><!--l. 739--><p class="noindent" >A configuration.ccl file has the form:
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">PROVIDES</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">My_Capability</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> SCRIPT</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">My_ConfigScript</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> LANG</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">My_Language</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">}</span>
<br />
<br /><span 
class="cmtt-10">REQUIRES</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Another_Capability</span><span 
class="cmtt-10">&#x003E;</span>
<br />
<br /><span 
class="cmtt-10">OPTIONAL</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Yet_Another_Capability</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10">%</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> DEFINE</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">macro</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">}</span>
<br />
</div>
</div>
<!--l. 757--><p class="noindent" >which states that this thorn provides the capability <span class="obeylines-h"><code class="verb">My_Capability</code></span>, and a script <span class="obeylines-h"><code class="verb">MyConfigScript</code></span> should be run
to detect features of this capability; the script is in language <span class="obeylines-h"><code class="verb">My_Language</code></span>—the CST will use the appropriate
environment or interpreter to invoke the script.
</p><!--l. 794--><p class="noindent" >The syntax of the output of the configure script is described in Appendix <a 
href="#x1-194000D2.5.1">D2.5.1<!--tex4ht:ref: sec:Appendix.configuration.ccl.configscript --></a>.
</p><!--l. 801--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.2.4   </span> <a 
 id="x1-54000C1.2.4"></a>Naming Conventions for Source Files</h4>
<!--l. 804--><p class="noindent" >The make system uses file extensions to designate coding language, as well as other properties of the code in the
file.
</p><!--l. 807--><p class="noindent" >The following extensions are understood:
</p>
<div class="center" 
>
<!--l. 809--><p class="noindent" >
</p>
                                                                                       
                                                                                       
<div class="tabular"> <table id="TBL-4" class="tabular" 
 
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1" /></colgroup><colgroup id="TBL-4-2g"><col 
id="TBL-4-2" /></colgroup><colgroup id="TBL-4-3g"><col 
id="TBL-4-3" /></colgroup><colgroup id="TBL-4-4g"><col 
id="TBL-4-4" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-1-1"  
class="td11"> Extension  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-2"  
class="td11">      Language          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-3"  
class="td11"> Preprocess  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-2-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.c</span></span>        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-2"  
class="td11">          C               </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-3"  
class="td11">    yes       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-3-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.cc</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">.C</span></span>  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-2"  
class="td11">        C++             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-3"  
class="td11">    yes       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-4-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.cl</span></span>       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-2"  
class="td11">       OpenCL           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-3"  
class="td11">    yes       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-5-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.cu</span></span>       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-2"  
class="td11">        CUDA            </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-3"  
class="td11">    yes       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-6-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.F</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">.F77</span></span> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-6-2"  
class="td11"> Fortran (fixed-format)  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-6-3"  
class="td11">    yes       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-7-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.f</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">.f77</span></span> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-7-2"  
class="td11"> Fortran (fixed-format)  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-7-3"  
class="td11">     no       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-8-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.F90</span></span>      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-8-2"  
class="td11">  Fortran (free-format)   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-8-3"  
class="td11">    yes       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-9-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">.f90</span></span>      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-9-2"  
class="td11">  Fortran (free-format)   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-9-3"  
class="td11">     no       </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-10-1"  
class="td11">           </td>
</tr></table>                                                                                       </div></div>
<!--l. 826--><p class="noindent" >In order to use Cactus <span 
class="cmtt-10">#include </span>directives in a file, it must be preprocessed.
</p><!--l. 829--><p class="noindent" >A complete description of Fortran fixed and free format can be found in any textbook on Fortran. The most
obvious differences are that in fixed format, code must begin after the 5th column and line continuations are
indicated by a character in column 5, while in free format, lines can begin anywhere, and line continuations are
indicated by an ampersand at the end of the line to be continued. Also note that statement labels are handled
very differently.
</p><!--l. 837--><p class="noindent" >The following restrictions apply to file names: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 839--><p class="noindent" >For portability across all operating systems, the base names for any particular extension should
     not depend on the operating system being case sensitive (e.g. having <span 
class="cmtt-10">MyFile.c </span>and <span 
class="cmtt-10">MYFILE.f </span>is
     allright, but <span 
class="cmtt-10">MyFile.c </span>and <span 
class="cmtt-10">MYFILE.c </span>could cause problems).
     </p></li>
     <li class="itemize">
     <!--l. 844--><p class="noindent" >Currently, all source files within a thorn must have distinct names, regardless of whether they are
     placed in different subdirectories. We hope to relax this in future. Different thorns may have files
     with the same names, however.</p></li></ul>
<!--l. 852--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.2.5   </span> <a 
 id="x1-55000C1.2.5"></a>Adding Source Files</h4>
<!--l. 854--><p class="noindent" >By default, the CCTK looks in the <span 
class="cmtt-10">src </span>directory of the thorn for source files.
</p><!--l. 857--><p class="noindent" >There are two ways in which to specify the sources. The easiest is to use the <span 
class="cmtt-10">make.code.defn </span>based method in
which the CCTK does all the work, but you may instead put a <span 
class="cmtt-10">Makefile </span>in the <span 
class="cmtt-10">src </span>directory and do everything
yourself.
</p><!--l. 862--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-56000"></a><span 
class="cmtt-10">make.code.defn </span>based thorn building</h5>
                                                                                       
                                                                                       
<a 
 id="x1-56000doc"></a>
<!--l. 865--><p class="noindent" >This is the standard way to compile your thorn’s source files. The Cactus make system looks for a file called
<span 
class="cmtt-10">make.code.defn </span>in that directory (if there is no file called <span 
class="cmtt-10">Makefile </span>in the <span 
class="cmtt-10">src </span>directory). At its simplest, this
file contains two lines
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 870--><p class="noindent" ><span 
class="cmtt-10">SRCS = &#x003C;</span><span 
class="cmsltt-10">list of all source files in this directory</span><span 
class="cmtt-10">&#x003E;</span>
     </p></li>
     <li class="itemize">
     <!--l. 872--><p class="noindent" ><span 
class="cmtt-10">SUBDIRS = &#x003C;</span><span 
class="cmsltt-10">list of all subdirectories, including subdirectories of</span>
     <span 
class="cmsltt-10">subdirectories</span><span 
class="cmtt-10">&#x003E;</span>
</p>
     </li></ul>
<!--l. 877--><p class="noindent" >Each subdirectory listed should then have a <span 
class="cmtt-10">make.code.defn </span>file containing just a <span 
class="cmtt-10">SRCS =  </span>line, a <span 
class="cmtt-10">SUBDIRS =</span>
line will be ignored.
</p><!--l. 881--><p class="noindent" >In addition, each directory can have a <span 
class="cmtt-10">make.code.deps </span>file, which, for files in that directory, can contain
additional make rules and dependencies for files in that directory. See the GNU Make documentation for
complete details of the syntax.
</p><!--l. 886--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-57000"></a><span 
class="cmtt-10">Makefile </span>based thorn building</h5>
<!--l. 888--><p class="noindent" >This method gives you the ultimate responsibility. The only requirement is that a library called <span 
class="tctt-1000">$</span><span 
class="cmtt-10">NAME </span>be created
by the <span 
class="cmtt-10">Makefile</span>.
</p><!--l. 892--><p class="noindent" >The makefile is passed the following variables
                  </p><dl class="list1"><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(CCTK</span><span 
class="cmtt-10">_HOME)</span>      </dt><dd 
class="list">
                  <!--l. 895--><p class="noindent" >the main Cactus directory
                  </p></dd><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(TOP)</span>            </dt><dd 
class="list">
                  <!--l. 897--><p class="noindent" >the configuration directory
                  </p></dd><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(SRCDIR)</span>         </dt><dd 
class="list">
                  <!--l. 899--><p class="noindent" >the directory in which the source files can be found
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(CONFIG)</span>         </dt><dd 
class="list">
                  <!--l. 901--><p class="noindent" >the directory containing the configuration files
                  </p></dd><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(THORN)</span>          </dt><dd 
class="list">
                  <!--l. 903--><p class="noindent" >the thorn name
                  </p></dd><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(SCRATCH</span><span 
class="cmtt-10">_BUILD)</span>  </dt><dd 
class="list">
                  <!--l. 905--><p class="noindent" >the scratch directory where Fortran module files should end up if they need to be
                  seen by other thorns.
                  </p></dd><dt class="list">
<span 
class="tctt-1000">$</span><span 
class="cmtt-10">(NAME)</span>           </dt><dd 
class="list">
                  <!--l. 908--><p class="noindent" >the name of the library to be built
</p>
                  </dd></dl>
<!--l. 912--><p class="noindent" >and has a working directory of <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">config</span><span 
class="cmtt-10">&#x003E;/build/&#x003C;</span><span 
class="cmsltt-10">thorn</span><span 
class="cmsltt-10">_name</span><span 
class="cmtt-10">&#x003E; </span>.
</p><!--l. 915--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-58000"></a>Other makefile variables</h5>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 918--><p class="noindent" ><span 
class="cmtt-10">CPP</span>: The C preprocessor which is used to preprocess C and C++ source code, and to determine
     the C and C++ make dependencies
     </p></li>
     <li class="itemize">
     <!--l. 921--><p class="noindent" ><span 
class="cmtt-10">FPP</span>: The C preprocessor which is used to preprocess Fortran source code
     </p></li>
     <li class="itemize">
     <!--l. 923--><p class="noindent" ><span 
class="cmtt-10">CPPFLAGS</span>: Flags which are passed to <span 
class="cmtt-10">CPP</span>, to <span 
class="cmtt-10">CC</span>, and to <span 
class="cmtt-10">CXX</span>
     </p></li>
     <li class="itemize">
     <!--l. 925--><p class="noindent" ><span 
class="cmtt-10">FPPFLAGS</span>: Flags which are passed to <span 
class="cmtt-10">FPP</span>
     </p></li>
     <li class="itemize">
     <!--l. 926--><p class="noindent" ><span 
class="cmtt-10">CC</span>: The C compiler
                                                                                       
                                                                                       
     </p></li>
     <li class="itemize">
     <!--l. 927--><p class="noindent" ><span 
class="cmtt-10">CXX</span>: The C++ compiler
     </p></li>
     <li class="itemize">
     <!--l. 928--><p class="noindent" ><span 
class="cmtt-10">CUCC</span>: The CUDA compiler
     </p></li>
     <li class="itemize">
     <!--l. 929--><p class="noindent" ><span 
class="cmtt-10">F90</span>: The Fortran compiler
     </p></li>
     <li class="itemize">
     <!--l. 930--><p class="noindent" ><span 
class="cmtt-10">F77</span>: Same as <span 
class="cmtt-10">F90</span>
     </p></li>
     <li class="itemize">
     <!--l. 931--><p class="noindent" ><span 
class="cmtt-10">CFLAGS</span>: Flags which are passed to <span 
class="cmtt-10">CC</span>
     </p></li>
     <li class="itemize">
     <!--l. 932--><p class="noindent" ><span 
class="cmtt-10">CXXFLAGS</span>: Flags which are passed to <span 
class="cmtt-10">CXX</span>
     </p></li>
     <li class="itemize">
     <!--l. 933--><p class="noindent" ><span 
class="cmtt-10">CUCCFLAGS</span>: Flags which are passed to <span 
class="cmtt-10">CUDA</span>
     </p></li>
     <li class="itemize">
     <!--l. 934--><p class="noindent" ><span 
class="cmtt-10">F90FLAGS</span>: Flags which are passed to <span 
class="cmtt-10">F90</span>
     </p></li>
     <li class="itemize">
     <!--l. 935--><p class="noindent" ><span 
class="cmtt-10">F77FLAGS</span>: Same as <span 
class="cmtt-10">F90FLAGS</span>
     </p></li>
     <li class="itemize">
     <!--l. 936--><p class="noindent" ><span 
class="cmtt-10">LD</span>: The binder. This should not be directly <span 
class="cmtt-10">ld</span>, but should be a compiler driver such as C++. Often,
     <span 
class="cmtt-10">LD </span>is the same as <span 
class="cmtt-10">CXX</span>
     </p></li>
     <li class="itemize">
     <!--l. 939--><p class="noindent" ><span 
class="cmtt-10">LDFLAGS</span>: Flags which are passed to <span 
class="cmtt-10">LD</span></p></li></ul>
<!--l. 942--><p class="noindent" >Note that there are no makefile variables to specify an OpenCL compiler or its flags. OpenCL is implemented as
a library, and code is compiled at run time via library functions to which the source code is passed as a string.
OpenCL source code (files with the extension <span 
class="cmtt-10">.cl</span>) are thus not compiled when a Cactus configuration is built.
Instead, the content of <span 
class="cmtt-10">.cl </span>files is converted into a string and placed into the executable. These
strings have the type <span 
class="cmtt-10">char</span><span 
class="cmtt-10"> const</span><span 
class="cmtt-10"> * </span>in C, and can be accessed at run time under a (globally visible)
name <span 
class="cmtt-10">OpenCL</span><span 
class="cmtt-10">_source</span><span 
class="cmtt-10">_THORN</span><span 
class="cmtt-10">_FILE</span>, where <span 
class="cmtt-10">THORN </span>and <span 
class="cmtt-10">FILE </span>and are the thorn name and file name,
respectively.
                                                                                       
                                                                                       
</p><!--l. 957--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.3   </span> <a 
 id="x1-59000C1.3"></a>Cactus Variables</h3>
<!--l. 960--><p class="noindent" >A <span 
class="cmti-10">grid variable </span>is a Cactus program variable passed among thorns, (or routines belonging to the same
thorn interface), by way of calls to the flesh. They are the only variables known to Cactus. Such
variables represent values of functions on the computational grid, and are, therefore, often called <span 
class="cmti-10">grid</span>
<span 
class="cmti-10">functions</span>.
</p><!--l. 967--><p class="noindent" >In the Cactus context, grid variables are often referred to simply as <span 
class="cmti-10">variables</span>.
</p><!--l. 970--><p class="noindent" >Cactus variables are used instead of local variables for a number of reasons: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 972--><p class="noindent" >Cactus variables can be made visible to other thorns, allowing thorns to communicate and share
     data.
     </p></li>
     <li class="itemize">
     <!--l. 974--><p class="noindent" >Cactus  variables  can  be  distributed  and  communicated  among  processors,  allowing  parallel
     computation.
     </p></li>
     <li class="itemize">
     <!--l. 976--><p class="noindent" >A database of Cactus variables, and their attributes, is held by the flesh, and this information is
     used by thorns, for example, for obtaining a list of variables for checkpointing.
     </p></li>
     <li class="itemize">
     <!--l. 979--><p class="noindent" >Many Cactus APIs and tools can only be used with Cactus variables.
     </p></li>
     <li class="itemize">
     <!--l. 980--><p class="noindent" >Cactus provides features for error checking based on Cactus variables and their attributes.</p></li></ul>
<!--l. 984--><p class="noindent" >Cactus variables are collected into <span 
class="cmti-10">groups</span>. All variables in a group are of the same data type, and have the same
attributes. Most Cactus operations act on a group as a whole. A group must be declared in its thorn’s
<span 
class="cmtt-10">interface.ccl </span>file.
</p><!--l. 989--><p class="noindent" >The specification for a group declaration (fully described in Appendix <a 
href="#x1-180000D2.2">D2.2<!--tex4ht:ref: sec:Appendix.interface --></a>) is,
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">data_type</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group_name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [TYPE=&#x003C;</span><span 
class="cmsltt-10">group_type</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [DIM=&#x003C;</span><span 
class="cmsltt-10">dim</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [TIMELEVELS=&#x003C;</span><span 
class="cmsltt-10">num</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [SIZE=&#x003C;</span><span 
class="cmsltt-10">size</span><span 
class="cmsltt-10"> in</span><span 
class="cmsltt-10"> each</span><span 
class="cmsltt-10"> direction</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [DISTRIB=&#x003C;</span><span 
class="cmsltt-10">distribution_type</span><span 
class="cmtt-10">&#x003E;]</span>
                                                                                       
                                                                                       
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [GHOSTSIZE=&#x003C;</span><span 
class="cmsltt-10">ghostsize</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10">[</span><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> [</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable_name</span><span 
class="cmtt-10">&#x003E;[,]&#x003C;</span><span 
class="cmsltt-10">variable_name</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable_name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> ]</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> [&#x0022;&#x003C;</span><span 
class="cmsltt-10">group_description</span><span 
class="cmtt-10">&#x003E;&#x0022;]</span><span 
class="cmtt-10"> ]</span>
</div>
</div>
<!--l. 1002--><p class="noindent" >Currently, the names of groups and variables must be distinct.
</p><!--l. 1006--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.3.1   </span> <a 
 id="x1-60000C1.3.1"></a>Data Type</h4>
<!--l. 1008--><p class="noindent" >Cactus supports integer, real, complex and character variable types, in various different sizes. (Sizes in the
following refer to the number of bytes occupied by the a variable of the type).
</p><!--l. 1012--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">INTEGER</span>          </dt><dd 
class="list">
                  <!--l. 1013--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT1</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT2</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT4</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT8</span>. (<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>defaults to
                  being <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT4</span>).
                  </p></dd><dt class="list">
<span 
class="cmss-10">REAL</span>             </dt><dd 
class="list">
                  <!--l. 1016--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL4</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL8</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL16</span>. (<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL </span>defaults to being
                  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL8</span>).
                  </p></dd><dt class="list">
<span 
class="cmss-10">COMPLEX</span>         </dt><dd 
class="list">
                  <!--l. 1018--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span>,       <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX8</span>,       <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX16</span>,       <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX32</span>.
                  (<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX </span>defaults to being <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX16</span>).
                  </p></dd><dt class="list">
<span 
class="cmss-10">BYTE</span>             </dt><dd 
class="list">
                  <!--l. 1021--><p class="noindent" >This is a 1 byte data type.</p></dd></dl>
<!--l. 1025--><p class="noindent" >Normally a thorn should use the default types—<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span>—rather than explicitly
setting the size, as this gives maximum portability. Also, the defaults can be changed at configuration time (see
Section <a 
href="#x1-20000B2.1.1">B2.1.1<!--tex4ht:ref: subsec:Compilation-Available_Options --></a>), and this allows people to compile the code with different precisions to test for roundoff effects,
or to run more quickly with a lower accuracy.
                                                                                       
                                                                                       
</p><!--l. 1033--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.3.2   </span> <a 
 id="x1-61000C1.3.2"></a>Group Types</h4>
<!--l. 1036--><p class="noindent" >Groups can be either <span 
class="cmti-10">scalars</span>, <span 
class="cmti-10">grid functions </span>(GFs), or <span 
class="cmti-10">grid arrays</span>. Different attributes are relevant for the
different group types.
</p><!--l. 1041--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">SCALAR</span>            </dt><dd 
class="list">
                  <!--l. 1042--><p class="noindent" >This is just a single number, e.g. the total energy of some field. These variables
                  aren’t  communicated  between  processors—what  would  be  the  result  of  such
                  communication?
                  </p></dd><dt class="list">
<span 
class="cmtt-10">GF</span>                </dt><dd 
class="list">
                  <!--l. 1046--><p class="noindent" >This is the most common group type. A GF is an array with a specific size, set at
                  run time in the parameter file, which is distributed across processors. All GFs have
                  the same size, and the same number of ghostzones. Groups of GFs can also specify
                  a dimension, and number of timelevels.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">ARRAY</span>             </dt><dd 
class="list">
                  <!--l. 1052--><p class="noindent" >This is a more general form of the GF. Each group of arrays can have a distinct
                  size and number of ghostzones, in addition to dimension and number of timelevels.
                  The drawback of using an array over a GF is that a lot of data about the array can
                  only be determined by function calls, rather than the quicker methods available for
                  GFs.</p></dd></dl>
<!--l. 1063--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.3.3   </span> <a 
 id="x1-62000C1.3.3"></a>Timelevels</h4>
<!--l. 1065--><p class="noindent" >These are best introduced by an example using finite differencing. Consider the 1-D wave equation \begin {equation}  \frac {\partial ^2 \phi }{\partial t^2} = \frac {\partial ^2 \phi }{\partial x^2}  \end {equation}<a 
 id="x1-62001r1"></a> To solve this
by partial differences, one discretises the derivatives to get an equation relating the solution at different times.
There are many ways to do this, one of which produces the following difference equation \begin {equation}  \label {equation:difference} \phi (t+\Delta t,x) -2\phi (t,x) +\phi (t-\Delta t,x) = \frac {\Delta t^2}{\Delta x^2} \lbrace {\phi (t,x+\Delta x) -2\phi (t,x) +\phi (t,x-\Delta x)}\rbrace  \end {equation}<a 
 id="x1-62002r2"></a> which relates the three
timelevels \(t+\Delta t\), \(t\), and \(t-\Delta t\).
</p><!--l. 1079--><p class="noindent" >Obviously, the code could just use three variables, one for each timelevel. This turns out, however, to be
inefficient, because as soon as the time is incremented to \(t+\Delta t\), it would be necessary to copy data from the \(t\) variable
to the \(t-\Delta t\) variable and from the \(t+\Delta t\) variable to the \(t\) variable.
</p><!--l. 1085--><p class="noindent" >To remove this extraneous copy, Cactus allows you to specify the number of timelevels used by your
numerical scheme. It then generates variables with the base name (e.g. <span 
class="cmtt-10">phi</span>) suffixed by a qualifier
for which timelevel is being referred to—no suffix for the next timelevel, and <span 
class="cmtt-10">_p </span>for each previous
timelevel.
                                                                                       
                                                                                       
</p><!--l. 1091--><p class="noindent" >The timelevels are rotated (by the driver thorn) at the start of each evolution step, that is:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-21">
initial
poststep
analysis

loop:
  rotate timelevels
  t = t + dt
  it = it + 1
  prestep
  evolve
  poststep
  analysis
</pre>
<!--l. 1106--><p class="nopar" >
</p><!--l. 1108--><p class="noindent" >Timelevel rotation means that, for example, <span 
class="cmtt-10">phi</span><span 
class="cmtt-10">_p </span>now holds the values of the former <span 
class="cmtt-10">phi</span>, and <span 
class="cmtt-10">phi</span><span 
class="cmtt-10">_p</span><span 
class="cmtt-10">_p </span>the
values of the former <span 
class="cmtt-10">phi</span><span 
class="cmtt-10">_p</span>, etc. Note that after rotation, <span 
class="cmtt-10">phi </span>is undefined, and its values should not be used
until they have been updated.
</p><!--l. 1114--><p class="noindent" >All timelevels, except the current level, should be considered <span 
class="cmti-10">read-only </span>during evolution, that is, their values
should not be changed by thorns. The exception to this rule is for function initialisation, when the values at the
previous timelevels do need to be explicitly filled out.
</p><!--l. 1120--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.3.4   </span> <a 
 id="x1-63000C1.3.4"></a>Size and Distrib</h4>
<!--l. 1122--><p class="noindent" >A Cactus grid function or array has a size set at runtime by parameters. This size can either be the global size of
the array across all processors (<span 
class="cmtt-10">DISTRIB=DEFAULT</span>), or, if <span 
class="cmtt-10">DISTRIB=CONSTANT</span>, the specified size on <span 
class="cmti-10">each</span>
processor. If the size is split across processors, the driver thorn is responsible for assigning the size on each
processor.
</p><!--l. 1132--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.3.5   </span> <a 
 id="x1-64000C1.3.5"></a>Ghost Zones</h4>
<!--l. 1135--><p class="noindent" >Cactus is based upon a <span 
class="cmti-10">distributed computing </span>paradigm. That is, the problem domain is split into blocks, each of
which is assigned to a processor. For hyperbolic and parabolic problems the blocks only need to communicate at
                                                                                       
                                                                                       
the edges.
</p><!--l. 1140--><p class="noindent" >To illustrate this, take the example of the wave equation again. Equation <a 
href="#x1-62002r2">C1.2<!--tex4ht:ref: equation:difference --></a> describes a possible
time-evolution scheme. On examination, you can see that to generate the data at the point (\(t+\Delta t\), \(x\)) we need data
from the four points (\(t\), \(x\)), (\(t-\Delta t\), \(x\)), (\(t\), \(x+\Delta x\)), and (\(t\), \(x-\Delta x\)) only. Ignoring the points at \(x\), which are obviously always available on
a given processor, you can see that the algorithm requires a point on either side of the point \(x\), i.e. this
algorithm has <span 
class="cmti-10">stencil size </span>1. Similarly algorithms requiring two points on either side have stencil size 2,
etc.
</p><!--l. 1151--><p class="noindent" >Now, if you evolve the above scheme, it becomes apparent that at each iteration the number of grid points you
can evolve decreases by one at each edge (see Figure <a 
href="#x1-640011">C1.1<!--tex4ht:ref: fig:noghost --></a>).
</p>
<hr class="figure" /><div class="figure" 
>
                                                                                       
                                                                                       
<a 
 id="x1-640011"></a>
                                                                                       
                                                                                       
<div class="center" 
>
<!--l. 1156--><p class="noindent" >
</p><!--l. 1157--><p class="noindent" ><span class="rotatebox" style="transform: rotate(-0deg);"><img 
src="1dnoghost.png" alt="PIC"  
width="1160" /></span>                                        </p></div>
<br /> <div class="caption" 
><span class="id">Figure C1.1: </span><span  
class="content">Distributed wave equation with no ghostzones</span></div><!--tex4ht:label?: x1-640011 -->
                                                                                       
                                                                                       
</div><hr class="endfigure" />
<!--l. 1163--><p class="noindent" >At the outer boundary of the physical domain, the data for the boundary point can be generated by the
boundary conditions, however, at internal boundaries, the data has to be copied from the adjacent processor. It
would be inefficient to copy each point individually, so instead, a number of <span 
class="cmti-10">ghostzones </span>are created at the
internal boundaries. A ghostzone consists of a copy of the whole plane (in 3D, line in 2D, point in 1D) of the
data from the adjacent processor. That is, the array on each processor is augmented with copies of points from
the adjacent processors, thus allowing the algorithm to proceed <span 
class="cmti-10">on the points owned by this processor </span>without
having to worry about copying data. Once the data has been evolved one step, the data in the ghostzones can
be exchanged (or <span 
class="cmti-10">synchronised</span>) between processors in one fell swoop before the next evolution
step. (See Figure <a 
href="#x1-640022">C1.2<!--tex4ht:ref: fig:withghost --></a>.) Note that you should have at least as many ghostzones as your stencil size
requires.
</p>
<hr class="figure" /><div class="figure" 
>
                                                                                       
                                                                                       
<a 
 id="x1-640022"></a>
                                                                                       
                                                                                       
<div class="center" 
>
<!--l. 1180--><p class="noindent" >
</p><!--l. 1181--><p class="noindent" ><span class="rotatebox" style="transform: rotate(-0deg);"><img 
src="withghost.png" alt="PIC"  
width="1218" /></span>                                        </p></div>
<br /> <div class="caption" 
><span class="id">Figure C1.2: </span><span  
class="content">Distributed wave equation with ghostzones</span></div><!--tex4ht:label?: x1-640022 -->
                                                                                       
                                                                                       
</div><hr class="endfigure" />
<h4 class="subsectionHead"><span class="titlemark">C1.3.6   </span> <a 
 id="x1-65000C1.3.6"></a>Information about Grid Variables</h4>
<!--l. 1191--><p class="noindent" >The flesh holds a database with information related to grid variables, and provides a set of querying
APIs.
</p><!--l. 1194--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-66000"></a>Group Information</h5>
<!--l. 1196--><p class="noindent" >Fundamental information about grid functions (e.g. local grid size and location, number of ghostzones) is passed
through the argument list of scheduled routines (see Section <a 
href="#x1-98000doc">C1.6.2.0<!--tex4ht:ref: sec:cactus_variables_c --></a>). To obtain similar information from
non-scheduled routines, or for general grid variables, a set of functions are provided, the last two letters of which
specify whether the information is requested using a group name (<span 
class="cmtt-10">GN</span>) or index (<span 
class="cmtt-10">GI</span>), or a variable name (<span 
class="cmtt-10">VN</span>) or
index (<span 
class="cmtt-10">VI</span>).
</p><!--l. 1204--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Grouplsh[GN|GI|VN|VI]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1206--><p class="noindent" >An array of integers with the local grid size on this processor.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Groupgsh[GN|GI|VN|VI]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1209--><p class="noindent" >An array of integers with the global grid size.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Groupbbox[GN|GI|VN|VI]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1212--><p class="noindent" >An array of integers which indicate whether the boundaries are internal boundaries
                  (e.g. between processors), or physical boundaries. A value of <span 
class="cmtt-10">1 </span>indicates a physical
                  (outer) boundary at the edge of the computational grid, and <span 
class="cmtt-10">0 </span>indicates an internal
                  boundary.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Groupnghostzones[GN|GI|VN|VI]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1219--><p class="noindent" >An array of integers with the number of ghostzones used in each direction.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Grouplbnd[GN|GI|VN|VI]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1222--><p class="noindent" >An array of integers containing the lowest index (in each direction) of the local grid,
                  as seen on the global grid. Note that these indices start from zero, so you need to
                  add one when using them in Fortran thorns.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Groupubnd[GN|GI|VN|VI]</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1228--><p class="noindent" >An array of integers containing the largest index (in each direction) of the local
                  grid, as seen on the global grid. Note that these indices start from zero, so you need
                  to add one when using them in Fortran thorns.
</p>
                  </dd></dl>
<!--l. 1239--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.4   </span> <a 
 id="x1-67000C1.4"></a>Cactus Parameters</h3>
<!--l. 1242--><p class="noindent" >Parameters are the means by which the user specifies the runtime behaviour of the code. Each parameter has a
data type and a name, as well as a range of allowed values and a default value. These are declared in the thorn’s
<span 
class="cmtt-10">param.ccl </span>file.
</p><!--l. 1247--><p class="noindent" >The thorn determines which parameters can be used in other thorns by specifying a <span 
class="cmti-10">scope </span>for the thorn, as
explained in Section <a 
href="#x1-74000C1.4.2">C1.4.2<!--tex4ht:ref: sec:Cactus_parameters.scope --></a>.
</p><!--l. 1251--><p class="noindent" >The user may specify initial values for parameters in the parameter file (see Section <a 
href="#x1-33000B3.2">B3.2<!--tex4ht:ref: sec:Parameter_File --></a>); the flesh validates
these values against the parameters’ allowed ranges. Otherwise, the initial value of the parameter is taken to be
its default. Once validated, parameter values are fixed, and cannot be changed, unless the parameter
is specified to be <span 
class="cmti-10">steerable </span>(see <a 
href="#x1-75000C1.4.3">C1.4.3<!--tex4ht:ref: sec:Cactus_parameters.steerable --></a>). For a detailed discussion of the <span 
class="cmtt-10">param.ccl </span>syntax, see
Appendix <a 
href="#x1-185000D2.3">D2.3<!--tex4ht:ref: sec:Appendix.param --></a>.
</p><!--l. 1261--><p class="noindent" >The full specification for a parameter declaration is </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">[EXTENDS|USES]</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">parameter_type</span><span 
class="cmtt-10">&#x003E;[[&#x003C;</span><span 
class="cmsltt-10">size</span><span 
class="cmtt-10">&#x003E;]]</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x0022;&#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> description</span><span 
class="cmtt-10">&#x003E;&#x0022;</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">PARAMETER_RANGES</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">default</span><span 
class="cmsltt-10"> value</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div>
<!--l. 1269--><p class="noindent" >You can obtain lists of the parameters associated with each thorn using the Cactus command line options <span 
class="cmtt-10">-o </span>and
<span 
class="cmtt-10">-O </span>(Section <a 
href="#x1-32000B3.1">B3.1<!--tex4ht:ref: sec:command_line_options --></a>).
</p><!--l. 1276--><p class="noindent" >
</p>
                                                                                       
                                                                                       
<h4 class="subsectionHead"><span class="titlemark">C1.4.1   </span> <a 
 id="x1-68000C1.4.1"></a>Types and Ranges</h4>
<!--l. 1279--><p class="noindent" >Parameters can be of these types:
</p><!--l. 1281--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">Int</span>                </dt><dd 
class="list">
                  <!--l. 1282--><p class="noindent" >Can take any integral value
                  </p></dd><dt class="list">
<span 
class="cmss-10">Real</span>               </dt><dd 
class="list">
                  <!--l. 1283--><p class="noindent" >Can take any floating point value
                  </p></dd><dt class="list">
<span 
class="cmss-10">Keyword</span>           </dt><dd 
class="list">
                  <!--l. 1284--><p class="noindent" >Can have a value consisting of one of a choice of strings
                  </p></dd><dt class="list">
<span 
class="cmss-10">Boolean</span>            </dt><dd 
class="list">
                  <!--l. 1285--><p class="noindent" >Can be true or false (<span class="obeylines-h"><span 
class="cmtt-10">1</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">t</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">true</span></span>, or <span class="obeylines-h"><span 
class="cmtt-10">0</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">f</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">false</span></span>)
                  </p></dd><dt class="list">
<span 
class="cmss-10">String</span>             </dt><dd 
class="list">
                  <!--l. 1287--><p class="noindent" >Can have any string value</p></dd></dl>
<!--l. 1290--><p class="noindent" >Each parameter can be validated against a set of allowed <span 
class="cmti-10">ranges</span>, each of which has a description associated with
it. The nature of the range is determined by the type of parameter, as follows:
</p><!--l. 1295--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-69000"></a>Int</h5>
<!--l. 1297--><p class="noindent" >The range specification is of the form
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmsltt-10">lower</span><span 
class="cmtt-10">:</span><span 
class="cmsltt-10">upper</span><span 
class="cmtt-10">:</span><span 
class="cmsltt-10">stride</span>
</div>
</div>
<!--l. 1303--><p class="noindent" >where <span 
class="cmsltt-10">lower </span>and <span 
class="cmsltt-10">upper </span>specify the lower and upper allowed range, and <span 
class="cmsltt-10">stride </span>allows numbers to be be missed
out, e.g. 
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-22">
1:21:2
</pre>
<!--l. 1307--><p class="nopar" >means the value must be an odd number between one and twenty-one (inclusive).
</p><!--l. 1311--><p class="noindent" >A missing end of range (or a ‘<span 
class="cmtt-10">*</span>’) indicates negative or positive
</p><!--l. 1313--><p class="noindent" >Note that if <span 
class="cmsltt-10">stride </span>is specified, then <span 
class="cmsltt-10">upper </span>must be specified, or ‘<span 
class="cmtt-10">*</span>’ (i.e. the specifier ‘<span 
class="cmtt-10">1::2</span>’ is not
legal)
</p><!--l. 1316--><p class="noindent" >infinity, and the default stride is one. A ‘<span 
class="cmtt-10">(</span>’ (or ‘<span 
class="cmtt-10">)</span>’) before (or after) the lower (or upper) range specifies an open
endpoint.
</p><!--l. 1320--><p class="noindent" >Note that ’<span 
class="cmtt-10">*</span>’ is not allowed for the lower bound.
</p><!--l. 1322--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-70000"></a>Real</h5>
<!--l. 1324--><p class="noindent" >The range specification is of the form </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmsltt-10">lower</span><span 
class="cmtt-10">:</span><span 
class="cmsltt-10">upper</span>
</div>
</div> where <span 
class="cmsltt-10">lower </span>and <span 
class="cmsltt-10">upper </span>specify the lower and upper allowed range. A missing end of range (or a ‘<span 
class="cmtt-10">*</span>’) implies
negative or positive infinity. The above is inclusive of the endpoints. A ‘<span 
class="cmtt-10">(</span>’ (or ‘<span 
class="cmtt-10">)</span>’) before (or after) the lower (or
upper) range specifies an open endpoint. Likewise, a ‘<span 
class="cmtt-10">[ </span>(or ‘<span 
class="cmtt-10">]</span>’) before (or after) the lower (or upper) range
specifies a closed endpoint.
<!--l. 1336--><p class="noindent" >The numbers written in a <span 
class="cmtt-10">param.ccl </span>file are interpreted as C code. To express a number in ‘scientific notation’,
use, e.g. ‘<span 
class="cmtt-10">1e-10</span>’, which is a double precision constant in C. (If the floating precision of the variable to
which it is assigned is not double, then C will typecast appropriately. If you <span 
class="cmti-10">really </span>want to specify
a single precision floating constant, or a long double constant, append the number with <span class="obeylines-h"><span 
class="cmtt-10">f</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">l</span></span>
respectively.)
</p><!--l. 1344--><p class="noindent" >
                                                                                       
                                                                                       
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-71000"></a>Keyword</h5>
<!--l. 1346--><p class="noindent" >The range specification consists of a string, which will be matched in a case insensitive manner.
</p><!--l. 1349--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-72000"></a>Boolean</h5>
<!--l. 1351--><p class="noindent" >There is no range specification for this type of parameter.
</p><!--l. 1353--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-73000"></a>String</h5>
<!--l. 1355--><p class="noindent" >The range is a POSIX regular expression. On some machines you may be able to use extended regular
expressions, but this is not guaranteed to be portable.
</p><!--l. 1361--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.4.2   </span> <a 
 id="x1-74000C1.4.2"></a>Scope</h4>
<!--l. 1364--><p class="noindent" >Parameters can be <span 
class="cmtt-10">GLOBAL</span>, <span 
class="cmtt-10">RESTRICTED</span>, or <span 
class="cmtt-10">PRIVATE</span>. Global parameters are visible to all thorns. Restricted
parameters are visible to any thorn which chooses to <span 
class="cmtt-10">USE </span>or <span 
class="cmtt-10">EXTEND </span>it. A private parameter is only visible to the
thorn which declares it. The default scope is <span 
class="cmtt-10">PRIVATE</span>.
</p><!--l. 1370--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.4.3   </span> <a 
 id="x1-75000C1.4.3"></a>Steerable</h4>
<!--l. 1372--><p class="noindent" >A parameter can be changed dynamically if it is specified to be <span 
class="cmti-10">steerable </span>(see Section <a 
href="#x1-187000D2.3.2">D2.3.2<!--tex4ht:ref: subsec:Appendix.param.specification_items --></a>). It can then be
changed by a call to the flesh function <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ParameterSet </span>(see the Reference Guide for a description of this
function).
                                                                                       
                                                                                       
</p><!--l. 1382--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.5   </span> <a 
 id="x1-76000C1.5"></a>Scheduling</h3>
<!--l. 1385--><p class="noindent" >Cactus contains a rule-based scheduling system, which determines which routines, from which thorns are run in
which order. The scheduler determines if the specifications are inconsistent, but does allow the user to schedule a
routine with respect to another routine which may not exist. For a detailed discussion of the <span class="obeylines-h"><span 
class="cmtt-10">schedule.ccl</span></span>
syntax see Appendix <a 
href="#x1-188000D2.4">D2.4<!--tex4ht:ref: sec:Appendix.schedule --></a>.
</p><!--l. 1393--><p class="noindent" >A usual simple specification for a schedule declaration is </p><div class="alltt">
<div class="obeylines-v">           <span 
class="cmtt-10">schedule</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">function</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> AT</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">schedule</span><span 
class="cmsltt-10"> bin</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> LANG:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">language</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [STORAGE:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">]],&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">]]...]</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> &#x0022;</span><span 
class="cmsltt-10">Description</span><span 
class="cmsltt-10"> of</span><span 
class="cmsltt-10"> function</span><span 
class="cmtt-10">&#x0022;</span>
</div>
</div>
<!--l. 1401--><p class="noindent" >The full specification for a schedule declaration is </p><div class="alltt">
<div class="obeylines-v">
<span 
class="cmtt-10">schedule</span><span 
class="cmtt-10"> [GROUP]</span><span 
class="cmtt-10"> &#x003C;function|</span><span 
class="cmsltt-10">schedule</span><span 
class="cmsltt-10"> group</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> AT|IN</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">schedule</span><span 
class="cmsltt-10"> bin</span><span 
class="cmtt-10">|</span><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [AS</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [WHILE</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [IF</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [BEFORE|AFTER</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">item</span><span 
class="cmtt-10">&#x003E;|(&#x003C;</span><span 
class="cmsltt-10">item</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">item</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> ...)]</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> LANG:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">language</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [STORAGE:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">]],&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">]]...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [TRIGGER:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [SYNC:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [OPTIONS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> &#x0022;</span><span 
class="cmsltt-10">Description</span><span 
class="cmsltt-10"> of</span><span 
class="cmsltt-10"> function</span><span 
class="cmsltt-10"> or</span><span 
class="cmsltt-10"> schedule</span><span 
class="cmsltt-10"> group</span><span 
class="cmtt-10">&#x0022;</span>
</div>
</div>
<!--l. 1415--><p class="noindent" >This full schedule specification consists of a mandatory part, a set of options, and the main body limited by
braces, referred to as the <span 
class="cmtt-10">schedule block</span>.
</p><!--l. 1419--><p class="noindent" >Each schedule item is scheduled either <span 
class="cmtt-10">AT </span>a particular <span 
class="cmsltt-10">scheduling bin</span>, or <span 
class="cmtt-10">IN </span>a schedule <span 
class="cmsltt-10">group</span>.
</p><!--l. 1424--><p class="noindent" >
                                                                                       
                                                                                       
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.5.1   </span> <a 
 id="x1-77000C1.5.1"></a>Schedule Bins</h4>
<!--l. 1427--><p class="noindent" >These are the main times at which scheduled functions are run, from fixed points in the flesh and driver
thorn (schedule bins can easily be traversed from any thorn, although this is not usual). When a
schedule bin is <span 
class="cmti-10">traversed</span>, all the functions scheduled in that particular are called, in the manner
described in Section <a 
href="#x1-81000C1.5.5">C1.5.5<!--tex4ht:ref: scheduling:calling_scheduled_functions --></a> and respecting the requested ordering of functions(Section <a 
href="#x1-79000C1.5.3">C1.5.3<!--tex4ht:ref: scheduling:schedule_options --></a>). In the
absence of any ordering, functions in a particular schedule bin will be called in an undetermined
order.
</p><!--l. 1436--><p class="noindent" >The schedule bins are described in Section <a 
href="#x1-51000doc">C1.2.3.0<!--tex4ht:ref: subsec:schedule_ccl --></a>. Note that the preceding <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ </span>is optional for the use of the
bin names in the <span 
class="cmtt-10">schedule.ccl </span>file.
</p><!--l. 1442--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.5.2   </span> <a 
 id="x1-78000C1.5.2"></a>Groups</h4>
<!--l. 1445--><p class="noindent" >If the optional <span 
class="cmtt-10">GROUP </span>specifier is used, the item is a schedule group rather than a normal function. Schedule
groups are effectively new, user-defined, schedule bins. Functions or groups may be scheduled <span 
class="cmtt-10">IN</span>
these, in the same way as they are scheduled <span 
class="cmtt-10">AT </span>the main schedule bins. (That is, groups may be
nested.)
</p><!--l. 1453--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.5.3   </span> <a 
 id="x1-79000C1.5.3"></a>Schedule Options</h4>
<!--l. 1455--><p class="noindent" >The options define various characteristics of the schedule item.
</p><!--l. 1457--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">AS</span>                </dt><dd 
class="list">
                  <!--l. 1458--><p class="noindent" >This assigns a new name to a function for scheduling purposes. This is used, for
                  instance, to allow a thorn to schedule something before or after a routine from
                  another implementation; two thorns providing this implementation can schedule a
                  routine <span 
class="cmtt-10">AS </span>the same thing, thus allowing other thorns to operate independently of
                  which one is active.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">WHILE</span>             </dt><dd 
class="list">
                  <!--l. 1465--><p class="noindent" >This specifies a <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>grid scalar which is used to control the execution of this
                  item. As long as the grid scalar has a nonzero value, the schedule item will be
                  executed repeatedly. This allows dynamic behaviour with scheduling.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">IF</span>                </dt><dd 
class="list">
                  <!--l. 1471--><p class="noindent" >This specifies a <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>grid scalar which is used to control the execution of this
                  item. If the grid scalar has a nonzero value, the schedule item will be executed,
                  otherwise the item will be ignored. This allows dynamic behaviour with scheduling.
                  </p><!--l. 1477--><p class="noindent" >If both an <span 
class="cmtt-10">IF </span>and a <span 
class="cmtt-10">WHILE </span>clause are present, then the schedule is executed according to
                  the following pseudocode:
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-23">
                  IF condition
                    WHILE condition
                      SCHEDULE item
                    END WHILE
                  END IF
</pre>
                  <!--l. 1485--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">BEFORE </span><span 
class="cmss-10">or </span><span 
class="cmtt-10">AFTER</span>    </dt><dd 
class="list">
                  <!--l. 1487--><p class="noindent" >These specify either </p>
                      <ul class="itemize1">
                      <li class="itemize">
                      <!--l. 1490--><p class="noindent" >a function or group before or after which this item will be scheduled, or
                      </p></li>
                      <li class="itemize">
                      <!--l. 1492--><p class="noindent" >a list of functions and/or groups; this item will be scheduled (once) before any
                      of them or after all of them respectively.</p></li></ul>
                  <!--l. 1495--><p class="noindent" >Note that a single schedule item may have multiple <span 
class="cmtt-10">BEFORE </span>and/or <span 
class="cmtt-10">AFTER </span>options; the
                  scheduler will honor all of these (or abort with a fatal error). For example,
                  </p><div class="alltt">
                  <div class="obeylines-v">
                  <br /><span 
class="cmtt-10">schedule</span><span 
class="cmtt-10"> FOO</span><span 
class="cmtt-10"> BEFORE</span><span 
class="cmtt-10"> A</span><span 
class="cmtt-10"> BEFORE</span><span 
class="cmtt-10"> B</span><span 
class="cmtt-10"> BEFORE</span><span 
class="cmtt-10"> C</span><span 
class="cmtt-10"> ...</span>
</div>
                  </div> schedules <span 
class="cmtt-10">FOO </span>before any of <span 
class="cmtt-10">A</span>, <span 
class="cmtt-10">B</span>, or <span 
class="cmtt-10">C</span>. This can also be written <div class="alltt">
                  <div class="obeylines-v">
                  <br /><span 
class="cmtt-10">schedule</span><span 
class="cmtt-10"> FOO</span><span 
class="cmtt-10"> BEFORE</span><span 
class="cmtt-10"> (A</span><span 
class="cmtt-10"> B</span><span 
class="cmtt-10"> C)</span><span 
class="cmtt-10"> ...</span>
</div>
                  </div>
                  <!--l. 1507--><p class="noindent" >Note that the set of all <span 
class="cmtt-10">BEFORE</span>/<span 
class="cmtt-10">AFTER </span>options in all active schedule blocks of all active
                  thorns, <span 
class="cmti-10">must </span>specify a (directed) graph with no cycles; if there are any cycles, then the
                  scheduler will abort with a fatal error.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 1515--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.5.4   </span> <a 
 id="x1-80000C1.5.4"></a>The Schedule Block</h4>
<!--l. 1518--><p class="noindent" >The schedule block specifies further details of the scheduled function or group.
</p><!--l. 1521--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">LANG</span>              </dt><dd 
class="list">
                  <!--l. 1522--><p class="noindent" >This specifies the language of the routine. Currently this is either C or Fortran.
                  C++ routines should be defined as <span 
class="cmtt-10">extern &#x0022;C&#x0022; </span>and registered as <span 
class="cmtt-10">LANG: C</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">STORAGE</span>           </dt><dd 
class="list">
                  <!--l. 1526--><p class="noindent" >The <span 
class="cmtt-10">STORAGE </span>keyword specifies groups for which memory should be allocated for the
                  duration of the routine or schedule group. The storage status reverts to its previous
                  status after completion of the routine or schedule group. Each group must specify
                  how many timelevels to activate storage for, from 1 up to the maximum number
                  for the group as specified in the defining <span 
class="cmtt-10">interface.ccl </span>file. If the maximum
                  is  1  (the  default)  this  number  may  be  omitted.  Alternatively  <span 
class="cmsltt-10">timelevels </span>can
                  be the name of a parameter accessible to the thorn. The parameter name is the
                  same as used in C routines of the thorn, fully qualified parameter names of the
                  form <span 
class="cmsltt-10">thorn</span><span 
class="cmtt-10">::</span><span 
class="cmsltt-10">parameter </span>are not allowed. In this case 0 (zero) <span 
class="cmsltt-10">timelevels </span>can be
                  requested, which is equivalent to the <span 
class="cmtt-10">STORAGE </span>statement being absent.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">TRIGGER</span>           </dt><dd 
class="list">
                  <!--l. 1540--><p class="noindent" >This is only used for items scheduled at timebin <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS</span>. The item will only
                  be executed if output is due for at least one variable in one of the listed groups.
                  (The item will also be called if there is no group listed.)
                  </p></dd><dt class="list">
<span 
class="cmtt-10">SYNC</span>              </dt><dd 
class="list">
                  <!--l. 1545--><p class="noindent" >On exit from this item, the ghost zones of the listed groups will be exchanged.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">OPTIONS</span>           </dt><dd 
class="list">
                  <!--l. 1548--><p class="noindent" >This  is  for  miscellaneous  options.  The  list  of  accepted  options  is  given  in
                  Appendix <a 
href="#x1-191000doc">D2.4.2.0<!--tex4ht:ref: app:allopts --></a>.</p></dd></dl>
<!--l. 1555--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.5.5   </span> <a 
 id="x1-81000C1.5.5"></a>How Cactus Calls Scheduled Functions</h4>
<!--l. 1558--><p class="noindent" >For each scheduled function called, the flesh performs a variety of jobs at entry and exit.
                                                                                       
                                                                                       
</p><!--l. 1561--><p class="noindent" >On entry to a scheduled routine, if the routine is being called at the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS </span>timebin first, a check is
made to see if the routine should actually be called on this timestep. For this, all grid variables in the
trigger groups for the routine are checked with all registered output methods to determine if it is
time to output any triggers. The routine will only be called if at least one is due to be output.
Note that once a grid variable has been analyzed, it gets marked as such, and will not be analyzed
again during this iteration. (Note that a routine without any trigger groups will also be called.)
Thus, if more than one analysis routine should be triggered on the same trigger variable(s), they
must be scheduled in a single group. Routines from all timebins, other than <span 
class="cmtt-10">ANALYSIS</span>, are always
called.
</p><!--l. 1574--><p class="noindent" >Next, storage is assigned for any required variables, remembering the original state of storage.
</p><!--l. 1577--><p class="noindent" >The routine is then called, and on exit, any required grid variables are first synchronised. Following
synchronization, any required output methods are called for the triggers. Finally, the storage of grid variables is
returned to the original state.
</p><!--l. 1585--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.6   </span> <a 
 id="x1-82000C1.6"></a>Writing a Thorn</h3>
<!--l. 1589--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.6.1   </span> <a 
 id="x1-83000C1.6.1"></a>Thorn Programming Languages</h4>
<!--l. 1591--><p class="noindent" >When you start writing a new thorn, the first decision to make is which programming language to use. The
source code in Cactus thorns can be written in any mixture of C, C++, CUDA, or Fortran. The following points
should be considered when choosing a language to work in: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1598--><p class="noindent" >All functions designed for application thorn writers are available in all languages, however, some
     interfaces for infrastructure thorn writing are only available from C or C++.
</p>
     </li></ul>
<!--l. 1604--><p class="noindent" >Whatever language you choose, if you want your thorn to be portable, and compile and run on multiple
platforms, stick to the standards and don’t use machine dependent extensions.
</p><!--l. 1610--><p class="noindent" >
</p>
                                                                                       
                                                                                       
<h4 class="subsectionHead"><span class="titlemark">C1.6.2   </span> <a 
 id="x1-84000C1.6.2"></a>What the Flesh Provides</h4>
<!--l. 1612--><p class="noindent" >The flesh provides for thorns:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">Variables</span>         </dt><dd 
class="list">
                  <!--l. 1614--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Parameters</span>        </dt><dd 
class="list">
                  <!--l. 1615--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">Cactus Functions</span>  </dt><dd 
class="list">
                  <!--l. 1616--><p class="noindent" >
</p>
                      <ul class="itemize1">
                      <li class="itemize">
                      <!--l. 1619--><p class="noindent" > Driver (parallelisation) utilities
                      </p></li>
                      <li class="itemize">
                      <!--l. 1620--><p class="noindent" > I/O utilities
                      </p></li>
                      <li class="itemize">
                      <!--l. 1621--><p class="noindent" > Coordinates utilities
                      </p></li>
                      <li class="itemize">
                      <!--l. 1622--><p class="noindent" > Reduction utilities
                      </p></li>
                      <li class="itemize">
                      <!--l. 1623--><p class="noindent" > Interpolation utilities
                      </p></li>
                      <li class="itemize">
                      <!--l. 1624--><p class="noindent" > Information utilities</p></li></ul>
                  </dd></dl>
<!--l. 1629--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-85000"></a>Fortran Routines</h5>
<!--l. 1631--><p class="noindent" >Any source file using Cactus infrastructure should include the header file <span 
class="cmtt-10">cctk.h </span>using the line
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-24">
#include &#x0022;cctk.h&#x0022;
</pre>
<!--l. 1635--><p class="nopar" >(Fortran programmers should not be put off by this being a C style header file—most Cactus files are run
through a C preprocessor before compilation.)
</p>
<!--l. 1640--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-86000"></a><span 
class="cmbx-10">Variables</span></span>
Any routine using Cactus argument lists (for example, all routines called from the scheduler at
time bins between <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span></span> and <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN</span></span>) should include at the top of the file the
header
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-25">
#include &#x0022;cctk_Arguments.h&#x0022;
</pre>
<!--l. 1647--><p class="nopar" >
</p><!--l. 1649--><p class="noindent" >A Cactus macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ARGUMENTS </span>is defined for each thorn to contain: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1652--><p class="noindent" >General information about the grid hierarchy, for example, the number of grid points used. See
     Section <a 
href="#x1-98000doc">C1.6.2.0<!--tex4ht:ref: sec:cactus_variables_c --></a> for a complete list.
     </p></li>
     <li class="itemize">
     <!--l. 1655--><p class="noindent" >All the grid variables defined in the thorn’s <span 
class="cmtt-10">interface.ccl</span>
     </p></li>
     <li class="itemize">
     <!--l. 1656--><p class="noindent" >All the grid variables required from other thorns as requested by the <span 
class="cmtt-10">inherits </span>and <span 
class="cmtt-10">friend </span>lines in
     the <span 
class="cmtt-10">interface.ccl</span></p></li></ul>
<!--l. 1659--><p class="noindent" >These variables must be declared at the start of the routine using the macro <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_ARGUMENTS</span>.
Alternatively, they can be declared with <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_ARGUMENTS</span><span 
class="cmtt-10">_CHECKED(&#x003C;function name&#x003E;</span>), where
<span 
class="cmtt-10">&#x003C;function name&#x003E; </span>is the name of the function as declared in <span 
class="cmtt-10">schedule.ccl</span>. The function-name specific version
of the macro will declare only those variables identified by READS/WRITES directives in <span 
class="cmtt-10">schedule.ccl</span>, using
<span 
class="cmtt-10">const </span>for the C/C++ variables and <span 
class="cmtt-10">intent(in) </span>for the Fortran variables. (Note that, for technical reasons, in
Fortran variables declared in <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_ARGUMENTS </span>but not in the <span 
class="cmtt-10">READS/WRITES </span>directives
are actually declared as <span 
class="cmtt-10">intent(in), type(cctki</span><span 
class="cmtt-10">_inaccessible</span><span 
class="cmtt-10">_grid</span><span 
class="cmtt-10">_variable)</span>, and are thus
unusable.)
</p><!--l. 1672--><p class="noindent" >To pass the arguments to another routine in the same thorn use the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PASS</span><span 
class="cmtt-10">_FTOF </span>in the calling
routine, and again the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ARGUMENTS </span>in the receiving routine.
</p><!--l. 1676--><p class="noindent" >Note that you cannot use Cactus argument lists in routines scheduled at the <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span></span> and <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN</span></span>
time bins, because at this time no grid hierarchy exists.
</p>
<!--l. 1681--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-87000"></a><span 
class="cmbx-10">Parameters</span></span>
All parameters defined in a thorn’s <span 
class="cmtt-10">param.ccl </span>and all <span 
class="cmtt-10">global </span>parameters, appear as local variables of the
corresponding <span 
class="cmtt-10">CCTK </span>data type in Fortran source code, i.e. Booleans and Integers appear as <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>types (with
nonzero/zero values for boolean <span class="obeylines-h"><span 
class="cmtt-10">yes/no</span></span>), Reals as <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>, and Keywords and String parameters as
                                                                                       
                                                                                       
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STRING </span>(see also note below). These variables are <span 
class="cmti-10">read only</span>, and <span 
class="cmti-10">changes should not be made to them</span>. The
effect of changing a parameter is undefined (at best).
</p><!--l. 1692--><p class="noindent" >Any routine using Cactus parameters should include at the top of the file the header
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-26">
#include &#x0022;cctk_Parameters.h&#x0022;
</pre>
<!--l. 1696--><p class="nopar" >
</p><!--l. 1698--><p class="noindent" >The parameters should be declared at the start of the routine using them with the macro
<span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_PARAMETERS</span>.
</p><!--l. 1701--><p class="noindent" >In Fortran, special care should be taken with string valued parameters. These parameters are passed as C
pointers, and can not be treated as normal Fortran strings. To compare a string valued parameter and Fortran
string, use the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EQUALS() </span>or the function <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Equals() </span>(see the reference manual for a description
of the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ </span>functions). To print the value of a string valued parameter to screen, use the subroutine
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PrintString()</span>. A further function <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_FortranString </span>provides a mechanism for converting a string
parameter to a Fortran string. For example, if <span 
class="cmtt-10">operator </span>is a Cactus string parameter holding the name of a
reduction operator whose handle you need to find, you cannot pass it directly into the subroutine
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LocalArrayReductionHandle</span>, which is expecting a Fortran string. Instead, the following is
needed:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-27">
      character*200 fortran_operator
      CCTK_INT      fortran_operator_len
      integer       handle

      call CCTK_FortranString(fortran_operator_len,operator,fortran_operator)
      call CCTK_LocalArrayReductionHandle(handle,fortran_operator(1:fortran_operator_len))
</pre>
<!--l. 1721--><p class="nopar" >
</p>
<!--l. 1725--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-88000"></a><span 
class="cmbx-10">Fortran Example</span></span>
The Fortran routine, <span class="obeylines-h"><code class="verb">MyFRoutine</code></span>, is scheduled in the <span 
class="cmtt-10">schedule.ccl </span>file, doesn’t use Cactus parameters, and
calls another routine, in the same thorn, <span class="obeylines-h"><code class="verb">MyNewRoutine</code></span>, which does use parameters. This routine needs
to be passed an integer flag as well as the standard Cactus variables. The source file should look
like
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-28">
#include &#x0022;cctk.h&#x0022;
#include &#x0022;cctk_Arguments.h&#x0022;
#include &#x0022;cctk_Parameters.h&#x0022;

      subroutine MyFRoutine(CCTK_ARGUMENTS)

c     I’m very cautious, so I want to declare all variables
      implicit none

      DECLARE_CCTK_ARGUMENTS_CHECKED(MyFRoutine)
c Note: It is also possible to use
c     DECLARE_CCTK_ARGUMENTS
c However, this latter form will declare all variables
c available to the thorn and not simply those listed
c in the READS/WRITES clauses of the schedule.ccl declaration.
c
c Note: It is also possible to use all caps for the function
c name when writing in Fortran. Thus, the following also works:
c
c     DECLARE_CCTK_ARGUMENTS_CHECKED(MYFROUTINE)

      integer flag

      flag = 1
      call MyNewRoutine(CCTK_PASS_FTOF,flag)

      return
      end

      subroutine MyNewRoutine(CCTK_ARGUMENTS,flag)

      implicit none

      DECLARE_CCTK_ARGUMENTS_CHECKED(MyNewRoutine)
      DECLARE_CCTK_PARAMETERS
      integer flag

c     Main code goes here

      return
      end

</pre>
<!--l. 1776--><p class="nopar" >
                                                                                       
                                                                                       
</p>
<!--l. 1778--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-89000"></a><span 
class="cmbx-10">Cactus Fortran Functions</span></span>
Cactus Fortran functions, for example, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_MyProc </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Equals</span>, can all be declared by adding the
statement
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-29">
#include &#x0022;cctk_Functions.h&#x0022;
</pre>
<!--l. 1785--><p class="nopar" >near the top of the file, and adding the declaration
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-30">
DECLARE_CCTK_FUNCTIONS
</pre>
<!--l. 1791--><p class="nopar" >to a module or a subroutine after the <span 
class="cmtt-10">implicit none </span>statement, but before any executable code.
</p>
<!--l. 1796--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-90000"></a><span 
class="cmbx-10">Fortran Modules</span></span>
<a 
 id="x1-90000doc"></a>
Fortran modules should be placed into source files that have the same name as the module, followed by the
corresponding file name suffix. A module <span 
class="cmtt-10">metric </span>should thus be placed, e.g. into a file <span 
class="cmtt-10">metric.F90</span>. This
convention allows the Cactus build system to automatically deduce the compile time dependencies.
</p><!--l. 1805--><p class="noindent" >If you do not follow this convention, then you have to include the modules into the thorn’s <span 
class="cmtt-10">make.code.deps </span>file
(Section <a 
href="#x1-56000doc">C1.2.5.0<!--tex4ht:ref: sec:mabathbu --></a>) to ensure they are compiled before the routines which use them. This is especially important
for parallel building. For example, if a routine in <span 
class="cmtt-10">MyRoutine.F90 </span>uses a module in <span 
class="cmtt-10">MyModule.F90</span>, then add the
line:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-31">
MyRoutine.F90.o:         MyModule.F90.o
</pre>
<!--l. 1814--><p class="nopar" >
</p>
<!--l. 1816--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-91000"></a><span 
class="cmbx-10">The </span><span 
class="cmtt-10">MOD </span><span 
class="cmbx-10">function</span></span>
The intrinsic function <span 
class="cmtt-10">MOD </span>in Fortran takes two integer arguments, which should both be of the same type. This
means that it may be necessary to cast the arguments to, e.g. <span 
class="cmtt-10">INT </span>for some architectures. This can occur in
particular when a <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>parameter and the Cactus variable <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_iteration </span>(which is declared to be
<span 
class="cmtt-10">INTEGER</span>) are used, in which case the correct code is
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-32">
MOD(cctk_iteration,INT(MyParameter))
</pre>
<!--l. 1827--><p class="nopar" >
</p><!--l. 1830--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-92000"></a>C Routines</h5>
<!--l. 1832--><p class="noindent" >Any source file using Cactus infrastructure should include the header file <span 
class="cmtt-10">cctk.h </span>using the line
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-33">
#include &#x0022;cctk.h&#x0022;
</pre>
<!--l. 1836--><p class="nopar" >
</p>
<!--l. 1838--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-93000"></a><span 
class="cmbx-10">Variables</span></span>
Any routine using Cactus argument lists (for example, all routines called from the scheduler at
time bins between <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span></span> and <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN</span></span>), should include at the top of the file the
header
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-34">
#include &#x0022;cctk_Arguments.h&#x0022;
</pre>
<!--l. 1845--><p class="nopar" >
</p><!--l. 1847--><p class="noindent" >A Cactus macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ARGUMENTS </span>is defined for each thorn to contain </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1850--><p class="noindent" >General  information  about  the  grid  hierarchy,  for  example,  the  number  of  grid  points  on  the
     processor. See Section <a 
href="#x1-98000doc">C1.6.2.0<!--tex4ht:ref: sec:cactus_variables_c --></a> for a complete list.
     </p></li>
     <li class="itemize">
     <!--l. 1853--><p class="noindent" >All the grid variables defined in the thorn’s <span 
class="cmtt-10">interface.ccl</span>
     </p></li>
     <li class="itemize">
     <!--l. 1854--><p class="noindent" >All the grid variables required from other thorns as requested by the <span 
class="cmtt-10">inherits </span>and <span 
class="cmtt-10">friend </span>lines in
     the <span 
class="cmtt-10">interface.ccl</span></p></li></ul>
<!--l. 1857--><p class="noindent" >These variables must be declared at the start of the routine using the macro <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_ARGUMENTS</span>. This
macro should always be the first line of the routine.
</p><!--l. 1861--><p class="noindent" >To pass the arguments to another routine in the same thorn, use the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PASS</span><span 
class="cmtt-10">_CTOC </span>in the calling
routine, and again the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ARGUMENTS </span>in the receiving routine.
</p><!--l. 1865--><p class="noindent" >Note that you cannot use Cactus argument lists in routines scheduled at the <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span></span> and <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN</span></span>
time bins, because at this time no grid hierarchy exists.
</p>
<!--l. 1870--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-94000"></a><span 
class="cmbx-10">Parameters</span></span>
All parameters defined in a thorn’s <span 
class="cmtt-10">param.ccl </span>and all <span 
class="cmtt-10">global </span>parameters, appear as local variables of the
corresponding <span 
class="cmtt-10">CCTK </span>data type in C source code, i.e. Integers and Booleans appear as <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>types (with
nonzero/zero values for boolean <span class="obeylines-h"><span 
class="cmtt-10">yes/no</span></span>), Reals as <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>, and Keywords and String parameters as
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STRING</span>. These variables are <span 
class="cmti-10">read only</span>, and <span 
class="cmti-10">changes should not be made to them</span>. The effect of changing a
parameter is undefined (at best).
</p><!--l. 1880--><p class="noindent" >Any routine using Cactus parameters should include at the top of the file the header
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-35">
#include &#x0022;cctk_Parameters.h&#x0022;
</pre>
<!--l. 1884--><p class="nopar" >
</p><!--l. 1886--><p class="noindent" >The parameters should be declared as the last statement in the declaration part of the routine using them with
the macro <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_PARAMETERS</span>.
</p>
<!--l. 1889--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-95000"></a><span 
class="cmbx-10">Example</span></span>
The C routine <span class="obeylines-h"><code class="verb">MyCRoutine</code></span> is scheduled in the <span 
class="cmtt-10">schedule.ccl </span>file, and uses Cactus parameters. The source file
should look like
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-36">
#include &#x0022;cctk.h&#x0022;
#include &#x0022;cctk_Arguments.h&#x0022;
#include &#x0022;cctk_Parameters.h&#x0022;

void MyCRoutine(CCTK_ARGUMENTS)
{
  DECLARE_CCTK_ARGUMENTS_CHECKED(MyCRoutine)
  DECLARE_CCTK_PARAMETERS

  /* Here goes your code */
}
</pre>
<!--l. 1905--><p class="nopar" >
</p>
<!--l. 1907--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-96000"></a><span 
class="cmbx-10">Complex variables</span></span>
Cactus supports complex grid variables of type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX </span>which are realized through the types <span 
class="cmtt-10">complex</span>,
<span 
class="cmtt-10">std::complex </span>and <span 
class="cmtt-10">COMPLEX </span>in C, C++ and Fortran respectively. Complex number support is available in C in
the C99 language standard which Cactus requires.
</p><!--l. 1914--><p class="noindent" >There is a known incompatibility when <span 
class="cmti-10">returning </span>complex numbers from C and Fortran functions to C++
callers on some architectures. Access to variables through pointers and in arrays is not affected. A
workaround is not to return values but instead pass in a pointer to a local variable to hold the return
value.
</p>
<!--l. 1920--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-97000"></a><span 
class="cmbx-10">Specifically for C Programmers</span></span>
Grid functions are held in memory as 1-dimensional C arrays. These are laid out in memory as in Fortran. This
means that the first index should be incremented through most rapidly. This is illustrated in the example
below.
</p><!--l. 1927--><p class="noindent" >Cactus provides macros to find the 1-dimensional index which is needed from the multidimensional indices which
are usually used. There is a macro for each dimension of grid function. Below is an artificial example to
demonstrate this using the 3D macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_GFINDEX3D</span>:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-37">
for (k=0; k&#x003C;cctk_lsh[2]; k++)
{
  for (j=0; j&#x003C;cctk_lsh[1]; j++)
  {
    for (i=0; i&#x003C;cctk_lsh[0]; i++)
    {
      int const ind3d = CCTK_GFINDEX3D(cctkGH,i,j,k);
      rho[ind3d] = exp(-pow(r[ind3d],2));
    }
  }
}
</pre>
<!--l. 1944--><p class="nopar" >Here, <span class="obeylines-h"><code class="verb">CCTK_GFINDEX3D(cctkGH,i,j,k)</code></span> expands to
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-38">
((i) + cctkGH-&#x003E;cctk_lsh[0]*((j)+cctkGH-&#x003E;cctk_lsh[1]*(k)))
</pre>
<!--l. 1949--><p class="nopar" >Note: In Fortran, grid functions are accessed as Fortran arrays, i.e. simply as <span class="obeylines-h"><code class="verb">rho(i,j,k)</code></span>.
</p><!--l. 1954--><p class="noindent" >To access vector grid functions (vector grid functions are a “vector” of grid functions; see section <a 
href="#x1-184000D2.2.4">D2.2.4<!--tex4ht:ref: subsec:Appendix.interface-variables --></a>), one
also needs to specify the vector index. This is best done via the 3D macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VECTGFINDEX3D</span>:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-39">
for (k=0; k&#x003C;cctk_lsh[2]; k++)
{
  for (j=0; j&#x003C;cctk_lsh[1]; j++)
  {
    for (i=0; i&#x003C;cctk_lsh[0]; i++)
    {
      /* vector indices are 0, 1, 2 */
      vel[CCTK_VECTGFINDEX3D(cctkGH,i,j,k,0)] = 1.0;
      vel[CCTK_VECTGFINDEX3D(cctkGH,i,j,k,1)] = 0.0;
      vel[CCTK_VECTGFINDEX3D(cctkGH,i,j,k,2)] = 0.0;
    }
  }
}
</pre>
<!--l. 1973--><p class="nopar" >
</p><!--l. 1975--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-98000"></a>Cactus Variables</h5>
<a 
 id="x1-98000doc"></a>
<!--l. 1978--><p class="noindent" >The Cactus variables which are passed through the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ARGUMENTS </span>are
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">cctkGH</span>            </dt><dd 
class="list">
                  <!--l. 1981--><p class="noindent" >A C pointer identifying the grid hierarchy.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim</span>          </dt><dd 
class="list">
                  <!--l. 1982--><p class="noindent" >An integer with the number of dimensions used for this grid hierarchy.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_lsh</span>          </dt><dd 
class="list">
                  <!--l. 1984--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers with the local grid size on this processor.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_ash</span>          </dt><dd 
class="list">
                  <!--l. 1986--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers with the allocated size of the array. This may be
                  larger than the local size; the additional points may not be used.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_gsh</span>          </dt><dd 
class="list">
                  <!--l. 1989--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers with the <span 
class="cmti-10">global </span>grid size.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_iteration</span>    </dt><dd 
class="list">
                  <!--l. 1991--><p class="noindent" >The current iteration number.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_delta</span><span 
class="cmtt-10">_time</span>   </dt><dd 
class="list">
                  <!--l. 1992--><p class="noindent" >A <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL </span>with the timestep.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_time</span>         </dt><dd 
class="list">
                  <!--l. 1993--><p class="noindent" >A <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL </span>with the current time.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_delta</span><span 
class="cmtt-10">_space</span>  </dt><dd 
class="list">
                  <!--l. 1994--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim CCTK</span><span 
class="cmtt-10">_REAL</span>s with the grid spacing in each direction.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_nghostzones</span>  </dt><dd 
class="list">
                  <!--l. 1996--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers with the number of ghostzones used in each direction.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_origin</span><span 
class="cmtt-10">_space</span> </dt><dd 
class="list">
                  <!--l. 2000--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim CCTK</span><span 
class="cmtt-10">_REAL</span>s with the spatial coordinates of the global origin
                  of the grid.
</p>
                  </dd></dl>
<!--l. 2006--><p class="noindent" >The following variables describe the location of the local grid (e.g. the grid treated on a given processor) within
the global grid.
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_level</span>        </dt><dd 
class="list">
                  <!--l. 2010--><p class="noindent" >The current refinement level, counting from \(0\) for the base level.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_lbnd</span>         </dt><dd 
class="list">
                  <!--l. 2012--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers containing the lowest index (in each direction) of
                  the local grid, as seen on the global grid. Note that these indices start from zero,
                  so you need to add one when using them in Fortran thorns.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_ubnd</span>         </dt><dd 
class="list">
                  <!--l. 2018--><p class="noindent" >An array of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers containing the largest index (in each direction) of
                  the local grid, as seen on the global grid. Note that these indices start from zero,
                  so you need to add one when using them in Fortran thorns.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_bbox</span>         </dt><dd 
class="list">
                  <!--l. 2024--><p class="noindent" >An  array  of  2\(*\)<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers  (in  the  order  \([\mbox {dim}_0^{\mbox {min}}, \mbox {dim}_0^{\mbox {max}}, \mbox {dim}_1^{\mbox {min}}, \mbox {dim}_1^{\mbox {max}}, \ldots ]\)),  which  indicate  whether
                  the  boundaries  are  internal  boundaries  (e.g. between  processors),  or  physical
                  boundaries. A value of 1 indicates a physical (outer) boundary at the edge of the
                  computational grid, and 0 indicates an internal boundary.</p></dd></dl>
<!--l. 2035--><p class="noindent" >The following variable is needed for grid refinement methods
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levfac</span>       </dt><dd 
class="list">
                  <!--l. 2037--><p class="noindent" >An array of  <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integer factors by which the local grid is refined in the
                  corresponding direction with respect to the base grid.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_level</span>        </dt><dd 
class="list">
                  <!--l. 2040--><p class="noindent" >An integer number of the refinement level, with the base level is level \(0\) and larger
                  number indicating refined levels.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levoff</span>       </dt><dd 
class="list">
                  <!--l. 2043--><p class="noindent" >and <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levoffdenom </span>Two arrays of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_dim </span>integers describing the distance
                  by which the local grid is offset with respect to the base grid, measured in local
                  grid spacings. The distance in direction <span 
class="cmtt-10">dir </span>is given by <span 
class="cmtt-10">1.0 * cctk</span><span 
class="cmtt-10">_levoff[dir]</span>
                  <span 
class="cmtt-10">/ cctk</span><span 
class="cmtt-10">_levoffdenom[dir]</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_timefac</span>      </dt><dd 
class="list">
                  <!--l. 2049--><p class="noindent" >The integer factor by which the time step size is reduced with respect to the base
                  grid.</p></dd></dl>
<!--l. 2054--><p class="noindent" >The following variables are used for identifying convergence levels.
</p><!--l. 2056--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_convlevel</span>    </dt><dd 
class="list">
                  <!--l. 2057--><p class="noindent" >The convergence level of this grid hierarchy. The base level is \(0\), and every level above
                  that is coarsened by a factor of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_convfac</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_convfac</span>      </dt><dd 
class="list">
                  <!--l. 2060--><p class="noindent" >The factor between convergence levels. The relation between the resolutions of
                  different  convergence  levels  is  \(\Delta x_L = \Delta x_0 \cdot F^L\),  where  \(L\)  is  the  convergence  level  and  \(F\)  is  the
                  convergence factor. The convergence factor defaults to \(2\).</p></dd></dl>
<!--l. 2067--><p class="noindent" >The following variables are used for identifying the coordinate patch in a multipatch/multiblock
simulation.
</p><!--l. 2070--><p class="noindent" >
                                                                                       
                                                                                       
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_patch</span>        </dt><dd 
class="list">
                  <!--l. 2071--><p class="noindent" >An integer with the multipatch patch number on this processor.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_npatches</span>     </dt><dd 
class="list">
                  <!--l. 2073--><p class="noindent" >An integer with the total number of multipatch patches on all processors.</p></dd></dl>
<!--l. 2077--><p class="noindent" >The variables <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_delta</span><span 
class="cmtt-10">_space</span>, <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_delta</span><span 
class="cmtt-10">_time</span>, and <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_origin</span><span 
class="cmtt-10">_space </span>denote the grid spacings, time
step size, and spatial origin on the <span 
class="cmti-10">base </span>grid. If you are using a grid refinement method, you need to
calculate these quantities on the grid you are on. There are Cactus macros provided for this, with the
syntax <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DELTA</span><span 
class="cmtt-10">_SPACE(dir)</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ORIGIN</span><span 
class="cmtt-10">_SPACE(dir)</span>, and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DELTA</span><span 
class="cmtt-10">_TIME </span>for both C and
Fortran. It is recommended that these macros are always used to provide the grid spacings, time step
sizes, and spatial origins in your thorns. In doing so, you incorporate the effects of <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levfac</span>,
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levoff</span>, <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levoffdenom</span>, and <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_timefac</span>, so that you do not explicitly have to take them into
account.
</p><!--l. 2090--><p class="noindent" >Putting the above information together, Figure <a 
href="#x1-980013">C1.3<!--tex4ht:ref: fig-global-xyz-coords --></a> shows two different ways to compute the global Cactus \(xyz\)
coordinates of the current grid point. Because the “alternate calculation” (the one using <span class="obeylines-h"><code class="verb">Grid::x</code></span>, <span class="obeylines-h"><code class="verb">Grid::y</code></span>, and
<span class="obeylines-h"><code class="verb">Grid::z</code></span>) gives the true global \(xyz\) coordinates even in a multipatch/multiblock context, this is generally the
preferred form for general use.
</p>
<hr class="figure" /><div class="figure" 
>
                                                                                       
                                                                                       
<a 
 id="x1-980013"></a>
                                                                                       
                                                                                       
<pre class="verbatim" id="verbatim-40">
#include &#x003C;stddef.h&#x003E;                     /* defines size_t */
#include &#x0022;cctk.h&#x0022;

void MyThorn_MyFunction(CCTK_ARGUMENTS)
{
int i,j,k;

    for (k = 0 ; k &#x003C; cctk_lsh[2] ; ++k)
    {
    for (j = 0 ; j &#x003C; cctk_lsh[1] ; ++j)
    {
    for (i = 0 ; i &#x003C; cctk_lsh[0] ; ++i)
    {
    const size_t posn = CCTK_GFINDEX3D(cctkGH, i,j,k);

    /* calculate the global xyz coordinates of the (i,j,k) grid point */
    /* (in a multipatch/multiblock context, this gives the per-patch coordinates) */
    const CCTK_REAL xcoord = CCTK_ORIGIN_SPACE(0) + (cctk_lbnd[0] + i)*CCTK_DELTA_SPACE(0);
    const CCTK_REAL ycoord = CCTK_ORIGIN_SPACE(1) + (cctk_lbnd[1] + j)*CCTK_DELTA_SPACE(1);
    const CCTK_REAL zcoord = CCTK_ORIGIN_SPACE(2) + (cctk_lbnd[2] + k)*CCTK_DELTA_SPACE(2);

    /* an alternate calculation, which requires that this thorn inherit from  Grid */
    /* (in a multipatch/multiblock context, this gives the true global xyz coordinates) */
    const CCTK_REAL xxcoord = /* Grid:: */ x[posn];
    const CCTK_REAL yycoord = /* Grid:: */ y[posn];
    const CCTK_REAL zzcoord = /* Grid:: */ z[posn];
    }
    }
    }
}
</pre>
<!--l. 2129--><p class="nopar" >
<br /> </p><div class="caption" 
><span class="id">Figure C1.3: </span><span  
class="content">This figure shows two different ways to compute the global Cactus \(xyz\) coordinates of the
current  grid  point.  Because  the  “alternate  calculation”  (the  one  one  using  <span 
class="cmtt-10">Grid::x</span>,  <span 
class="cmtt-10">Grid::y</span>,  and
<span 
class="cmtt-10">Grid::z</span>) gives the true global \(xyz\) coordinates even in a multipatch/multiblock context, this is generally the
preferred form for general use. </span></div><!--tex4ht:label?: x1-980013 -->
                                                                                       
                                                                                       
</div><hr class="endfigure" />
<h5 class="subsubsectionHead"><a 
 id="x1-99000"></a>Cactus Data Types</h5>
<!--l. 2143--><p class="noindent" >To provide portability across platforms, the Cactus grid variables and parameters are defined and declared using
Cactus data types. The most important of these data types are described below, for a full description see
Section <a 
href="#x1-142000C1.9.8">C1.9.8<!--tex4ht:ref: sec:datyansi --></a>. These data types should be used to declare local variables where needed, and to declare Cactus
grid variables or parameters that need declarations.
</p><!--l. 2151--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>          </dt><dd 
class="list">
                  <!--l. 2153--><p class="noindent" >default size 4 bytes
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>         </dt><dd 
class="list">
                  <!--l. 2154--><p class="noindent" >default size 8 bytes
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span>      </dt><dd 
class="list">
                  <!--l. 2155--><p class="noindent" >consists of two <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL </span>elements
</p>
                  </dd></dl>
<!--l. 2159--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-100000"></a><span 
class="cmbx-10">Example</span></span>
In the following example, <span class="obeylines-h"><code class="verb">MyScalar</code></span> is a grid scalar which is declared in the <span 
class="cmtt-10">interface.ccl </span>as
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-41">
      subroutine InitialData(CCTK_ARGUMENTS)

      DECLARE_CCTK_ARGUMENTS

      CCTK_REAL local_var

      local_var = 1.0/3.0
      MyScalar = local_var

      return
      end
</pre>
<!--l. 2176--><p class="nopar" >Declaring <span 
class="cmtt-10">local</span><span 
class="cmtt-10">_var </span>to have a non-Cactus data type, e.g. <span 
class="cmtt-10">REAL*4</span>, or using one of the other Cactus real data
types described in Section <a 
href="#x1-142000C1.9.8">C1.9.8<!--tex4ht:ref: sec:datyansi --></a>, could give problems for different architectures or configurations.
</p><!--l. 2185--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.6.3   </span> <a 
 id="x1-101000C1.6.3"></a>Parallelisation</h4>
<!--l. 2188--><p class="noindent" >The flesh itself does not actually set up grid variables. This is done by a <span 
class="cmti-10">driver </span>thorn. To allow the distribution
of a grid over a number of processors, the driver thorn must also provide the grid decomposition, and
routines to enable parallelisation. The method used to provide this parallelisation (e.g. MPI, PVM)
is not usually important for the thorn writer, since the driver thorn provides routines which are
called by standard interfaces from the flesh. Here, we describe briefly the most important of these
routines for the application thorn writer. A more detailed description of these interfaces with their
arguments, is given in the Reference Manual. A complete description of the routines that a driver
thorn must provide, will be provided in the Infrastructure Thorn Writers Guide (Part <a 
href="#x1-149000C2">C2<!--tex4ht:ref: chap:infrastructure --></a>). The
standard driver thorn is currently <span 
class="cmtt-10">PUGH </span>in the <span 
class="cmtt-10">CactusPUGH </span>package, which is a parallel unigrid
driver.
</p><!--l. 2204--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_nProcs</span>       </dt><dd 
class="list">
                  <!--l. 2205--><p class="noindent" >Returns the number of processors being used
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_MyProc</span>       </dt><dd 
class="list">
                  <!--l. 2206--><p class="noindent" >Returns the processor number (this starts at processor number zero)
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroup, CCTK</span><span 
class="cmtt-10">_SyncGroupsI</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2208--><p class="noindent" >Synchronises either a single group or a set of groups of grid arrays by exchanging the
                  values held in each processor ghostzones, with the physical values of their neighbours
                  (see the Reference Manual)
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Barrier</span>      </dt><dd 
class="list">
                  <!--l. 2212--><p class="noindent" >Waits for all processors to reach this point before proceeding</p></dd></dl>
<!--l. 2219--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.7   </span> <a 
 id="x1-102000C1.7"></a>Cactus Application Interfaces</h3>
<!--l. 2223--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.7.1   </span> <a 
 id="x1-103000C1.7.1"></a>Iterating Over Grid Points</h4>
<!--l. 2226--><p class="noindent" >A grid function consists of a multi-dimensional array of grid points. These grid points fall into several
types:
     </p><dl class="description"><dt class="description">
<span 
class="cmbx-10">interior</span> </dt><dd 
class="description">
     <!--l. 2229--><p class="noindent" >regular grid point, presumably evolved in time
     </p></dd><dt class="description">
<span 
class="cmbx-10">ghost</span> </dt><dd 
class="description">
     <!--l. 2230--><p class="noindent" >inter-process boundary, containing copies of values owned by another process
     </p></dd><dt class="description">
<span 
class="cmbx-10">physical boundary</span> </dt><dd 
class="description">
     <!--l. 2232--><p class="noindent" >outer boundary, presumably defined via a boundary condition
     </p></dd><dt class="description">
<span 
class="cmbx-10">symmetry boundary</span> </dt><dd 
class="description">
     <!--l. 2234--><p class="noindent" >defined via a symmetry, e.g. a reflection symmetry or periodicity</p></dd></dl>
<!--l. 2237--><p class="noindent" >Grid points in the edges and corners may combine several types. For example, a point in a corner may be a ghost
point in the \(x\) direction, a physical boundary point in the \(y\) direction, and a symmetry point in the \(z\)
direction.
                                                                                       
                                                                                       
</p><!--l. 2242--><p class="noindent" >The size of the physical boundary depends on the application. The number of ghost points is defined by
the driver; the number of symmetry points is in principle defined by the thorn implementing the
respective symmetry condition, but will in general be the same as the number of ghost points to avoid
inconsistencies.
</p><!--l. 2248--><p class="noindent" >When iterating over grid points, one usually needs to know about the boundary sizes and boundary types
present. Details about this is explained in thorn CactusBase/CoordBase.
</p><!--l. 2252--><p class="noindent" >The flesh provides a set of macros to iterate over particular types of grid points:
     </p><dl class="description"><dt class="description">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP</span><span 
class="cmtt-10">_ALL</span> </dt><dd 
class="description">
     <!--l. 2255--><p class="noindent" >Loop over all grid points
     </p></dd><dt class="description">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP</span><span 
class="cmtt-10">_INT</span> </dt><dd 
class="description">
     <!--l. 2256--><p class="noindent" >Loop over all interior grid points
     </p></dd><dt class="description">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP</span><span 
class="cmtt-10">_BND</span> </dt><dd 
class="description">
     <!--l. 2257--><p class="noindent" >Loop over all physical boundary points
     </p></dd><dt class="description">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP</span><span 
class="cmtt-10">_INTBND</span> </dt><dd 
class="description">
     <!--l. 2258--><p class="noindent" >Loop over all “interior” physical boundary points, i.e. over all those physical boundary points that
     are not also ghost or symmetry points</p></dd></dl>
<!--l. 2263--><p class="noindent" >As described above, points on edges and corners can have several boundary types at once, e.g. can be both a
physical and a symmetry point. <span 
class="cmtt-10">LOOP</span><span 
class="cmtt-10">_BND </span>and <span 
class="cmtt-10">LOOP</span><span 
class="cmtt-10">_INTBND </span>treat these different: <span 
class="cmtt-10">LOOP</span><span 
class="cmtt-10">_BND </span>loops over all points
that are physical boundaries (independent of whether they also are symmetry or ghost boundaries), while
<span 
class="cmtt-10">LOOP</span><span 
class="cmtt-10">_INTBND </span>loops over those points that are only physical boundaries (and excludes any points
that belongs to a symmetry or ghost boundary). <span 
class="cmtt-10">LOOP</span><span 
class="cmtt-10">_BND </span>does not require applying a symmetry
condition or synchronisation afterwards (but does not allow taking tangential derivatives); <span 
class="cmtt-10">LOOP</span><span 
class="cmtt-10">_INTBND</span>
allows taking tangential derivatives (but requires applying symmetry boundaries and synchronising
afterwards).
</p><!--l. 2276--><p class="noindent" >In 3 dimensions, these macros should be called as follows:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-42">
CCTK_LOOP3_ALL(name, cctkGH, i,j,k) {
  ... body of the loop
} CCTK_ENDLOOP3_ALL(name);
</pre>
<!--l. 2281--><p class="nopar" >
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-43">
CCTK_LOOP3_INT(name, cctkGH, i,j,k) {
  ... body of the loop
} CCTK_ENDLOOP3_INT(name);
</pre>
<!--l. 2287--><p class="nopar" >
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-44">
CCTK_LOOP3_BND(name, cctkGH, i,j,k, ni,nj,nk) {
  ... body of the loop
} CCTK_ENDLOOP3_BND(name);
</pre>
<!--l. 2293--><p class="nopar" >
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-45">
CCTK_LOOP3_INTBND(name, cctkGH, i,j,k, ni,nj,nk) {
  ... body of the loop
} CCTK_ENDLOOP3_INTBND(name);
</pre>
<!--l. 2299--><p class="nopar" >and similarly for 2 dimensions and 1 dimension.
</p><!--l. 2302--><p class="noindent" >In all cases, <span 
class="cmtt-10">name </span>should be replaced by a unique name for the loop. <span 
class="cmtt-10">i</span>, <span 
class="cmtt-10">j</span>, and <span 
class="cmtt-10">k </span>are names of variables that will
be declared and defined by these macros, containing the index of the current grid point. Similarly <span 
class="cmtt-10">ni</span>, <span 
class="cmtt-10">nj</span>, and <span 
class="cmtt-10">nk</span>
are names of variables describing the (outwards pointing) normal direction to the boundary as well as the
distance to the boundary.
</p>
<!--l. 2310--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-104000"></a><span 
class="cmtt-10">OpenMP</span></span>
All <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP </span>macros include support for <span 
class="cmtt-10">OpenMP </span>based multi-threading when called inside of an <span 
class="cmtt-10">OpenMP </span>parallel
section. They do no themselves create such a parallel section and therefore should be preceded by a <span 
class="cmtt-10">#pragma</span>
<span 
class="cmtt-10">omp parallel</span>:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-46">
#pragma omp parallel
CCTK_LOOP3_ALL(name, cctkGH, i,j,k) {
  ... body of the loop
} CCTK_ENDLOOP3_ALL(name);
</pre>
<!--l. 2319--><p class="nopar" >and similar for <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP3</span><span 
class="cmtt-10">_INT</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP3</span><span 
class="cmtt-10">_BND</span>, and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_LOOP3</span><span 
class="cmtt-10">_INTBND</span>.
</p><!--l. 2323--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.7.2   </span> <a 
 id="x1-105000C1.7.2"></a>Coordinates</h4>
<!--l. 2326--><p class="noindent" >The flesh provides utility routines for registering and querying coordinate information. The flesh does not
provide any coordinates itself, these must be supplied by a thorn. Thorns are not required to register coordinates
to the flesh, but registering coordinates provides a means for infrastructure thorns to make use of coordinate
information.
</p><!--l. 2333--><p class="noindent" >Coordinates are grouped into <span 
class="cmti-10">coordinate systems</span>, which have a specified dimension. Any number of coordinate
systems can be registered with the flesh, and a coordinate system must be registered before any coordinates
can be registered, since they must be associated with their corresponding system. Coordinates
can be registered, with any chosen name, with an existing coordinate system, along with their
direction or index in the coordinate system. Optionally, the coordinate can also be associated with a
given grid variable. A separate call can register the global range for a coordinate on a given grid
hierarchy.
</p><!--l. 2344--><p class="noindent" >Following conventions for coordinate system and coordinate names, provides a means for other thorns to use the
physical properties of coordinate systems, without being tied to a particular thorn.
</p><!--l. 2348--><p class="noindent" >A registered coordinate system can be referred to by either its name or an associated integer known as a
<span 
class="cmti-10">handle</span>. Passing a handle instead of the name string may be necessary for calling C routines from
Fortran.
</p><!--l. 2353--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-106000"></a>Registering Coordinates and Coordinate Properties</h5>
<!--l. 2358--><p class="noindent" ><span 
class="cmbx-10">The APIs described in this section are deprecated, and will probably be phased out fairly soon.</span>
<span 
class="cmbx-10">New code should use the APIs provided by the </span><span 
class="cmtt-10">CoordBase </span><span 
class="cmbx-10">thorn instead (this lives in the</span>
<span 
class="cmtt-10">CactusBase </span><span 
class="cmbx-10">arrangement).</span>
                                                                                       
                                                                                       
</p><!--l. 2360--><p class="noindent" >Coordinate systems and their properties can be registered at any time with the flesh. The registration utilities
for thorns providing coordinates are:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordRegisterSystem</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2364--><p class="noindent" >
                  </p><!--l. 2366--><p class="noindent" >Assigns a coordinate system with a chosen name and dimension. For example, a
                  3-dimensional Cartesian coordinate system could be registered with the name <span 
class="cmtt-10">cart3d </span>using
                  the call from C
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-47">
                  int ierr;
                  int dim=3;
                  ierr = CCTK_CoordRegisterSystem(dim,&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2374--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordRegisterData</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2376--><p class="noindent" >
                  </p><!--l. 2378--><p class="noindent" >Defines a coordinate in a given coordinate system, with a given direction and name, and
                  optionally associates it to a grid variable. The directions of the coordinates range
                  from 1 to the dimension of the coordinate system. For example, to register
                  the grid variable <span 
class="cmtt-10">grid::y3d </span>to have the coordinate name <span 
class="cmtt-10">y </span>in the <span 
class="cmtt-10">cart3d</span>
                  system
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-48">
                  int ierr;
                  int dir=2;
                  ierr = CCTK_CoordRegisterData(dir,&#x0022;grid::y3d&#x0022;,&#x0022;y&#x0022;,&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2388--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordRegisterRange</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2390--><p class="noindent" >
                  </p><!--l. 2392--><p class="noindent" >Assigns the global computational maximum and minimum for a coordinate on a grid
                  hierarchy, that is in a <span 
class="cmtt-10">cctkGH</span>. At this time the maximum and minimum values have to be
                  of type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>. For example, if the <span 
class="cmtt-10">y </span>coordinate for the <span 
class="cmtt-10">cart3d </span>system ranges between
                  zero and one
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-49">
                  CCTK_REAL lower=0;
                  CCTK_REAL upper=1;
                  int ierr;
                  ierr = CCTK_CoordRegisterRange(cctkGH, lower, upper, -1, &#x0022;y&#x0022;, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2403--><p class="nopar" >Note that the API allows either the coordinate name or the direction to be used, so that
                  the following is also valid
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-50">
                  CCTK_REAL lower=0;
                  CCTK_REAL upper=1;
                  int ierr;
                  ierr = CCTK_CoordRegisterRange(cctkGH, lower, upper, 2, NULL, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2413--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordRegisterPhysIndex</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2415--><p class="noindent" >
                  </p><!--l. 2417--><p class="noindent" >Implementing such things as symmetry properties for a grid leads to the need to know the
                  details of the <span 
class="cmti-10">physical </span>section of a grid. Such information is typically needed
                  by I/O thorns. The following call illustrates how to register the indices 3
                  and 25 as supplying the physical range of the <span 
class="cmtt-10">y </span>coordinate in the <span 
class="cmtt-10">cart3d</span>
                  system
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-51">
                  int loweri=3;
                  int upperi=25;
                  int ierr;
                  ierr = CCTK_CoordRegisterPhysIndex(cctkGH, loweri, upperi, -1, &#x0022;y&#x0022;, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2429--><p class="nopar" >
</p>
                  </dd></dl>
<!--l. 2435--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-107000"></a>Using Coordinates</h5>
<!--l. 2440--><p class="noindent" ><span 
class="cmbx-10">The APIs described in this section are deprecated, and will probably be phased out fairly soon.</span>
<span 
class="cmbx-10">New code should use the APIs provided by the </span><span 
class="cmtt-10">CoordBase </span><span 
class="cmbx-10">thorn instead (this lives in the</span>
<span 
class="cmtt-10">CactusBase </span><span 
class="cmbx-10">arrangement).</span>
</p><!--l. 2442--><p class="noindent" >The utilities for thorns using coordinates are:
</p><!--l. 2444--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_NumCoordSystems</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2446--><p class="noindent" >
                  </p><!--l. 2448--><p class="noindent" >Returns the number of coordinate systems registered with the flesh. For example,
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-52">
                  int num;
                  num = CCTK_NumCoordSystems();
</pre>
                  <!--l. 2453--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordSystemName</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2455--><p class="noindent" >
                  </p><!--l. 2457--><p class="noindent" >Provides the name of a registered coordinate system, given the integer handle (or index)
                  for the system in the flesh’s coordinate data base. Note that the handle ranges between
                  zero and the number of coordinate systems minus one: \(0 \le \mbox {handle} \le \mbox {\texttt {CCTK\_NumCoordSystems()}}-1\). It is important to
                  remember that the handle given to a coordinate system depends on the order in
                  which systems are registered, and can be different from one simulation to the
                  next.
                  </p><!--l. 2464--><p class="noindent" >For example, to print the names of all registered coordinate systems:
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-53">
                  for (i=0; i&#x003C;CCTK_NumCoordSystems(); i++)
                      printf(&#x0022;%s &#x0022;,CCTK_CoordSystemNName(i));
</pre>
                  <!--l. 2469--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordSystemDim</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2471--><p class="noindent" >
                  </p><!--l. 2473--><p class="noindent" >Provides the dimension of a coordinate system. For example, if the <span 
class="cmtt-10">cart3d </span>system was
                  registered as having 3 dimensions, the variable <span 
class="cmtt-10">dim </span>below will now be set to
                  3,
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-54">
                  int dim;
                  dim = CCTK_CoordSystemDim(&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2480--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordSystemHandle</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2482--><p class="noindent" >
                  </p><!--l. 2484--><p class="noindent" >Provides the integer handle for a given coordinate system name. The handle describes
                  the index for the coordinate system in the flesh coordinate database, and its
                  value will range between zero and the number of registered systems minus
                  one. For example, the handle for the <span 
class="cmtt-10">cart3d </span>coordinate system can be found
                  using
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-55">
                  int handle;
                  handle = CCTK_CoordSystemHandle(&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2492--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordSystemName</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2494--><p class="noindent" >
                  </p><!--l. 2496--><p class="noindent" >The inverse to the previous function call. This provides the name for a given coordinate
                  system handle. For example, to find the first coordinate system in the flesh
                  database
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-56">
                  int handle = 0;
                  const char *name = CCTK_CoordSystemName(handle);
</pre>
                  <!--l. 2502--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordIndex</span>   </dt><dd 
class="list">
                  <!--l. 2504--><p class="noindent" >
                  </p><!--l. 2506--><p class="noindent" >Provides the grid variable index for a given coordinate. Note that it is not necessary for a
                  registered coordinate to have an associated grid variable, and if no such grid variable is
                  found, a negative integer will be returned. For example, to find the grid variable index
                  associated with the <span 
class="cmtt-10">y </span>coordinate of the <span 
class="cmtt-10">cart3d </span>system, either of the two following calls
                  could be made
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-57">
                  int index;
                  index = CCTK_CoordIndex(2,NULL,&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2516--><p class="nopar" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-58">
                  int index;
                  index = CCTK_CoordIndex(-1,&#x0022;y&#x0022;,&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2521--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordDir</span>     </dt><dd 
class="list">
                  <!--l. 2524--><p class="noindent" >
                  </p><!--l. 2526--><p class="noindent" >Provides the direction for a given coordinate. Directions are integers ranging from one to
                  the number of dimensions for the coordinate system. For example, to return the direction
                  of the <span 
class="cmtt-10">y </span>coordinate in the <span 
class="cmtt-10">cart3d </span>system
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-59">
                  int dir;
                  dir = CCTK_CoordDir(&#x0022;y&#x0022;,&#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2534--><p class="nopar" >
                  </p><!--l. 2536--><p class="noindent" >The return of a negative integer indicates that the coordinate direction could not be
                  found.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordRange</span>   </dt><dd 
class="list">
                  <!--l. 2539--><p class="noindent" >
                  </p><!--l. 2541--><p class="noindent" >Provides the global range (that is, the minimum and maximum values across the complete
                  grid) of a coordinate on a given grid hierarchy. The minimum and maximum values must
                  be of type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>. The coordinate can be specified either by name or by its direction.
                  Note that this call takes the <span 
class="cmti-10">addresses </span>of the minimum and maximum values. For example,
                  the range of the <span 
class="cmtt-10">y </span>coordinate of the <span 
class="cmtt-10">cart3d </span>coordinate system can be found
                  using
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-60">
                  CCTK_REAL lower, upper;
                  int ierr;
                  ierr = CCTK_CoordRange(cctkGH, &#x0026;lower, &#x0026;upper, -1, &#x0022;y&#x0022;, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2552--><p class="nopar" >or alternatively, using the direction
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-61">
                  CCTK_REAL lower, upper;
                  int ierr;
                  ierr = CCTK_CoordRange(cctkGH, &#x0026;lower, &#x0026;upper, 2, NULL, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2559--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordLocalRange</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2562--><p class="noindent" >
                  </p><!--l. 2564--><p class="noindent" >Provides the local range of a coordinate on a processor for a given grid hierarchy.
                  WARNING: This utility only works for regular cartesian grids. For example, the local
                  processor range of the <span 
class="cmtt-10">y </span>coordinate of the <span 
class="cmtt-10">cart3d </span>coordinate system can be found
                  using
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-62">
                  CCTK_REAL lower, upper;
                  int ierr;
                  ierr = CCTK_CoordLocalRange(cctkGH, &#x0026;lower, &#x0026;upper, -1, &#x0022;y&#x0022;, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2573--><p class="nopar" >or alternatively, using the direction
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-63">
                  CCTK_REAL lower, upper;
                  int ierr;
                  ierr = CCTK_CoordLocalRange(cctkGH, &#x0026;lower, &#x0026;upper, 2, NULL, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2580--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordRangePhysIndex</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2582--><p class="noindent" >
                  </p><!--l. 2584--><p class="noindent" >For a given coordinate, provides the indices describing the <span 
class="cmti-10">physical </span>range of the coordinate.
                  A negative return value signifies that no such range was registered for the
                  coordinate.
                  </p><!--l. 2588--><p class="noindent" >This index range provides a mechanism for describing grid points which should not be
                  considered part of the simulation results (for example, grid points used for different
                  boundary conditions). The physical range of the <span 
class="cmtt-10">y </span>coordinate of the <span 
class="cmtt-10">cart3d </span>system can be
                  found using
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-64">
                  int ilower, iupper;
                  int ierr;
                  ierr = CCTK_CoordRangePhysIndex(cctkGH,&#x0026;ilower,&#x0026;iupper, -1, &#x0022;y&#x0022;, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2597--><p class="nopar" >or using the coordinate direction
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-65">
                  int ilower, iupper;
                  int ierr;
                  ierr = CCTK_CoordRangePhysIndex(cctkGH,&#x0026;ilower,&#x0026;iupper, 2, NULL, &#x0022;cart3d&#x0022;);
</pre>
                  <!--l. 2603--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CoordSystemImplementation</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2605--><p class="noindent" >
                  </p><!--l. 2607--><p class="noindent" >This call returns the name of the implementation which registered a coordinate system.
                  Note that there is no guarantee that a thorn, which registered a coordinate system, is the
                  same thorn which registers each of the coordinates in the system, although this should
                  usually be the case.
</p>
                  </dd></dl>
<!--l. 2616--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.7.3   </span> <a 
 id="x1-108000C1.7.3"></a>I/O</h4>
<!--l. 2619--><p class="noindent" >To allow flexible I/O, the flesh itself does not provide any output routines, however it provides a mechanism for
thorns to register different routines as I/O methods (see Chapter <a 
href="#x1-167000C2.7">C2.7<!--tex4ht:ref: chap:io_methods --></a>). Application thorns can interact with the
different I/O methods through the following function calls:
     </p><dl class="description"><dt class="description">
 </dt><dd 
class="description">
     <!--l. 2627--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputGH (const cGH *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">)</span>
     </p><!--l. 2629--><p class="noindent" >This call loops over all registered I/O methods, calling the routine that each method has registered
     for <span class="obeylines-h"><span 
class="cmtt-10">OutputGH</span></span>. The expected behaviour of any <span class="obeylines-h"><span 
class="cmtt-10">OutputGH</span></span> routine is to loop over all GH variables,
     outputting them if the I/O method contains appropriate routines (that is, not all methods will
     supply  routines  to  output  all  different  types  of  variables),  and  if  the  method  decides  it  is  an
     appropriate time to output.
     </p></dd><dt class="description">
 </dt><dd 
class="description">
     <!--l. 2637--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputVar (const cGH *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">, const char *</span><span 
class="cmsltt-10">varname</span><span 
class="cmtt-10">)</span>
     </p><!--l. 2639--><p class="noindent" >Outputs a variable <span 
class="cmsltt-10">varname </span>looping over all registered I/O methods. <span 
class="cmsltt-10">varname </span>may have an optional
     I/O option string appended. The output should take place if at all possible. If output goes into a
     file and the appropriate file exists, the data is appended, otherwise a new file is created.
                                                                                       
                                                                                       
     </p></dd><dt class="description">
 </dt><dd 
class="description">
     <!--l. 2645--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputVarAs (const cGH *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">, const char *</span><span 
class="cmsltt-10">varname</span><span 
class="cmtt-10">, const char *</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">)</span>
     </p><!--l. 2647--><p class="noindent" >Outputs a variable <span 
class="cmsltt-10">varname </span>looping over all registered I/O methods. <span 
class="cmsltt-10">varname </span>may have an optional
     I/O option string appended. The output should take place if at all possible. If output goes into a
     file and the appropriate file exists, the data is appended, otherwise a new file is created. Uses <span 
class="cmsltt-10">alias</span>
     as the name of the variable for the purpose of constructing a filename.
     </p></dd><dt class="description">
 </dt><dd 
class="description">
     <!--l. 2654--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputVarByMethod (const cGH *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">, const char *</span><span 
class="cmsltt-10">varname</span><span 
class="cmtt-10">, const char</span>
     <span 
class="cmtt-10">*</span><span 
class="cmsltt-10">methodname</span><span 
class="cmtt-10">)</span>
     </p><!--l. 2656--><p class="noindent" >Outputs a variable <span 
class="cmsltt-10">varname </span>using the I/O method <span 
class="cmsltt-10">methodname </span>if it is registered. <span 
class="cmsltt-10">varname </span>may
     have an optional I/O option string appended. The output should take place if at all possible. If
     output goes into a file and the appropriate file exists, the data is appended, otherwise a new file is
     created.
     </p></dd><dt class="description">
 </dt><dd 
class="description">
     <!--l. 2662--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputVarAsByMethod (const cGH *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">, const char *</span><span 
class="cmsltt-10">varname</span><span 
class="cmtt-10">, const char</span>
     <span 
class="cmtt-10">*</span><span 
class="cmsltt-10">methodname</span><span 
class="cmtt-10">,</span><br 
class="newline" /><span 
class="cmtt-10">const char *</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">)</span>
     </p><!--l. 2667--><p class="noindent" >Outputs a variable <span 
class="cmsltt-10">varname </span>using the I/O method <span 
class="cmsltt-10">methodname </span>if it is registered. <span 
class="cmsltt-10">varname </span>may
     have an optional I/O option string appended. The output should take place if at all possible. If
     output goes into a file and the appropriate file exists, the data is appended, otherwise a new file is
     created. Uses <span 
class="cmsltt-10">alias </span>as the name of the variable for the purpose of constructing a filename.
</p>
     </dd></dl>
<!--l. 2678--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.7.4   </span> <a 
 id="x1-109000C1.7.4"></a>Interpolation Operators</h4>
<!--l. 2681--><p class="noindent" >The flesh does not provide interpolation routines by itself. Instead, it offers a general function API to thorns, for
the registration and invocation of interpolation operators.
</p><!--l. 2685--><p class="noindent" >There are two different flesh APIs for interpolation, depending on whether the data arrays are Cactus grid arrays
or processor-local, programming language built-in arrays, and on what assumptions are made about the topology
and spacing of the grid (these descriptions are for 3D, but the generalisations to other numbers of dimensions
should be obvious):
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_InterpGridArrays()</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2692--><p class="noindent" >Interpolates Cactus grid arrays, with the topology of the grid implicitly specified
                  by a Cactus coordinate system.
                                                                                       
                                                                                       
                  </p><!--l. 2696--><p class="noindent" >This API doesn’t provide an interpolation functionality itself, it only takes care
                  of the interprocessor communication necessary when interpolating distributed grid
                  arrays, and invokes the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_InterpLocalUniform() </span>API on the each processor’s
                  local component of the data.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_InterpLocalUniform()</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2701--><p class="noindent" >Interpolates processor-local arrays with <span 
class="cmti-10">uniformly </span>spaced data points, i.e. where the
                  coordinates \(xyz\) are related to the integer array subscripts <span class="obeylines-h"><code class="verb">ijk</code></span> by <span 
class="cmti-10">linear </span>functions
                  </p>
                  <div class="flushleft" 
>
<!--l. 2706--><p class="noindent" >
 \(x = \mbox {\code {origin}}_x + i \, \mbox {\code {delta}}_x\)<br />
\(y = \mbox {\code {origin}}_y + j \, \mbox {\code {delta}}_y\)<br />
\(z = \mbox {\code {origin}}_z + k \, \mbox {\code {delta}}_z\)</p></div>
                  <!--l. 2711--><p class="noindent" >where the caller specifies the <span class="obeylines-h"><code class="verb">origin</code></span> and <span class="obeylines-h"><code class="verb">delta</code></span> values.</p></dd></dl>
<!--l. 2741--><p class="noindent" >The flesh provides an API to register local interpolation operators:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_InterpRegisterOpLocalUniform()</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2743--><p class="noindent" >Register a <span class="obeylines-h"><code class="verb">CCTK_InterpLocalUniform()</code></span> interpolation operator</p></dd></dl>
<!--l. 2751--><p class="noindent" >This is described in detail in the Reference Manual.
</p><!--l. 2753--><p class="noindent" >Each local interpolation operator is registered under a character string name; at registration, the name is
mapped to a unique integer handle, which may be used to refer to the operator. <span class="obeylines-h"><code class="verb">CCTK_InterpHandle()</code></span> is used
to get the handle corresponding to a given character string name.
</p><!--l. 2772--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.7.5   </span> <a 
 id="x1-110000C1.7.5"></a>Reduction Operators</h4>
<!--l. 2775--><p class="noindent" >A reduction operation can be defined as an operation on variables distributed across multiple processor
resulting in a single number. Typical reduction operations are: sum, minimum/maximum value, and
boolean operations. A typical application is, for example, finding the maximum reduction from
processor local error estimates, therefore, making the previous processor local error known to all
processors.
</p><!--l. 2782--><p class="noindent" >The exchange of information across processors needs the functionality of a communication layer, e.g.
<span 
class="cmtt-10">CactusPUGH/PUGH</span>. For this reason, the reduction operation itself is not part of the flesh, instead, Cactus
(again) provides a registration mechanism for thorns to register routines they provide as reduction
operators. The different operators are identified by their name and/or a unique number, called a
<span 
class="cmti-10">handle</span>.
                                                                                       
                                                                                       
</p><!--l. 2790--><p class="noindent" >The registration mechanism gives the advantage of a common interface while hiding the individual
communication calls in the layer.
</p><!--l. 2794--><p class="noindent" >In Cactus, reduction operators can be applied to grid functions, arrays and scalars, as well as to local arrays.
Note that different implementations of reduction operators may be limited in the objects they can be applied to.
There is a fundamental difference between the reduction operation on grid functions and quantities as
arrays.
</p><!--l. 2801--><p class="noindent" >Currently the flesh supports the new and old reduction specification. The old APIs will be deprecated in the
next beta cycle in favour of the new specification.
</p><!--l. 2805--><p class="noindent" ><span 
class="cmbx-10">New Reduction Specification API documentation</span>
</p><!--l. 2807--><p class="noindent" >In the new reduction specification, there are two different flesh APIs for reduction, depending on whether the
data arrays are Cactus grid arrays or processor-local, programming language built-in arrays, and on what
assumptions are made about the topology and spacing of the grid (these descriptions are for 3D, but the
generalisations to other numbers of dimensions should be obvious):
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ReduceGridArrays()</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2814--><p class="noindent" >Reduces Cactus grid arrays, with the topology of the grid implicitly specified by a
                  Cactus coordinate system.
                  </p><!--l. 2818--><p class="noindent" >This  API  doesn’t  provide  a  reduction  functionality  itself,  it  only  takes  care  of
                  the interprocessor communication necessary when reducing distributed grid arrays,
                  and invokes the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ReduceLocalArrays() </span>API on the each processor’s local
                  component of the data.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ReduceLocalArrays()</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2823--><p class="noindent" >Reduces processor-local arrays with various options including <span 
class="cmti-10">offsets</span>, <span 
class="cmti-10">strides </span>and
                  <span 
class="cmti-10">masks</span>.</p></dd></dl>
<!--l. 2828--><p class="noindent" >The flesh provides an API to register local reduction operators:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RegisterLocalArrayReductionOperator()</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2830--><p class="noindent" >Register a <span class="obeylines-h"><code class="verb">CCTK_ReduceLocalArrays()</code></span> interpolation operator</p></dd></dl>
<!--l. 2833--><p class="noindent" >This is described in detail in the Reference Manual.
</p><!--l. 2835--><p class="noindent" >Each local reduction operator is registered under a character string name; at registration, the name is mapped to
a unique integer handle, which may be used to refer to the operator. <span class="obeylines-h"><code class="verb">CCTK_LocalArrayReductionHandle()</code></span> is
used to get the handle corresponding to a given character string name.
</p><!--l. 2841--><p class="noindent" ><span 
class="cmbx-10">Old Reduction Specification API Documentation</span>
</p><!--l. 2844--><p class="noindent" ><span 
class="cmbx-10">Obtaining the reduction handle</span>
                                                                                       
                                                                                       
</p><!--l. 2846--><p class="noindent" >Before calling the routine which performs the reduction operation, the handle, which identifies the operation,
must be derived from its registered name.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-66">
int CCTK_ReductionHandle(const char *reduction_name);

integer       reduction_handle
character*(*) reduction_name
call CCTK_ReductionHandle(reduction_handle, reduction_name)


int CCTK_ReductionArrayHandle(const char *reduction_name);

integer       reduction_handle
character*(*) reduction_name
call CCTK_ReductionArrayHandle(reduction_handle, reduction_name)

</pre>
<!--l. 2865--><p class="nopar" >
</p><!--l. 2870--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">reduction</span><span 
class="cmtt-10">_handle</span>  </dt><dd 
class="list">
                  <!--l. 2871--><p class="noindent" >in Fortran, the name of the variable will contain the handle value after the call. In
                  C, this value is the function value.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">reduction</span><span 
class="cmtt-10">_name</span>    </dt><dd 
class="list">
                  <!--l. 2875--><p class="noindent" >is the name under which the operator has been registered by the providing thorn.
                  The only thorn in the standard Computational Toolkit release, which provides
                  reduction operators, is <span 
class="cmtt-10">CactusPUGH/PUGHReduce</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">error checking</span>       </dt><dd 
class="list">
                  <!--l. 2880--><p class="noindent" >negative handle value indicates failure to identify the correct operator.</p></dd></dl>
<!--l. 2885--><p class="noindent" >Get a integer handle corresponding to a given reduction operator. The operator is identified by the name it was
registered with. (Note that although it would appear to be far more convenient to pass the name of the
reduction operator directly to the following function call to <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Reduce</span></span> this causes problems with the
translation of strings from Fortran to C with variable argument lists).
</p><!--l. 2896--><p class="noindent" ><span 
class="cmbx-10">The general reduction interface. </span>The main interfaces for reduction operations are quite powerful (and hence
rather complicated). To ease the use of these main interfaces, wrappers designed for specific and more restricted
use are described below. If uncertain, you should use these.
</p>
<div class="obeylines-v">
                                                                                       
                                                                                       
<br /><pre class="verbatim" id="verbatim-67">
<!--l. 2905--><p class="noindent" >int CCTK_Reduce( const cGH *GH,
</p><!--l. 2906--><p class="noindent" >                  int proc,
</p><!--l. 2907--><p class="noindent" >                  int operation_handle,
</p><!--l. 2908--><p class="noindent" >                  int num_out_vals,
</p><!--l. 2909--><p class="noindent" >                  int type_out_vals,
</p><!--l. 2910--><p class="noindent" >                  void *out_vals,
</p><!--l. 2911--><p class="noindent" >                  int num_in_fields,
</p><!--l. 2912--><p class="noindent" >                  ...);
</p><!--l. 2913--><p class="noindent" >
</p><!--l. 2914--><p class="noindent" >
</p><!--l. 2915--><p class="noindent" >call CCTK_Reduce( int returnvalue,
</p><!--l. 2916--><p class="noindent" >                  cctkGH,
</p><!--l. 2917--><p class="noindent" >                  int processor,
</p><!--l. 2918--><p class="noindent" >                  int operation_handle,
</p><!--l. 2919--><p class="noindent" >                  int num_out_vals,
</p><!--l. 2920--><p class="noindent" >                  int type_out_vals,
</p><!--l. 2921--><p class="noindent" >                  out_vals,
</p><!--l. 2922--><p class="noindent" >                  int num_in_fields,
</p><!--l. 2923--><p class="noindent" >                  ... )
</p><!--l. 2924--><p class="noindent" >
</p><!--l. 2925--><p class="noindent" >int CCTK_ReduceArray(  const cGH *GH,
</p><!--l. 2926--><p class="noindent" >                       int proc,
</p><!--l. 2927--><p class="noindent" >                       int operation_handle,
</p><!--l. 2928--><p class="noindent" >                       int num_out_vals,
</p><!--l. 2929--><p class="noindent" >                       int type_out_vals,
</p><!--l. 2930--><p class="noindent" >                       void *out_vals,
</p><!--l. 2931--><p class="noindent" >                       int num_dims,
</p><!--l. 2932--><p class="noindent" >                       int num_in_arrays,
</p><!--l. 2933--><p class="noindent" >                       int type_in_arrays,
</p><!--l. 2934--><p class="noindent" >                       ... )
</p><!--l. 2935--><p class="noindent" >
</p><!--l. 2936--><p class="noindent" >call CCTK_ReduceArray(int returnvalue,
</p><!--l. 2937--><p class="noindent" >                      cctkGH,
</p><!--l. 2938--><p class="noindent" >                      int processor,
</p><!--l. 2939--><p class="noindent" >                      int operation_handle,
</p><!--l. 2940--><p class="noindent" >                      int num_out_vals,
</p><!--l. 2941--><p class="noindent" >                      int type_out_arrays,
</p><!--l. 2942--><p class="noindent" >                      void out_vals,
</p><!--l. 2943--><p class="noindent" >                      int num_dims,
</p><!--l. 2944--><p class="noindent" >                      int num_in_arrays,
</p><!--l. 2945--><p class="noindent" >                      int type_in_arrays,
</p><!--l. 2946--><p class="noindent" >                      ... )

</p></pre>
<!--l. 2947--><p class="nopar" ></p></div>
<!--l. 2950--><p class="noindent" >
                                                                                       
                                                                                       
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">int returnvalue</span>   </dt><dd 
class="list">
                  <!--l. 2951--><p class="noindent" >the  return  value  of  the  operation.  Negative  value  indicates  failure  to  perform
                  reduction. Zero indicates a successful operation.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctkGH</span>            </dt><dd 
class="list">
                  <!--l. 2955--><p class="noindent" >in Fortran, the pointer to the grid hierarchy structure. Can not be used within
                  Fortran, but can be used from within C. Since this name is fixed, write it out as
                  shown.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cGH *GH</span>           </dt><dd 
class="list">
                  <!--l. 2960--><p class="noindent" >in C, it is the pointer to the grid hierarchy.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">int processor</span>     </dt><dd 
class="list">
                  <!--l. 2962--><p class="noindent" >the processor which collects the information, a negative value (\(-1\)) will distribute the
                  data to all processors.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">int operation</span><span 
class="cmtt-10">_handle</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2966--><p class="noindent" >the  number  of  the  reduction  operation  handle,  needs  to  be  found  by  calling
                  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ReductionHandle </span>or <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ReductionArrayHandle</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">int num</span><span 
class="cmtt-10">_out</span><span 
class="cmtt-10">_vals</span>  </dt><dd 
class="list">
                  <!--l. 2969--><p class="noindent" >integer defining the number of output values.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">int type</span><span 
class="cmtt-10">_out</span><span 
class="cmtt-10">_arrays</span><span 
class="cmss-10">, </span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">_in</span><span 
class="cmtt-10">_arrays</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 2970--><p class="noindent" >specifies the type of the gridfunction you are communicating. Use the values as
                  specified in Section <a 
href="#x1-142000C1.9.8">C1.9.8<!--tex4ht:ref: sec:datyansi --></a>. Note: Do not mix data types, e.g. in Fortran, do not
                  declare a variable as <span 
class="cmtt-10">integer </span>and then specify the type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_INT </span>in the
                  reduction command. These types need not be the same on some architectures and
                  will conflict.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">out</span><span 
class="cmtt-10">_vals</span>          </dt><dd 
class="list">
                  <!--l. 2977--><p class="noindent" >an array that will contain the output values.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">int num</span><span 
class="cmtt-10">_in</span><span 
class="cmtt-10">_fields</span> </dt><dd 
class="list">
                  <!--l. 2978--><p class="noindent" >specifies the number of input fields.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">...</span>               </dt><dd 
class="list">
                  <!--l. 2979--><p class="noindent" >indicates a variable argument list: specify the arrays which will be reduced, the
                  number of specified arrays must be the same as the value of the <span 
class="cmtt-10">num</span><span 
class="cmtt-10">_in</span><span 
class="cmtt-10">_fields</span>
                  variable.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmbx-10">error checking</span>    </dt><dd 
class="list">
                  <!--l. 2982--><p class="noindent" >a return value, other than zero, indicates failure to perform the operation.</p></dd></dl>
<!--l. 2989--><p class="noindent" ><span 
class="cmbx-10">Special reduction interfaces. </span>The routines are designed for the purpose of reducing scalars, arrays and grid
functions. They hide many of the options of the generic interface described above.
</p><!--l. 2993--><p class="noindent" ><span 
class="cmbx-10">Reduction of local scalars across multiple processors. </span>The result of the reduction operation will be on the
specified processor or on all processors.
</p>
<div class="obeylines-v">
                                                                                       
                                                                                       
<br /><pre class="verbatim" id="verbatim-68">
<!--l. 2998--><p class="noindent" >int CCTK_ReduceLocScalar (const cGH *GH,
</p><!--l. 2999--><p class="noindent" >                          int processor,
</p><!--l. 3000--><p class="noindent" >                          int operation_handle,
</p><!--l. 3001--><p class="noindent" >                          void *in_scalar,
</p><!--l. 3002--><p class="noindent" >                          void *out_scalar,
</p><!--l. 3003--><p class="noindent" >                          int data_type)
</p><!--l. 3004--><p class="noindent" >
</p><!--l. 3005--><p class="noindent" >call CCTK_ReduceLocScalar(int returnvalue,
</p><!--l. 3006--><p class="noindent" >                          cctkGH,
</p><!--l. 3007--><p class="noindent" >                          int processor,
</p><!--l. 3008--><p class="noindent" >                          int operation_handle,
</p><!--l. 3009--><p class="noindent" >                          in_scalar,
</p><!--l. 3010--><p class="noindent" >                          out_scalar,
</p><!--l. 3011--><p class="noindent" >                          int data_type)

</p></pre>
<!--l. 3012--><p class="nopar" ></p></div>
                  <dl class="list1"><dt class="list">
<span 
class="cmtt-10">in</span><span 
class="cmtt-10">_scalar</span>         </dt><dd 
class="list">
                  <!--l. 3015--><p class="noindent" >the processor local variable with local value to be reduced
                  </p></dd><dt class="list">
<span 
class="cmtt-10">out</span><span 
class="cmtt-10">_scalar</span>        </dt><dd 
class="list">
                  <!--l. 3016--><p class="noindent" >the reduction result: a processor local variable with the global value (same on all
                  processors), if  <span 
class="cmtt-10">processor </span>has been set to \(-1\). Otherwise, <span 
class="cmtt-10">processor </span>will hold the
                  reduction result.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">data</span><span 
class="cmtt-10">_type</span>         </dt><dd 
class="list">
                  <!--l. 3019--><p class="noindent" >specifies the type of the gridfunction you are communicating. Use the values as
                  specified in Section <a 
href="#x1-142000C1.9.8">C1.9.8<!--tex4ht:ref: sec:datyansi --></a>.</p></dd></dl>
<!--l. 3027--><p class="noindent" ><span 
class="cmbx-10">Reduction of local 1d arrays to a local arrays. </span>This reduction is carried out element by element. The
arrays need to have the same size on all processors. <span class="obeylines-h">
                                                                                       
                                                                                       
<br /><pre class="verbatim" id="verbatim-69">
<!--l. 3032--><p class="noindent" >int CCTK_ReduceLocArrayToArray1D( const cGH *GH,
</p><!--l. 3033--><p class="noindent" >                                  int processor,
</p><!--l. 3034--><p class="noindent" >                                  int operation_handle,
</p><!--l. 3035--><p class="noindent" >                                  void *in_array1d,
</p><!--l. 3036--><p class="noindent" >                                  void *out_array1d,
</p><!--l. 3037--><p class="noindent" >                                  int xsize,
</p><!--l. 3038--><p class="noindent" >                                  int data_type)
</p><!--l. 3039--><p class="noindent" >
</p><!--l. 3040--><p class="noindent" >call CCTK_ReduceLocArrayToArray1D(int returnvalue
</p><!--l. 3041--><p class="noindent" >                                  cctkGH,
</p><!--l. 3042--><p class="noindent" >                                  int processor,
</p><!--l. 3043--><p class="noindent" >                                  int operation_handle,
</p><!--l. 3044--><p class="noindent" >                                  in_array1d,
</p><!--l. 3045--><p class="noindent" >                                  out_array1d,
</p><!--l. 3046--><p class="noindent" >                                  int xsize,
</p><!--l. 3047--><p class="noindent" >                                  int data_type)

</p></pre>
<!--l. 3048--><p class="nopar" ></p></span>
</p><!--l. 3051--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">in</span><span 
class="cmtt-10">_array1d</span>        </dt><dd 
class="list">
                  <!--l. 3052--><p class="noindent" >one dimensional local arrays to be reduced across a processors, element by element.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">out</span><span 
class="cmtt-10">_array1d</span>       </dt><dd 
class="list">
                  <!--l. 3054--><p class="noindent" >array holding the reduction result. out_array1d[1] = Reduction(in_array[1]).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">xsize</span>             </dt><dd 
class="list">
                  <!--l. 3056--><p class="noindent" >the size of the one dimensional array.</p></dd></dl>
<!--l. 3061--><p class="noindent" ><span 
class="cmbx-10">Reduction of local 2d arrays to a local 2d array. </span>This reduction is carried out element by element. The
arrays need to have the same size on all processors. <span class="obeylines-h">
                                                                                       
                                                                                       
<br /><pre class="verbatim" id="verbatim-70">
<!--l. 3066--><p class="noindent" >int CCTK_ReduceLocArrayToArray2D( const cGH *GH,
</p><!--l. 3067--><p class="noindent" >                                  int processor,
</p><!--l. 3068--><p class="noindent" >                                  int opertaion_handle,
</p><!--l. 3069--><p class="noindent" >                                  in_array_2d,
</p><!--l. 3070--><p class="noindent" >                                  out_array2d,
</p><!--l. 3071--><p class="noindent" >                                  int xsize,
</p><!--l. 3072--><p class="noindent" >                                  int ysize,
</p><!--l. 3073--><p class="noindent" >                                  int data_type)
</p><!--l. 3074--><p class="noindent" >
</p><!--l. 3075--><p class="noindent" >
</p><!--l. 3076--><p class="noindent" >call CCTK_ReduceLocArrayToArray2D( int returnvalue
</p><!--l. 3077--><p class="noindent" >                                   cctkGH,
</p><!--l. 3078--><p class="noindent" >                                   int processor,
</p><!--l. 3079--><p class="noindent" >                                   int operation_handle,
</p><!--l. 3080--><p class="noindent" >                                   in_array2d,
</p><!--l. 3081--><p class="noindent" >                                   out_array2d,
</p><!--l. 3082--><p class="noindent" >                                   int xsize,
</p><!--l. 3083--><p class="noindent" >                                   int ysize,
</p><!--l. 3084--><p class="noindent" >                                   int data_type)
</p><!--l. 3085--><p class="noindent" >

</p></pre>
<!--l. 3086--><p class="nopar" ></p></span>
</p><!--l. 3089--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">in</span><span 
class="cmtt-10">_array1d</span>        </dt><dd 
class="list">
                  <!--l. 3090--><p class="noindent" >two dimensional local arrays, to be reduced across a processors, element by element.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">out</span><span 
class="cmtt-10">_array1d</span>       </dt><dd 
class="list">
                  <!--l. 3092--><p class="noindent" >two   dimensional   array   holding   the   reduction   result.   out_array2d[i,j]=
                  Reduction(in_array2d[i,j]).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">xsize</span>             </dt><dd 
class="list">
                  <!--l. 3094--><p class="noindent" >the size of the one dimensional array in x direction.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">ysize</span>             </dt><dd 
class="list">
                  <!--l. 3095--><p class="noindent" >the size of the one dimensional array in y direction.</p></dd></dl>
<!--l. 3100--><p class="noindent" ><span 
class="cmbx-10">Reduction of local 3D arrays to a local 3D array. </span>This reduction is carried out element by element. The
arrays need to have the same size on all processors. <span class="obeylines-h">
                                                                                       
                                                                                       
<br /><pre class="verbatim" id="verbatim-71">
<!--l. 3105--><p class="noindent" >int CCTK_ReduceLocArrayToArray3D(const cGH *GH,
</p><!--l. 3106--><p class="noindent" >                                 int processor,
</p><!--l. 3107--><p class="noindent" >                                 int opertaion_handle,
</p><!--l. 3108--><p class="noindent" >                                 in_array_3d,
</p><!--l. 3109--><p class="noindent" >                                 out_array3d,
</p><!--l. 3110--><p class="noindent" >                                 int xsize,
</p><!--l. 3111--><p class="noindent" >                                 int ysize,
</p><!--l. 3112--><p class="noindent" >                                 int zsize,
</p><!--l. 3113--><p class="noindent" >                                 int data_type)
</p><!--l. 3114--><p class="noindent" >
</p><!--l. 3115--><p class="noindent" >call CCTK_ReduceLocArrayToArray3D(int returnvalue
</p><!--l. 3116--><p class="noindent" >                                 cctkGH,
</p><!--l. 3117--><p class="noindent" >                                 int processor,
</p><!--l. 3118--><p class="noindent" >                                 int operation_handle,
</p><!--l. 3119--><p class="noindent" >                                 in_array3d,
</p><!--l. 3120--><p class="noindent" >                                 out_array3d,
</p><!--l. 3121--><p class="noindent" >                                 int xsize,
</p><!--l. 3122--><p class="noindent" >                                 int ysize,
</p><!--l. 3123--><p class="noindent" >                                 int zsize,
</p><!--l. 3124--><p class="noindent" >                                 int data_type)

</p></pre>
<!--l. 3125--><p class="nopar" ></p></span>
</p><!--l. 3128--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">in</span><span 
class="cmtt-10">_array3d</span>        </dt><dd 
class="list">
                  <!--l. 3129--><p class="noindent" >two dimensional local arrays, to be reduced across a processors, element by element.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">out</span><span 
class="cmtt-10">_array3d</span>       </dt><dd 
class="list">
                  <!--l. 3131--><p class="noindent" >two   dimensional   array   holding   the   reduction   result.   out_array3d[i,j,k]=
                  Reduction(in_array3d[i,j,k]).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">xsize</span>             </dt><dd 
class="list">
                  <!--l. 3133--><p class="noindent" >the size of the one dimensional array in x direction.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">ysize</span>             </dt><dd 
class="list">
                  <!--l. 3134--><p class="noindent" >the size of the one dimensional array in y direction.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">ysize</span>             </dt><dd 
class="list">
                  <!--l. 3135--><p class="noindent" >the size of the one dimensional array in z direction.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 3140--><p class="noindent" ><span 
class="cmbx-10">Some brief examples:</span>
</p><!--l. 3142--><p class="noindent" ><span 
class="cmbx-10">Reduction of a local scalars: </span>a local error is reduced across all processors with the maximum operation. The
variable <span 
class="cmtt-10">tmp </span>will hold the maximum of the error and is the same on all processors. This quantity can then be
reassigned to <span 
class="cmtt-10">normerr</span>.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-72">
         CCTK_REAL normerr, tmp
         integer   ierr, reduction_handle

         call CCTK_ReductionArrayHandle(reduction_handle,&#x0022;maximum&#x0022;)

         if (reduction_handle.lt.0) then
            call CCTK_WARN(CCTK_WARN_ALERT, &#x0022;Cannot get reduction handle for maximum operation.&#x0022;)
         endif

         call CCTK_ReduceLocScalar(ierr, cctkGH, -1,
     .             reduction_handle,
     .             normerr, tmp, CCTK_VARIABLE_REAL)
         if (ierr.ne.0) then
            call CCTK_WARN(CCTK_WARN_ALERT, &#x0022;Reduction of norm failed!&#x0022;);
         endif
         normerr = tmp
</pre>
<!--l. 3163--><p class="nopar" >
</p><!--l. 3166--><p class="noindent" ><span 
class="cmbx-10">Reduction of a local 2D array: </span>a two dimensional array \((2\times 3)\) is reduced, reduction results (array of same size:
<span 
class="cmtt-10">bla</span><span 
class="cmtt-10">_tmp</span>) are seen on all processors (\(-1\) entry as the third argument); also demonstrates some simple error checking
with the <span 
class="cmtt-10">CCTKi</span><span 
class="cmtt-10">_EXPECTOK </span>macro.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-73">
      CCTK_REAL bla(2,3),bla_tmp(2,3);
      integer   ierr, sum_handle

      call CCTK_ReductionArrayHandle(sum_handle,&#x0022;sum&#x0022;)
      bla         =  1.0d0
      write (*,*) &#x0022;BLA &#x0022;,bla

      call CCTK_ReduceLocArrayToArray2D(ierr, cctkGH, -1, sum_handle,
     .     bla, bla_tmp, 2, 3, CCTK_VARIABLE_REAL)
      call CCTKi_EXPECTOK(ierr, 0, 1, &#x0022;2D Reduction failed&#x0022;)

      bla = bla_tmp
      write (*,*) &#x0022;BLA &#x0022;,bla
</pre>
<!--l. 3184--><p class="nopar" >
</p><!--l. 3186--><p class="noindent" >Note that the memory for the returned values must be allocated before the reduction call is made.
</p><!--l. 3193--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.8   </span> <a 
 id="x1-111000C1.8"></a>Completing a Thorn</h3>
<!--l. 3197--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.8.1   </span> <a 
 id="x1-112000C1.8.1"></a>Commenting Source Code</h4>
<!--l. 3199--><p class="noindent" >Note that since most source files (see Section <a 
href="#x1-54000C1.2.4">C1.2.4<!--tex4ht:ref: nacofosofi --></a> for exceptions) pass through a C preprocessor, C style
comments can be used in Fortran code. Note that C++ comments (those ones starting with “<span 
class="cmtt-10">//</span>”), should only
be used in C++ source code.
</p><!--l. 3205--><p class="noindent" >The flesh and the Cactus thorns use the <span 
class="cmtt-10">grdoc </span>Code Documenting System<br 
class="newline" />(<a 
href="http://jean-luc.aei.mpg.de/Codes/grdoc/" class="url" ><span 
class="cmtt-10">http://jean-luc.aei.mpg.de/Codes/grdoc/</span></a>) to document source code.
</p><!--l. 3211--><p class="noindent" >
                                                                                       
                                                                                       
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.8.2   </span> <a 
 id="x1-113000C1.8.2"></a>Providing Runtime Information</h4>
<!--l. 3214--><p class="noindent" >To write from thorns to standard output (i.e. the screen) at runtime, use the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INFO </span>or
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VINFO</span>.
</p><!--l. 3217--><p class="noindent" >For example, from the Fortran thorn <span 
class="cmtt-10">MyThorn</span>,
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-74">
  call CCTK_INFO(&#x0022;Starting Tricky Calculation&#x0022;)
</pre>
<!--l. 3220--><p class="nopar" >will write the line:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-75">
  INFO (MyThorn): Starting Tricky Calculation
</pre>
<!--l. 3225--><p class="nopar" >
</p><!--l. 3227--><p class="noindent" >For a multiprocessor run, only runtime information from processor zero will be printed to screen by default. The
standard output of other processors will usually be discarded unless the “<span 
class="cmtt-10">-r</span>” command line option is used
(Section <a 
href="#x1-32000B3.1">B3.1<!--tex4ht:ref: sec:command_line_options --></a>).
</p><!--l. 3232--><p class="noindent" >Note that the macro <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VINFO </span>can only be called from C, because Fortran doesn’t know about variable
argument lists. So, including variables in the info message using <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INFO </span>is currently more tricky, since you
need to build the string to be output.
</p><!--l. 3237--><p class="noindent" >For example, in C you would just write
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-76">
  int myint;

  CCTK_VINFO(&#x0022;The integer is %d&#x0022;, myint);
</pre>
<!--l. 3242--><p class="nopar" >
</p><!--l. 3244--><p class="noindent" >But in Fortran you have to do the following
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-77">
  integer       myint
  character*200 message

  write (message, ’(&#x0022;The integer is &#x0022;,i4)’) myint
  call CCTK_INFO (message)
</pre>
<!--l. 3251--><p class="nopar" >
</p><!--l. 3253--><p class="noindent" >Note that </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 3255--><p class="noindent" >  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INFO </span>is  a  macro  which  expands  to  a  call  to  the  internal  function  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Info() </span>and
     automatically includes the thorn name in function call.
     </p></li>
     <li class="itemize">
     <!--l. 3259--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INFO </span>should be used rather than print statements, since it will give consistent behaviour on
     multiprocessors, and also provides a mechanism for switching the output to screen on and off, even
     on a thorn-by-thorn basis. (Although this is not yet implemented).</p></li></ul>
<!--l. 3268--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.8.3   </span> <a 
 id="x1-114000C1.8.3"></a>Error Handling, Warnings and Code Termination</h4>
<!--l. 3271--><p class="noindent" >The Cactus macros <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ERROR </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VERROR </span>should be used to output error messages and abort the
code.
</p><!--l. 3275--><p class="noindent" >The Cactus macros <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_WARN </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VWARN </span>should be used to issue warning messages during code
execution.
</p><!--l. 3279--><p class="noindent" >Along with the warning message, an integer is given to indicate the severity of the warning.
Only warnings with severity levels less than, or equal to, the global Cactus warning level
threshold<span class="footnote-mark"><a 
href="UsersGuide5.html#fn2x9"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-114001f2"></a> 
                                                                                       
                                                                                       
will be printed. A level 0 warning indicates the highest severity (and is guaranteed to abort the Cactus run),
while larger numbers indicate less severe warnings. The global Cactus warning level threshold defaults to 1, i.e.
level 1 warnings are printed, but level 2 and higher are not printed.
</p><!--l. 3295--><p class="noindent" >The severity level may actually be any integer, and a lot of existing code uses bare “magic number”
integers for warning levels, but to help standardize warning levels across thorns, new code should
probably use one of the following macros, defined in <span class="obeylines-h"><code class="verb">&#x0022;cctk_WarnLevel.h&#x0022;</code></span> (which is <span class="obeylines-h"><code class="verb">#include</code></span>d by
<span class="obeylines-h"><code class="verb">&#x0022;cctk.h&#x0022;</code></span>):
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-78">
#define CCTK_WARN_ABORT    0    /* abort the Cactus run */
#define CCTK_WARN_ALERT    1    /* the results of this run will probably */
                                /* be wrong, but this isn’t quite certain, */
                                /* so we’re not going to abort the run */
#define CCTK_WARN_COMPLAIN 2    /* the user should know about this, but */
                                /* the results of this run are probably ok */
#define CCTK_WARN_PICKY    3    /* this is for small problems that can */
                                /* probably be ignored, but that careful */
                                /* people may want to know about */
#define CCTK_WARN_DEBUG    4    /* these messages are probably useful */
                                /* only for debugging purposes */
</pre>
<!--l. 3312--><p class="nopar" >
</p><!--l. 3314--><p class="noindent" >For example, to provide a warning for a serious problem, which indicates that the results of the run are quite
likely wrong, and which will be printed to the screen by default, a level <span class="obeylines-h"><code class="verb">CCTK_WARN_ALERT</code></span> warning should be
used.
</p><!--l. 3319--><p class="noindent" >The syntax from Fortran is
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-79">
  call CCTK_WARN(CCTK_WARN_ALERT, &#x0022;Your warning message&#x0022;)
</pre>
<!--l. 3322--><p class="nopar" >
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-80">
  call CCTK_ERROR(&#x0022;Your error message&#x0022;)
</pre>
<!--l. 3325--><p class="nopar" >
</p><!--l. 3327--><p class="noindent" >and from C
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-81">
  CCTK_WARN(CCTK_WARN_ALERT, &#x0022;Your warning message&#x0022;);
</pre>
<!--l. 3330--><p class="nopar" >
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-82">
  CCTK_ERROR(&#x0022;Your error message&#x0022;);
</pre>
<!--l. 3333--><p class="nopar" >
</p><!--l. 3335--><p class="noindent" >Note that <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ERROR </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_WARN </span>are macros which expand to calls to an internal function. The
macros automatically include the thorn name, the source code file name and line number in the
message.<span class="footnote-mark"><a 
href="UsersGuide6.html#fn3x9"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-114003f3"></a> 
(For this reason it is important for Fortran code that capital letters are always used in order to expand the
macro.)
</p><!--l. 3353--><p class="noindent" >If the flesh parameter <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_full</span><span 
class="cmtt-10">_warnings </span>is set to true, then the source file name and line number will be
printed to standard error along with the originating processor number, the thorn name and the warning message.
The default is to omit the source file name and line number.
</p><!--l. 3358--><p class="noindent" >Note that the macros <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VERROR </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VWARN </span>can only be called from C, because Fortran doesn’t know
about variable argument lists. So including variables in the warning message using <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ERROR </span>or <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_WARN</span>, is
currently more tricky since you need to build the string to be output.
</p><!--l. 3365--><p class="noindent" >For example, in C you would just write
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-83">
  int    myint;
  double myreal;

  CCTK_VWARN(CCTK_WARN_ALERT,
             &#x0022;Your warning message, including %f and %d&#x0022;,
             myreal, myint);
</pre>
<!--l. 3373--><p class="nopar" >
</p><!--l. 3375--><p class="noindent" >But in Fortran you have to do the following
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-84">
  integer       myint
  real          myreal
  character*200 message

  write (message, ’(&#x0022;Your warning message, including &#x0022;,g12.7,&#x0022; and &#x0022;,i8)’) myreal, myint
  call CCTK_WARN (CCTK_WARN_ALERT, message)
</pre>
<!--l. 3383--><p class="nopar" >
</p><!--l. 3385--><p class="noindent" >Beside the default methods to handle error, warning, and information messages, the flesh also
implements a callback scheme to let thorn writers get information and warning messages as they are
produced.<span class="footnote-mark"><a 
href="UsersGuide7.html#fn4x9"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-114005f4"></a> 
</p><!--l. 3390--><p class="noindent" >For warning messages, a function with the following prototype
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-85">
void my_warnfunc(int level,
                 int line,
                 const char *file,
                 const char *thorn,
                 const char *message,
                 void *data);
</pre>
<!--l. 3398--><p class="nopar" >should be implemented, and then registered with
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-86">
CCTK_WarnCallbackRegister(int minlevel,
                          int maxlevel,
                          void *data,
                          cctk_warnfunc my_warnfunc);
</pre>
<!--l. 3405--><p class="nopar" >
</p><!--l. 3407--><p class="noindent" >The data pointer can be used to pass arbitrary information to the registered function, e.g. a file descriptor or a
format string.
</p><!--l. 3410--><p class="noindent" >Multiple functions can be registered as above; when <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_WARN </span>is called, all the registered functions will be
called, if the warning is within the minimum and maximum levels indicated.
</p><!--l. 3415--><p class="noindent" >The basic procedure is exactly the same for information messages.
</p><!--l. 3417--><p class="noindent" >A function registered for information messages will look like
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-87">
void my_infofunc(const char *thorn,
                 const char *message,
                 void *data);
</pre>
<!--l. 3422--><p class="nopar" >while the registration function looks like
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-88">
CCTK_InfoCallbackRegister(void *data, cctk_infofunc my_infofunc);
</pre>
<!--l. 3426--><p class="nopar" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.8.4   </span> <a 
 id="x1-115000C1.8.4"></a>Adding Documentation</h4>
<!--l. 3433--><p class="noindent" >Documentation is a vital part of your thorn, helping to ensure its ease of use and longevity, not only for others,
but also for the thorn authors. Although any kind of independent documentation can be added to a thorn
(ideally in the <span 
class="cmtt-10">doc </span>directory), there are two standard places for adding thorn documentation, a <span 
class="cmtt-10">README </span>and a
<span 
class="cmtt-10">doc/documentation.tex </span>file for including in Thorn Guides.
</p><!--l. 3440--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-116000"></a><span 
class="cmtt-10">README</span></h5>
<!--l. 3442--><p class="noindent" >The <span 
class="cmtt-10">README</span>, in the top level of a thorn, should contain brief and essential details about the thorn, such as the
authors, any copyright details, and a synopsis of what the thorn does.
</p><!--l. 3446--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-117000"></a>Contribution to Thorn Guide</h5>
<!--l. 3448--><p class="noindent" >The LaTeX file, <span 
class="cmtt-10">doc/documentation.tex</span>, is included in Thorn Guides built by the Cactus make system.
(e.g. by <span 
class="cmtt-10">gmake</span> \(&lt;\)<span 
class="cmsltt-10">config</span>\(&gt;\)<span 
class="cmtt-10">-ThornGuide</span>). Ideally this file should contain complete (and <span 
class="cmti-10">up-to-date</span>) details about
the thorn, exactly what is relevant is for the authors to decide, but remember that the Cactus make system
automatically parses the thorn CCL files to include information about all parameters, variables and scheduling.
Suggested sections include:
</p>
     <ul class="itemize1">
     <li class="itemize">
                                                                                       
                                                                                       
     <!--l. 3459--><p class="noindent" ><span 
class="cmbx-10">Model. </span>A description of the system which the thorn is modelling, including the equations, etc.,
     which are being solved or implemented.
     </p></li>
     <li class="itemize">
     <!--l. 3462--><p class="noindent" ><span 
class="cmbx-10">Numerical implementation. </span>Details about how the model is numerically implemented in the
     thorn.
     </p></li>
     <li class="itemize">
     <!--l. 3465--><p class="noindent" ><span 
class="cmbx-10">Using the thorn. </span>Any special details needed for using the thorn, tricky parameters, particular
     operating systems or additional required software, interactions with other thorns and examples of
     use.
     </p></li>
     <li class="itemize">
     <!--l. 3469--><p class="noindent" ><span 
class="cmbx-10">History. </span>Here is where you should describe why the thorn was written, any previous software or
     experience which was made use of, the authors of the thorn source code and documentation, how
     to get hold of the thorn, etc.
     </p></li>
     <li class="itemize">
     <!--l. 3474--><p class="noindent" ><span 
class="cmbx-10">References. </span>A bibliography can be included, referencing papers published using or about this
     thorn, or additional information about the model or numerics used.
</p>
     </li></ul>
<!--l. 3480--><p class="noindent" >A LaTeX template for the Thorn Guide documentation can be found in the flesh distribution at
</p><!--l. 3483--><p class="noindent" ><span 
class="cmtt-10">doc/ThornGuide/template.tex</span>,
</p><!--l. 3485--><p class="noindent" >this file is automatically copied to the correct location in a new thorn which is created with <span 
class="cmtt-10">gmake</span>
<span 
class="cmtt-10">newthorn</span>.
</p><!--l. 3488--><p class="noindent" >Since Cactus scripts need to parse this documentation, and since the LaTeX document should be consistent
across all thorns included in a Thorn Guide, please follow the guidelines below when filling in the
documentation:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 3495--><p class="noindent" >Use the Cactus Thorn Guide style file, located in the flesh distribution at <span 
class="cmtt-10">doc/latex/cactus.sty</span>. This
     should be included using a relative link, so that updates to the style file are applied to all
     thorns.
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-89">
     \usepackage{../../../../doc/latex/cactus}
</pre>
     <!--l. 3502--><p class="nopar" >
     </p></li>
     <li class="itemize">
     <!--l. 3504--><p class="noindent" >Aside from the <span 
class="cmtt-10">date</span>, <span 
class="cmtt-10">author</span>, and <span 
class="cmtt-10">title </span>fields, all of the documentation to be included in a Thorn Guide
     should be placed between the lines
     </p><!--l. 3509--><p class="noindent" ><span 
class="cmtt-10">% START CACTUS THORNGUIDE</span>
     </p><!--l. 3511--><p class="noindent" >and
     </p><!--l. 3513--><p class="noindent" ><span 
class="cmtt-10">% END CACTUS THORNGUIDE</span>
     </p></li>
     <li class="itemize">
     <!--l. 3515--><p class="noindent" >The command \(\backslash \)<span 
class="cmtt-10">def </span>can be used to define macros, but all such definitions must lie between the <span 
class="cmtt-10">START </span>and
     <span 
class="cmtt-10">END </span>line. Do not redefine any standard LaTeX command
     </p></li>
     <li class="itemize">
     <!--l. 3519--><p class="noindent" >Do not use the <span class="obeylines-h">\(\backslash \)<span 
class="cmtt-10">appendix</span></span> command, instead include any appendices you have as standard
     sections.
     </p></li>
     <li class="itemize">
     <!--l. 3522--><p class="noindent" >We only support PDF (<span 
class="cmtt-10">.pdf</span>) figures. Graphics figures should be included using the <span 
class="cmtt-10">includegraphics</span>
     command (not <span 
class="cmtt-10">epsffig</span>), with no file extension specified. For example,
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-90">
     \begin{figure}[ht]
       \begin{center}
         \includegraphics[width=6cm]{MyArrangement_MyThorn_MyFigure}
       \end{center}
       \caption{Illustration of this and that}
       \label{MyArrangement_MyThorn_MyLabel}
     \end{figure}
</pre>
     <!--l. 3534--><p class="nopar" >
     </p></li>
     <li class="itemize">
     <!--l. 3536--><p class="noindent" >All <span 
class="cmbx-10">labels</span>, <span 
class="cmbx-10">citations</span>, <span 
class="cmbx-10">references</span>, and <span 
class="cmbx-10">graphic images </span>names should conform to the following
     guidelines: <span 
class="cmtt-10">ARRANGEMENT</span><span 
class="cmtt-10">_THORN</span><span 
class="cmtt-10">_LABEL</span>. For instance, if you arrangement is called CactusWave, your
     thorn WaveToyC, and your original image blackhole.eps, you should rename your image to be
     <span 
class="cmtt-10">CactusWave</span><span 
class="cmtt-10">_WaveToyC</span><span 
class="cmtt-10">_blackhole.eps</span>
     </p></li>
     <li class="itemize">
     <!--l. 3543--><p class="noindent" >References should be formatted with the standard LaTeX <span 
class="cmbx-10">bibitem </span>command, for example, a bibliography
     section should look like:
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-91">
     \begin{thebibliography}{9}
       \bibitem{MyArrangement_MyThorn_Author99}
       {J. Author, \textit{The Title of the Book, Journal, or periodical}, 1 (1999),
       1--16. \url{http://www.nowhere.com/}}
     \end{thebibliography}
</pre>
     <!--l. 3553--><p class="nopar" >
</p>
     </li></ul>
<!--l. 3559--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.8.5   </span> <a 
 id="x1-118000C1.8.5"></a>Adding a Test Suite</h4>
<!--l. 3562--><p class="noindent" >To add a test suite to your thorn, devise a series of parameter files which use as many aspects of your thorn as
possible. Make sure that the parameter files produce ASCII output to files, and that these files are in the
directory <span 
class="cmtt-10">./&#x003C;parameter file base name&#x003E;</span>.
</p><!--l. 3568--><p class="noindent" >Run Cactus on each of the parameter files, and move the parameter files, and the output directories they
produced, to the <span 
class="cmtt-10">test </span>directory in your thorn.
</p><!--l. 3572--><p class="noindent" >Document carefully any situations or architectures in which your test suite does not give the correct
answers.
</p><!--l. 3575--><p class="noindent" >You can also specify options for running your testsuite by adding an optional configuration file called <span 
class="cmtt-10">test.ccl</span>
in the <span 
class="cmtt-10">test </span>directory. These are simple text files and may contain comments introduced by the hash ‘<span 
class="cmtt-10">#</span>’
character, which indicates that the rest of the line is a comment. If the last non-blank character of a line in a
config file is a backslash ‘\(\backslash \)’, the following line is treated as a continuation of the current line. Options include test
specific absolute and relative tolerances, thorn specific absolute and relative tolerances, the number of processors
required to run, possible postprocessing required to correctly compare numbers, and file extensions. The
configuration file has the form:
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">ABSTOL</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">thorn_absolute_tolerance</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">filename_pattern</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10">RELTOL</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">thorn_relative_tolerance</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">filename_pattern</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10">POSTPROC</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">util_program_name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">filename_pattern</span><span 
class="cmtt-10">]</span>
                                                                                       
                                                                                       
<br /><span 
class="cmtt-10">NPROCS</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">thorn_nprocs</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10">EXTENSIONS</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">extension_1</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">extension_2</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">extension_3</span><span 
class="cmtt-10">&#x003E;</span>
<br />
<br /><span 
class="cmtt-10">TEST</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">test_example</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> ABSTOL</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">absolute_tol</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">filename_pattern</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> RELTOL</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">relative_tol</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">filename_pattern</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> POSTPROC</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">util_program_name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">filename_pattern</span><span 
class="cmtt-10">]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> NPROCS</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">nprocs</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">}</span>
</div>
</div>
<!--l. 3603--><p class="noindent" >which states that when comparing files of test <span class="obeylines-h"><code class="verb">test_example</code></span>, both <span class="obeylines-h"><code class="verb">absolute_tol</code></span> and <span class="obeylines-h"><code class="verb">relative_tol</code></span> should be
used as the absolute and relative tolerances. For all other tests in the thorn, the default value of absolute
and relative tolerances are set to <span class="obeylines-h"><code class="verb">thorn_absolute_tolerance</code></span> and <span class="obeylines-h"><code class="verb">thorn_relative_tolerance</code></span>.
Both absolute and relative tolerances can be specified on a per-file bases by supplying an optional
<span class="obeylines-h"><code class="verb">filename_pattern</code></span> regular expression to match against a filename and the tolerance value. The specified
tolerances override more general tolerances for data files whose name matches these regular expressions.
Any set of characters can be used for matching as long as there are no whitespaces in the regular
expression.
</p><!--l. 3616--><p class="noindent" >For example:
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">ABSTOL</span><span 
class="cmtt-10"> 1e-8</span><span 
class="cmtt-10"> ^Psi4</span><span 
class="cmsy-10">∖</span><span 
class="cmtt-10">.[xy]</span>
<br /><span 
class="cmtt-10">RELTOL</span><span 
class="cmtt-10"> 1e-12</span><span 
class="cmtt-10"> gxx</span>
</div>
</div>
<!--l. 3623--><p class="noindent" >More specific tolerances can be specified for all the tests of a thorn or just within a test’s block. It is an error if a
regular expression matches more than one filename.
</p><!--l. 3628--><p class="noindent" >The <span 
class="cmtt-10">NPROCS </span>option specifies the number of processors required to run a given testsuite <span 
class="cmsltt-10">test</span><span 
class="cmsltt-10">_example </span>or all
testsuites of a thorn successfully. If no <span 
class="cmtt-10">NPROCS </span>option is present, the testsuite(s) is (are) assumed to
run with any number of processors. The <span 
class="cmtt-10">EXTENSIONS </span>option adds <span class="obeylines-h"><code class="verb">extension_1</code></span>, <span class="obeylines-h"><code class="verb">extension_2</code></span> and
<span class="obeylines-h"><code class="verb">extension_3</code></span> to the list of file extensions that are compared. This list is global over all tests in a
configuration.
</p><!--l. 3637--><p class="noindent" >Test specific tolerances have precedence over all tolerances, next come thorn wide tolerances, and
then cactus default tolerances. Absolute and relative tolerances are independent: you can choose to
use test specific absolute tolerance and thorn specific relative tolerance when running a test. For
example,
</p>
<div class="alltt">
                                                                                       
                                                                                       
<div class="obeylines-v">
<br /><span 
class="cmtt-10">TEST</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">test_rad</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> ABSTOL</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">1e-5</span>
<br /><span 
class="cmsy-10">}</span>
<br />
<br /><span 
class="cmtt-10">ABSTOL</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">1e-8</span>
<br /><span 
class="cmtt-10">RELTOL</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">1e-12</span>
</div>
</div>
<!--l. 3653--><p class="noindent" >would use an absolute tolerance of \(10^{-5}\) and a relative tolerance of \(10^{-12}\) when running <span class="obeylines-h"><code class="verb">test_rad</code></span> and an absolute
tolerance of \(10^{-8}\) and a relative tolerance of \(10^{-12}\) when running all other tests.
</p><!--l. 3657--><p class="noindent" >In addition, postprocessing can be specified. By means of this mechanism, hdf5 files can be converted into text,
or ascii files whose contents are re-ordered by running on multiple processes can be compared in a consistent
manner.
</p><!--l. 3661--><p class="noindent" >The postproc directive is followed by one or two parameters. The first is the name of the postproc command,
which should be an executable Linux program stored in the thorn’s util directory. The second is a regular
expression which matches the files to be processed (if no regular expression is provided, the expressin ”.*” will be
used, which will match anything).
</p><!--l. 3666--><p class="noindent" >The program should receive a single argument, a file name, and from it the program should produce columns of
ascii formatted floating point numbers similar to what the IOASCII routines produce. The test system will
run the postprocesser on both the files in the repo and the newly generated files and compare the
output.
</p><!--l. 3672--><p class="noindent" >For example:
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">TEST</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">sol-wave-test</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> POSTPROC</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">sort-txy.pl</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">asc</span><span 
class="tcst-1000">$</span>
<br /><span 
class="cmsy-10">}</span>
</div>
</div>
<!--l. 3681--><p class="noindent" >In the above example, files ending in “asc” are read using the sort-txy.pl program, and the output is streamed as
text through the testing mechanism.
</p><!--l. 3684--><p class="noindent" >In this example, sort-txy.pl sorts columns first by time, then x, then y value, removing (for 2D simulations) the
problems with ordering of data that sometimes occurr in simulations with more than one processor. The code for
this example follows:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-92">
#!/usr/bin/env perl
use strict;
open(FD, $ARGV[0]) or die;

my $data = {};
my %t = ();
my %x = ();
my %y = ();

while(&#x003C;FD&#x003E;) {
    # skip blank or comment lines
    next if(/^\s(#.*)$/);

    # Remove trailing spaces
    s/\s+$//;

    my @cols = split(/\s+/);
    if($#cols &#x003C; 2) {
        print;
        next;
    }
    my ($t,$x,$y) = ($cols[0], $cols[1], $cols[2]);
    $t{$t} = 1; $x{$x} = 1; $y{$y} = 1;
    $data-&#x003E;{$t}-&#x003E;{$x}-&#x003E;{$y} = \@cols;
}
for my $t (sort keys %t) {
    for my $x (sort keys %x) {
        for my $y (sort keys %y) {
            print join(&#x0022; &#x0022;,@{$data-&#x003E;{$t}-&#x003E;{$x}-&#x003E;{$y}}),&#x0022;\n&#x0022;
                if(defined($data-&#x003E;{$t}-&#x003E;{$x}-&#x003E;{$y}));
        }
    }
}
</pre>
<!--l. 3722--><p class="nopar" >
</p><!--l. 3724--><p class="noindent" >For details on running the test suites, see Section <a 
href="#x1-30000B2.6">B2.6<!--tex4ht:ref: sec:testing --></a>.
</p><!--l. 3726--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-119000"></a>Best Practices for Test Suites</h5>
                                                                                       
                                                                                       
<!--l. 3728--><p class="noindent" >When writing a test suite, there are a few things you should keep in mind:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 3732--><p class="noindent" >The test suite will be run together with many other test suites. It should, therefore, finish quickly
     (say, in under two minutes), and not use too much memory (so that it can run on a “normal”
     workstation).
     </p></li>
     <li class="itemize">
     <!--l. 3736--><p class="noindent" >The test suite will be run automatically, often in situations where no one checks the screen output.
     All important output should be via grid variables that are written to files. Alternatively, if the test
     suite tests some low-level infrastructure, it may just abort the simulation if it fails; that will also
     be detected.
     </p></li>
     <li class="itemize">
     <!--l. 3741--><p class="noindent" >Downloading many files is slow on many systems. A test suite should normally not have more than,
     say, hundred output files, and normally the output files should be small, so that there are not more
     than a few Megabytes of output files per test suite.
     </p></li>
     <li class="itemize">
     <!--l. 3745--><p class="noindent" >The test suite output files should always be the same. That means that they should not contain
     time stamps, etc. It is, therefore, best to use the option <span class="obeylines-h"><code class="verb">IO::out_fileinfo=&#x0022;none&#x0022;</code></span>.
     </p></li>
     <li class="itemize">
     <!--l. 3748--><p class="noindent" >Norms are unfortunately quite insensitive to changes to a few grid points only, even if the changes
     are significant. It is necessary to output grid point values directly, not only norms.
     </p></li>
     <li class="itemize">
     <!--l. 3751--><p class="noindent" >Try to use as few thorns as possible in a test case. For example, do not active 3D output thorns
     (unless you use it). The fewer thorns you use, the easier it is to run the test suite.
     </p></li>
     <li class="itemize">
     <!--l. 3754--><p class="noindent" >It is not necessary that a test suite result is “physically correct”, or that it uses parameters that
     ensure a stable time evolution. A test suite will usually take only a few time steps, so that a grid size
     of, e.g. \(20^3\) grid points <span 
class="cmti-10">without </span>dissipation can be sufficient. Test suites cannot test whether the result
     of a simulation is physically feasible; they only test whether anything changed at all. Ensuring that
     the physics is still correct has to be handled by different mechanisms.</p></li></ul>
                                                                                       
                                                                                       
<!--l. 3767--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C1.9   </span> <a 
 id="x1-120000C1.9"></a>Advanced Thorn Writing</h3>
<!--l. 3771--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.1   </span> <a 
 id="x1-121000C1.9.1"></a>Using Cactus Timers</h4>
<!--l. 3774--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-122000"></a>What are Timers?</h5>
<!--l. 3779--><p class="noindent" >Cactus provides a flexible mechanism for timing different sections of your thorns using various <span 
class="cmti-10">clocks </span>which have
been registered with the flesh. By default, the flesh provides two clocks that measure time in different ways
(provided the underlying functionality is available on your system):
</p><!--l. 3784--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">GetTimeOfDay</span>      </dt><dd 
class="list">
                  <!--l. 3786--><p class="noindent" >Provides “wall clock time” via the unix <span 
class="cmtt-10">gettimeofday </span>function.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">GetrUsage</span>         </dt><dd 
class="list">
                  <!--l. 3788--><p class="noindent" >Provides CPU usage time via the unix <span 
class="cmtt-10">getrusage </span>function.</p></dd></dl>
<!--l. 3792--><p class="noindent" >Additional clocks can be implemented by thorns and registered with the flesh (see Chapter <a 
href="#x1-175000C2.9">C2.9<!--tex4ht:ref: chap:clocks --></a>).
</p><!--l. 3795--><p class="noindent" >To use Cactus timing, you create a <span 
class="cmti-10">timer</span>, which provides time information for all the registered
clocks.
</p><!--l. 3798--><p class="noindent" >You can add any number of timers to your thorn source code, providing each with a name of your choice, and
then use Cactus timing functions to switch on the timers, stop or reset them, and recover timing
information.
</p><!--l. 3802--><p class="noindent" >Setting the flesh parameter <span 
class="cmtt-10">cactus::cctk</span><span 
class="cmtt-10">_timer</span><span 
class="cmtt-10">_output = &#x0022;full&#x0022; </span>will cause some summary timing
information to be printed at the end of a run. Some other thorns have their own timer printing parameters as
well.
</p><!--l. 3806--><p class="noindent" >
</p>
                                                                                       
                                                                                       
<h5 class="subsubsectionHead"><a 
 id="x1-123000"></a>Timing Calls</h5>
<!--l. 3808--><p class="noindent" >Many of the timing calls come in two versions, one whose name ends with the letter <span 
class="cmtt-10">I</span>, and one without. The
calls whose names end with the letter <span 
class="cmtt-10">I </span>refer to the timer or clock by index, which is a non-negative <span 
class="cmtt-10">int </span>value;
the other calls refer to a timer by name. If a timer is created without a name, it can be referred to only by its
index, otherwise, it can be referred to by name or by index.
</p><!--l. 3815--><p class="noindent" >Typically, a negative return value from a timer function indicates an error.
</p><!--l. 3817--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerCreate</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerCreateI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3819--><p class="noindent" >
                  </p><!--l. 3821--><p class="noindent" >Create a timer with a given name, or with no name (respectively) and return a
                  timer index or an error code. Negative return values indicate errors. Only one timer
                  with a given name can exist at any given time.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerDestroy</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerDestroyI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3827--><p class="noindent" >
                  </p><!--l. 3829--><p class="noindent" >Reclaim resources used by a timer.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerStart</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerStartI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3831--><p class="noindent" >
                  </p><!--l. 3833--><p class="noindent" >Start the given timer, using all registered clocks.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerStop</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerStopI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3835--><p class="noindent" >
                  </p><!--l. 3837--><p class="noindent" >Stop the given timer on all registered clocks.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerReset</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerResetI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3839--><p class="noindent" >
                  </p><!--l. 3841--><p class="noindent" >Reset the given timer on all registered clocks.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerCreateData</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerDestroyData</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3843--><p class="noindent" >
                  </p><!--l. 3845--><p class="noindent" >Allocate and reclaim (respectively) resources for a <span class="obeylines-h"><span 
class="cmtt-10">cTimerData</span></span> structure, which
                  will be used to hold clock values.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Timer</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 3848--><p class="noindent" >
                  </p><!--l. 3850--><p class="noindent" >Fill  the  given  <span class="obeylines-h"><span 
class="cmtt-10">cTimerData</span></span> structure  with  clock  values  as  of  the  last  call  to
                  <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerStop</span></span>.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_NumTimers</span></span>    </dt><dd 
class="list">
                  <!--l. 3853--><p class="noindent" >
                  </p><!--l. 3855--><p class="noindent" >Return the number of created timers
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerName</span></span>    </dt><dd 
class="list">
                  <!--l. 3857--><p class="noindent" >
                  </p><!--l. 3859--><p class="noindent" >Return the name of the timer for a given timer index (or <span class="obeylines-h"><span 
class="cmtt-10">NULL</span></span> if the timer is
                  unnamed or any other error occurs).
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_NumTimerClocks</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3862--><p class="noindent" >
                  </p><!--l. 3864--><p class="noindent" >Take a pointer to <span class="obeylines-h"><span 
class="cmtt-10">cTimerData</span></span> and return the number of clocks recorded in a timer
                  measurement
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_GetClockValue</span></span><span 
class="cmss-10">, </span><span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_GetClockValueI</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3867--><p class="noindent" >
                  </p><!--l. 3869--><p class="noindent" >Given a clock referred to by name or index, respectively, and a <span class="obeylines-h"><span 
class="cmtt-10">cTimerData</span></span> pointer,
                  return a <span class="obeylines-h"><span 
class="cmtt-10">cTimerVal</span></span> pointer representing the value of the clock when the timer was
                  stopped
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerClockName</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3873--><p class="noindent" >
                  </p><!--l. 3875--><p class="noindent" >Return the name of the clock given by the <span class="obeylines-h"><span 
class="cmtt-10">cTimerVal</span></span> pointer argument.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerClockResolution</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3877--><p class="noindent" >
                  </p><!--l. 3879--><p class="noindent" >Return the floating-point value of the resolution in seconds of the clock referred to
                  by the <span class="obeylines-h"><span 
class="cmtt-10">cTimerVal</span></span> pointer argument. This is a lower bound for the smallest non-zero
                  difference in values between calls of <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerClockSeconds</span></span>.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerClockSeconds</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 3884--><p class="noindent" >
                  </p><!--l. 3886--><p class="noindent" >Return the floating-point value of the measurement in seconds from the <span class="obeylines-h"><span 
class="cmtt-10">cTimerVal</span></span>
                  pointer argument.
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<!--l. 3891--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-124000"></a>How to Insert Timers in your Code</h5>
<!--l. 3893--><p class="noindent" >The function prototypes and structure definitions are contained in the include file <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_Timers.h</span>, which is
included in the standard thorn header file <span 
class="cmtt-10">cctk.h</span>. At the moment, the timer calls are only available from
C.
</p><!--l. 3898--><p class="noindent" >The following example, which uses a timer to instrument a section of code, illustrates how timers are used by
application thorns. A working example is available in the thorn <span 
class="cmtt-10">CactusTest/TestTimers</span>.
</p><!--l. 3903--><p class="noindent" ><span 
class="cmbx-10">Creating a timer</span>
</p><!--l. 3905--><p class="noindent" >The first action for any timer is to create it, using <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerCreate</span>. This can be performed at any time prior
to use of the timer:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-93">
#include &#x0022;cctk_Timers.h&#x0022;
index = CCTK_TimerCreate(&#x0022;TimeMyStuff&#x0022;);
</pre>
<!--l. 3912--><p class="nopar" >
</p><!--l. 3914--><p class="noindent" ><span 
class="cmbx-10">Instrumenting a section of code</span>
</p><!--l. 3916--><p class="noindent" >Code sections are instrumented using the Start, Stop and Reset functions. These functions are applied to the
chosen timer using all the registered clocks.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-94">
ierr = CCTK_TimerStart(&#x0022;TimeMyStuff&#x0022;);
do_procedure_to_be_timed();
ierr = CCTK_TimerStop(&#x0022;TimeMyStuff&#x0022;);
</pre>
<!--l. 3922--><p class="nopar" >
</p><!--l. 3924--><p class="noindent" ><span 
class="cmbx-10">Accessing the timer results</span>
</p><!--l. 3926--><p class="noindent" >After calling <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TimerStop</span></span>, you then get the time value from any of the registered clocks.
</p><!--l. 3929--><p class="noindent" >The procedure is to allocate a <span class="obeylines-h"><span 
class="cmtt-10">cTimerData</span></span> structure, and read the information from your timer into this
structure using <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Timer</span></span>, then to extract time data of the desired clock from this structure. After using the
structure, you should destroy it.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-95">
  cTimerData *info = CCTK_TimerCreateData();
  int ierr = CCTK_Timer(&#x0022;TimeMyStuff&#x0022;,info);

  /*  You can refer to a particular clock by name.  */
  const cTimerVal   *clock = CCTK_GetClockValue( &#x0022;gettimeofday&#x0022;, info );
  if( clock ){
    printf (&#x0022;\t%s: %.3f %s\n&#x0022;, &#x0022;gettimeofday&#x0022;,
                               CCTK_TimerClockSeconds( clock ), &#x0022;secs&#x0022; );
  }

  /*  To get results from all available clocks, refer to them by index.*/
  nclocks = CCTK_NumTimerClocks( info );

  for (i = 0; i &#x003C; numclocks; i++) {
    const cTimerVal   *clock = CCTK_GetClockValueI( i, info );
    printf (&#x0022;\t%s: %.3f %s\n&#x0022;, CCTK_TimerClockName( clock ),
                               CCTK_TimerClockSeconds( clock ), &#x0022;secs&#x0022; );
  }
  CCTK_TimerDestroyData (info);
</pre>
<!--l. 3954--><p class="nopar" >
</p><!--l. 3958--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.2   </span> <a 
 id="x1-125000C1.9.2"></a>Include Files</h4>
<!--l. 3961--><p class="noindent" >Cactus provides a mechanism for thorns to add code to include files which can be used by any other thorn. Such
include files can contain executable source code, or header/declaration information. A distinction is made
between these two cases, since included executable code is protected from being run if a thorn is compiled, but
not active by being wrapped by a call to <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_IsThornActive</span>.
</p><!--l. 3968--><p class="noindent" >Any thorn which uses the include file must declare this in its <span 
class="cmtt-10">interface.ccl </span>with the line
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">USES</span><span 
class="cmtt-10"> INCLUDE</span><span 
class="cmtt-10"> [SOURCE|HEADER]:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">file_name</span><span 
class="cmtt-10">&#x003E;</span>
                                                                                       
                                                                                       
</div>
</div>
<!--l. 3976--><p class="noindent" >(If the optional <span class="obeylines-h"><code class="verb">[SOURCE|HEADER]</code></span> is omitted, <span class="obeylines-h"><code class="verb">HEADER</code></span> is assumed. Note that this can be dangerous, as included
<span 
class="cmti-10">source </span>code, which is incorrectly assumed to be <span 
class="cmti-10">header </span>code, will be executed in another thorn
<span 
class="cmti-10">even if the providing thorn is inactive</span>. Thus, it is recommended to always include the optional
<span class="obeylines-h"><code class="verb">[SOURCE|HEADER]</code></span> specification.) Any thorn that wishes to add to this include file, declares in its own
<span 
class="cmtt-10">interface.ccl</span>
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">INCLUDE</span><span 
class="cmtt-10"> [SOURCE|HEADER]:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">file_to_include</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> in</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">file_name</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div>
<!--l. 3988--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-126000"></a><span 
class="cmbx-10">Example</span></span>
As an example of this in practice, for the case of Fortran code, consider a thorn A, which wants to gather terms
for a calculation from any thorn that wishes to provide them. Thorn A could have the lines in its source
code
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-96">
c Get source code from other thorns
      allterms = 0d0
#include &#x0022;AllSources.inc&#x0022;
</pre>
<!--l. 4000--><p class="nopar" >and would then add to <span 
class="cmtt-10">interface.ccl </span>the line
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-97">
USES INCLUDE SOURCE: AllSources.inc
</pre>
<!--l. 4004--><p class="nopar" >
</p><!--l. 4006--><p class="noindent" >If thorn B wants to add terms for the calculation, it would create a file, say <span 
class="cmtt-10">Bterms.inc </span>with the
lines
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-98">
c Add this to AllSources.inc
      allterms = allterms + 1d0
</pre>
<!--l. 4011--><p class="nopar" >and would add to its own <span 
class="cmtt-10">interface.ccl</span>
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-99">
INCLUDE SOURCE: Bterms.inc in AllSources.inc
</pre>
<!--l. 4016--><p class="nopar" >
</p><!--l. 4018--><p class="noindent" >The final file for thorn A which is compiled, will contain the code
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-100">
c Get source code from other thorns
      allterms = 0d0
      if (CCTK_IsThornActive(&#x0022;B&#x0022;).ne.0) then
c Add this to AllSources.inc
        allterms = allterms + 1d0
      end if
</pre>
<!--l. 4026--><p class="nopar" >
</p><!--l. 4028--><p class="noindent" >Any Fortran thorn routines which include source code must include the declaration <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_FUNCTIONS</span>.
</p><!--l. 4033--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.3   </span> <a 
 id="x1-127000C1.9.3"></a>Memory Tracing</h4>
<!--l. 4036--><p class="noindent" >Cactus provides a mechanism for overriding the standard C memory allocation routines (<span 
class="cmtt-10">malloc, free, </span>…) with
Cactus specific routines that track the amount of memory allocated, and from where, the allocation call was
made. This information can be accessed by the user to provide an understanding of the memory consumption
between two instances, and to track down possible memory leaks. This feature is available in C
only.
</p><!--l. 4044--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-128000"></a>Activating Memory Tracing</h5>
<a 
 id="x1-128000doc"></a>
<!--l. 4047--><p class="noindent" >Memory tracing has to be activated at configure time. The standard <span 
class="cmtt-10">malloc </span>statements are overridden with
macros (<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_MALLOC</span>). To activate memory tracing use either
</p><!--l. 4051--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">DEBUG=all</span>         </dt><dd 
class="list">
                  <!--l. 4052--><p class="noindent" >Enables all debug options (compiler debug flags, redefines <span 
class="cmtt-10">malloc</span>)
                  </p></dd><dt class="list">
<span 
class="cmtt-10">DEBUG=memory</span>      </dt><dd 
class="list">
                  <!--l. 4054--><p class="noindent" >Redefine <span 
class="cmtt-10">malloc </span>only.</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 4057--><p class="noindent" >The <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_MALLOC </span>statements can also be used directly in the C code. But by employing them this way, only a
fraction of the total memory consumption is traced. Also, they cannot be turned off at configure time. For
example:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-101">
machine&#x003E; gmake bigbuild DEBUG=yes

machine&#x003E; gmake bigbuild-config DEBUG=memory
</pre>
<!--l. 4065--><p class="nopar" >The new configuration <span 
class="cmtt-10">bigbuild </span>is configured with all debugging features turned on. The already existing
configuration <span 
class="cmtt-10">bigbuild </span>is reconfigured with memory tracing only.
</p><!--l. 4070--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-129000"></a>Using Memory Tracing</h5>
<a 
 id="x1-129000doc"></a>
<!--l. 4073--><p class="noindent" >You can request Cactus to store the memory consumption at a certain instance in the program flow, and return
the difference in memory allocation some time later.
</p><!--l. 4077--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">int CCTK</span><span 
class="cmtt-10">_MemTicketRequest(void)</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 4078--><p class="noindent" >Request a ticket: save the current total memory to a database. Return an integer
                  (ticket). Use the ticket to calculate the difference in memory allocation between the
                  two instances in <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_MemTicketCash</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">long int CCTK</span><span 
class="cmtt-10">_MemTicketCash(int your</span><span 
class="cmtt-10">_ticket)</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 4084--><p class="noindent" >Cash in your ticket: return the memory difference between now and the time the
                  ticket was requested. Tickets can be cashed in several times. See example below.
                  This only tracks the real data memory, which is the same as in undebug mode. It
                  does not keep track of the internal allocations done to provide the database, the
                  motivation is that this is not allocated either if you compile undebugged.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">int CCTK</span><span 
class="cmtt-10">_MemTicketDelete(int your</span><span 
class="cmtt-10">_ticket)</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 4093--><p class="noindent" >Delete the memory ticket. The ticket ID will not be reused, since it’s incremented
                  with  every  ticket  request,  but  the  memory  of  the  memory  datastructure  is
                  deallocated.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">unsigned long int CCTK</span><span 
class="cmtt-10">_TotalMemory(void)</span><br 
class="newline" />                  </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 4098--><p class="noindent" >Returns the total allocated memory (not including the tracing data structures).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">void CCTK</span><span 
class="cmtt-10">_MemStat</span> </dt><dd 
class="list">
                  <!--l. 4102--><p class="noindent" >Prints  an  info  string,  stating  the  current,  past,  and  total  memory  (in  bytes)
                  allocation between two successive calls to this routine, as well as the difference.</p></dd></dl>
<!--l. 4107--><p class="noindent" >Sample C code demonstrating the ticket handling. Two tickets are requested during <span 
class="cmtt-10">malloc </span>operations. The
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_MALLOC </span>statement is used directly. They are cashed in, and the memory difference is printed. Ticket 1 is
cashed twice. The tickets are deleted at the end.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-102">
int ticket1;
int ticket2;

/* store current memstate, ticket: t1*/
t1 = CCTK_MemTicketRequest();

/* allocate data */
hi = (int*) CCTK_MALLOC(10*sizeof(int));

/* store current memstate, ticket: t2*/
t2 = CCTK_MemTicketRequest();

/* cash ticket t1, print mem difference */
printf(&#x0022;NOW1a: %+d \n&#x0022;,CCTK_MemTicketCash(t1));

/* allocte some more data */
wo = (CCTK_REAL*)CCTK_MALLOC(10*sizeof(CCTK_REAL));

/* cash ticket t1 and t2, print mem difference */
printf(&#x0022;NOW1b: %+d \n&#x0022;,CCTK_MemTicketCash(t1));
printf(&#x0022;NOW2 : %+d \n&#x0022;,CCTK_MemTicketCash(t2));

/* delete the tickets from the database */
CCTK_MemTicketDelete(t1);
CCTK_MemTicketDelete(t2);

</pre>
<!--l. 4140--><p class="nopar" >
</p><!--l. 4144--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.4   </span> <a 
 id="x1-130000C1.9.4"></a>Calls between Different Programming Languages</h4>
<!--l. 4147--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-131000"></a>Calling C Routines from Fortran</h5>
                                                                                       
                                                                                       
<a 
 id="x1-131000doc"></a>
<!--l. 4150--><p class="noindent" >To make the following C routine,
</p><!--l. 4153--><p class="noindent" ><span 
class="cmtt-10">int &#x003C;routine name&#x003E;(&#x003C;argument list&#x003E;)</span><br 
class="newline" /><br 
class="newline" /><span 
class="cmtt-10">...</span><br 
class="newline" />
</p><!--l. 4159--><p class="noindent" >also callable from Fortran, a new routine must be added, which is declared using the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_FCALL </span>and
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_FNAME </span>macros:
</p><!--l. 4163--><p class="noindent" ><span 
class="cmtt-10">void CCTK</span><span 
class="cmtt-10">_FCALL CCTK</span><span 
class="cmtt-10">_FNAME(&#x003C;routine name&#x003E;)(int *ierr, &#x003C;argument list&#x003E;)</span><br 
class="newline" /><span 
class="cmtt-10">&#x003C;rewrite routine code, or call C routine itself&#x003E;</span>
</p><!--l. 4167--><p class="noindent" >The convention used in Cactus, is that <span 
class="cmtt-10">&#x003C;routine name&#x003E; </span>be the same as any C routine name, and that this is
mixed-case. The macros change the case and number of underscores of the routine name to match that expected
by Fortran.
</p><!--l. 4172--><p class="noindent" >All arguments passed by Fortran to the routine (except strings) are pointers in C, e.g. a call from
Fortran
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-103">
CCTK_INT arg1
CCTK_REAL arg2
CCTK_REAL arg3(30,30,30)

...

call MyCRoutine(arg1,arg2,arg3)
</pre>
<!--l. 4183--><p class="nopar" >
</p><!--l. 4185--><p class="noindent" >should appear in C as
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-104">
void CCTK_FCALL CCTK_FNAME(MyCRoutine)(CCTK_INT *arg1,
                                       CCTK_REAL *arg2,
                                       CCTK_REAL *arg3)
{
...
}
</pre>
<!--l. 4194--><p class="nopar" >
</p><!--l. 4196--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-132000"></a>String Arguments from Fortran</h5>
<!--l. 4198--><p class="noindent" >Fortran passes string arguments in a special, compiler-dependent, way. To facilitate this, the CCTK provides a
set of macros to enable the translation to C strings. The macros are defined in <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_FortranString.h</span>, which
should be included in your C file.
</p><!--l. 4204--><p class="noindent" >String arguments <span 
class="cmti-10">must always come last </span>in the argument list for these macros to be effective (some Fortran
compilers automatically migrate the strings to the end, so there is no portable workaround).
</p><!--l. 4208--><p class="noindent" >The macros to use depend upon the number of string arguments–we currently support up to three. The
macros are <span 
class="cmtt-10">&#x003C;ONE|TWO|THREE&#x003E;</span><span 
class="cmtt-10">_FORTSTRING</span><span 
class="cmtt-10">_ARG</span>. Corresponding to each of these are two macros
<span 
class="cmtt-10">&#x003C;ONE|TWO|THREE&#x003E;</span><span 
class="cmtt-10">_FORTSTRING</span><span 
class="cmtt-10">_CREATE </span>and <span 
class="cmtt-10">&#x003C;ONE|TWO|THREE&#x003E;</span><span 
class="cmtt-10">_FORTSTRING</span><span 
class="cmtt-10">_PTR</span>, which take one, two, or three
arguments depending on the number of strings. The latter set is only necessary if a string is to be modified. In
more detail:
</p><!--l. 4218--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">&#x003C;ONE|TWO|THREE&#x003E;</span><span 
class="cmtt-10">_FORTSTRING</span><span 
class="cmtt-10">_ARG</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 4220--><p class="noindent" >Used in the argument list of the C routine to which the Fortran strings are passed.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">&#x003C;ONE|TWO|THREE&#x003E;</span><span 
class="cmtt-10">_FORTSTRING</span><span 
class="cmtt-10">_CREATE</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 4224--><p class="noindent" >Used in the declaration section of the C routine to which the Fortran strings are
                  passed. These macros have one, two or three arguments which are the variable
                  names you choose to use for the strings in the C routine, created by null-terminating
                  the passed-in Fortran strings. The <span 
class="cmtt-10">CREATE </span>macros create new strings with the names
                  you provide, and thus should be treated as read-only and freed after use.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">&#x003C;ONE|TWO|THREE&#x003E;</span><span 
class="cmtt-10">_FORTSTRING</span><span 
class="cmtt-10">_PTR</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 4233--><p class="noindent" >These macros, used in the declaration section of the C routine <span 
class="cmti-10">after </span>the <span 
class="cmtt-10">CREATE</span>
                  macro, should be used if you need to modify one of the passed-in strings. They
                  declare and define pointers to the passed-in strings.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_strlen&#x003C;1|2|3&#x003E;</span> </dt><dd 
class="list">
                  <!--l. 4239--><p class="noindent" >These  integer  variables,  automatically  defined  by  the  <span 
class="cmtt-10">CREATE </span>macro,  hold  the
                  lengths of the passed in Fortran strings.</p></dd></dl>
<!--l. 4245--><p class="noindent" >The use of the macros is probably best explained with examples. For read-only access to the strings,
only the first two macros are needed, the following example compares two strings passed in from
Fortran.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-105">
#include &#x003C;stdlib.h&#x003E;
#include &#x003C;string.h&#x003E;
#include &#x003C;cctk_FortranString.h&#x003E;

int CCTK_FCALL CCTK_FNAME(CompareStrings)(TWO_FORTSTRING_ARG)
{
  int retval;

  /* Allocate and create C strings with \0 at end. */
  /* This makes variable declarations, so it must be before
     any executable statements.*/

  TWO_FORTSTRING_CREATE(arg1,arg2)

  /* Do some work with the strings */
  retval = strcmp(arg1,arg2);

  /* Important, these must be freed after use */
  free(arg1);
  free(arg2);

  return retval;
}

</pre>
<!--l. 4274--><p class="nopar" >
</p><!--l. 4276--><p class="noindent" >Since the null terminated strings may be copies of the strings passed from Fortran, they should be treated as
read-only.
</p><!--l. 4279--><p class="noindent" >To change the data in a string passed from Fortran, you need to use the <span 
class="cmtt-10">FORTSTRING</span><span 
class="cmtt-10">_PTR </span>macros, which declare
and set up pointers to the strings passed from C. Note that this macro must be used <span 
class="cmti-10">after </span>the
<span 
class="cmtt-10">FORTSTRING</span><span 
class="cmtt-10">_CREATE </span>macro. For example, the following routine copies the contents of the second string to the
first string
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-106">
#include &#x003C;stdlib.h&#x003E;
#include &#x003C;string.h&#x003E;
#include &#x003C;cctk_FortranString.h&#x003E;

int CCTK_FCALL CCTK_FNAME(CopyStrings)(TWO_FORTSTRING_ARG)
{
  int retval;

  /* Allocate and create C strings with \0 at end. */
  /* This makes variable declarations, so it must be before
     any executable statements. */

  TWO_FORTSTRING_CREATE(arg1,arg2)
  TWO_FORTSTRING_PTR(farg1,farg2)

  /* Do some work with the strings */

  retval = strncpy(farg1,arg2,cctk_strlen1);

  /* Important, these must be freed after use */
  free(arg1);
  free(arg2);

  return retval;
}

</pre>
<!--l. 4313--><p class="nopar" >
</p><!--l. 4315--><p class="noindent" >Note that in the example above, two new variables, pointers to the Fortran strings, were created. These are just
pointers and <span 
class="cmti-10">should not be freed</span>. The example also illustrates the automatically-created variables,
e.g. <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_strlen1</span>, which hold the sizes of original Fortran strings. When writing to a string its length should
never be exceeded.
</p><!--l. 4322--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-133000"></a>Calling Fortran Routines from C</h5>
<a 
 id="x1-133000doc"></a>
<!--l. 4325--><p class="noindent" >To call a utility Fortran routine from C, use </p><div class="alltt">
                                                                                       
                                                                                       
<div class="obeylines-v">
<br /><span 
class="cmtt-10">void</span><span 
class="cmtt-10"> CCTK_FCALL</span><span 
class="cmtt-10"> CCTK_FNAME(&#x003C;</span><span 
class="cmsltt-10">Fortran</span><span 
class="cmsltt-10"> routine</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;)(&#x003C;</span><span 
class="cmsltt-10">argument</span><span 
class="cmsltt-10"> list</span><span 
class="cmtt-10">&#x003E;)</span>
</div>
</div>
<!--l. 4330--><p class="noindent" >Note that Fortran expects all arguments (apart from strings) to be pointers, so any non-array data should be
passed by address.
</p><!--l. 4333--><p class="noindent" >Currently, we have no support for calling Fortran routines which expect strings from C. However, passing
routines is supported when you use function aliasing, see Section <a 
href="#x1-134000C1.9.5">C1.9.5<!--tex4ht:ref: sec:function_aliasing --></a>.
</p><!--l. 4338--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.5   </span> <a 
 id="x1-134000C1.9.5"></a>Function aliasing</h4>
<!--l. 4341--><p class="noindent" >Like calling functions in a different language, Cactus offers a mechanism for calling a function in a different
thorn where you don ’t need to know which thorn is actually providing the function, nor what
language the function is provided in. The idea of <span 
class="cmti-10">function aliasing </span>is similar to that of thorns; the
routine that calls a function should not need to know anything about it, except that the function
exists.
</p><!--l. 4349--><p class="noindent" >Function aliasing is quite restrictive, because of the problems involved in inter-language calling, as seen in the
previous section. Function aliasing is also comparatively inefficient, and should not be used in a part of your
code where efficiency is important.
</p><!--l. 4355--><p class="noindent" >Function aliasing is language-neutral, however, the syntax is strongly based on C. In the future, the function
aliasing declarations may go into a new <span 
class="cmtt-10">functions.ccl </span>file, and will have a format more similar to that of
variable group and parameter declarations.
</p><!--l. 4361--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-135000"></a>Using an Aliased Function</h5>
<!--l. 4363--><p class="noindent" >To use an aliased function you must first declare it in your <span 
class="cmtt-10">interface.ccl </span>file. Declare the prototype as, for
example,
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-107">
CCTK_REAL FUNCTION SumStuff(CCTK_REAL IN x, CCTK_REAL IN y)
</pre>
<!--l. 4367--><p class="nopar" >and that this function will be either required in your thorn by
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-108">
REQUIRES FUNCTION SumStuff
</pre>
<!--l. 4371--><p class="nopar" >or optionally used in your thorn by
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-109">
USES FUNCTION SumStuff
</pre>
<!--l. 4375--><p class="nopar" >A prototype of this function will be available to any C routine that includes the <span 
class="cmtt-10">cctk.h </span>header file. In a Fortran
file, the declaration of the function will be included in the <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_FUNCTIONS </span>macro, which is
available after the statement <span 
class="cmtt-10">#include &#x0022;cctk</span><span 
class="cmtt-10">_Functions.h&#x0022;</span>. The keywords <span 
class="cmtt-10">IN</span>, <span 
class="cmtt-10">OUT</span>, and <span 
class="cmtt-10">INOUT </span>work
in the same fashion as <span 
class="cmtt-10">INTENT </span>statements in Fortran 90. That is, the C prototype will expect an
argument with intent <span 
class="cmtt-10">IN </span>to be a value and one with intent <span 
class="cmtt-10">OUT </span>or <span 
class="cmtt-10">INOUT </span>to be a pointer. There also
exists the <span 
class="cmtt-10">ARRAY </span>keyword for passing arrays of any dimension. Functions which are required by
some thorn (which doesn’t provide it itself) are checked at startup to be provided by some other
thorn.
</p><!--l. 4391--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-136000"></a>Providing a Function</h5>
<!--l. 4393--><p class="noindent" >To provide an aliased function you must again add the prototype to your <span 
class="cmtt-10">interface.ccl </span>file. A statement
containing the name of the providing function and the language it is provided in, must also be given. For
example,
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-110">
CCTK_REAL FUNCTION SumStuff(CCTK_REAL IN x, CCTK_REAL IN y)
PROVIDES FUNCTION SumStuff WITH AddItUp LANGUAGE C
</pre>
<!--l. 4400--><p class="nopar" >The appropriate function must then be provided somewhere in this thorn. Multiple thorns providing the same
function can be compiled into the same configuration; however, only one providing thorn may be activated at
runtime, otherwise, an error message is printed and the run is aborted.
</p><!--l. 4406--><p class="noindent" >It is necessary to specify the language of the providing function; no default will be assumed.
</p><!--l. 4410--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-137000"></a>Conventions and Restrictions</h5>
<!--l. 4412--><p class="noindent" >Various restrictions are necessary to make function aliasing work. These are </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4415--><p class="noindent" >The return type of any function must be either <span 
class="cmtt-10">void </span>or one of the Cactus data types <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>or
     <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>. Standard types such as <span 
class="cmtt-10">int </span>are not allowed.
     </p></li>
     <li class="itemize">
     <!--l. 4418--><p class="noindent" >The type of an argument must be one of scalar types <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT, CCTK</span><span 
class="cmtt-10">_REAL, CCTK</span><span 
class="cmtt-10">_COMPLEX,</span>
     <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STRING, CCTK</span><span 
class="cmtt-10">_POINTER, CCTK</span><span 
class="cmtt-10">_FPOINTER</span>,  or  an  array  or  pointer  type  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT ARRAY,</span>
     <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL ARRAY, CCTK</span><span 
class="cmtt-10">_COMPLEX ARRAY, CCTK</span><span 
class="cmtt-10">_POINTER ARRAY</span>.<span class="footnote-mark"><a 
href="UsersGuide8.html#fn5x9"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-137001f5"></a> 
     The scalar types are assumed to be not modifiable. Any changes made to a scalar argument by a
     providing function may be silently lost, or may not; it is dependent on the language of the providing
     and calling function. If you wish to modify an argument, then it must have intent <span 
class="cmtt-10">OUT </span>or <span 
class="cmtt-10">INOUT</span>
     (and hence must be either a <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>, a <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>, or a <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span>, or an array of one of
     these types).
     </p></li>
     <li class="itemize">
     <!--l. 4434--><p class="noindent" >The name of both, the aliased and providing function, are restricted. They must follow the standard
     C semantics (start with a letter, contain only letters, numbers or underscores). Additionally, they
     must be mixed case (that is, contain at least one uppercase and one lowercase letter). The names
     of the aliased and providing functions must be distinct.
     </p></li>
     <li class="itemize">
                                                                                       
                                                                                       
     <!--l. 4440--><p class="noindent" >If an argument is a function pointer, then the syntax looks like
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-111">
     CCTK_REAL Integrate(CCTK_REAL CCTK_FPOINTER  func(CCTK_REAL IN x), \
                         CCTK_REAL IN xmin, CCTK_REAL IN xmax)
</pre>
     <!--l. 4444--><p class="nopar" >It is assumed that the function pointer argument has the same language as the calling function. Function
     pointer arguments may not be nested.
     </p></li>
     <li class="itemize">
     <!--l. 4448--><p class="noindent" ><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STRING </span>arguments follow the same conventions as in the previous section. That is, they must
     appear at the end of the argument list, there must be at most three, and a function with a
     <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STRING </span>argument can only be provided in C, not Fortran, although they may be called from
     either.</p></li></ul>
<!--l. 4456--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-138000"></a>Examples</h5>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4459--><p class="noindent" >A C function is provided to add together two real numbers. The <span 
class="cmtt-10">interface.ccl </span>should read
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-112">
         CCTK_REAL FUNCTION SumStuff(CCTK_REAL IN x, CCTK_REAL IN y)
         PROVIDES FUNCTION SumStuff WITH AddItUp LANGUAGE C
         USES FUNCTION SumStuff
</pre>
     <!--l. 4465--><p class="nopar" >
     </p></li>
     <li class="itemize">
     <!--l. 4467--><p class="noindent" >A Fortran function is provided to invert a real number. The <span 
class="cmtt-10">interface.ccl </span>should read
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-113">
         SUBROUTINE Invert(CCTK_REAL INOUT x)
         PROVIDES FUNCTION Invert WITH FindInverse LANGUAGE Fortran
         USES FUNCTION Invert
</pre>
     <!--l. 4473--><p class="nopar" >Note that <span 
class="cmtt-10">SUBROUTINE </span>has the same meaning as <span 
class="cmtt-10">void FUNCTION</span>.
     </p></li>
     <li class="itemize">
     <!--l. 4477--><p class="noindent" >A Fortran function is provided to integrate any function over an interval. The <span 
class="cmtt-10">interface.ccl </span>should
     read
                                                                                       
                                                                                       
</p>
     <pre class="verbatim" id="verbatim-114">
         CCTK_REAL Integrate(CCTK_REAL CCTK_FPOINTER  func(CCTK_REAL IN x), \
                             CCTK_REAL IN xmin, CCTK_REAL IN xmax)
         PROVIDES FUNCTION Integrate WITH SimpsonsRule LANGUAGE Fortran
         USES FUNCTION Integrate
</pre>
     <!--l. 4484--><p class="nopar" >
</p>
     </li></ul>
<!--l. 4488--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-139000"></a>Testing Aliased Functions</h5>
<!--l. 4490--><p class="noindent" >The calling thorn does not know if an aliased function is even provided by another thorn. Calling an aliased
function that has not been provided, will lead to a level 0 warning message, stopping the code. In order to check
if a function has been provided by some thorn, use the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_IsFunctionAliased </span>function described in the
function reference section.
</p><!--l. 4499--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.6   </span> <a 
 id="x1-140000C1.9.6"></a>Naming Conventions</h4>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4503--><p class="noindent" > Thorn names must not start with the word “Cactus” (in any case).
     </p></li>
     <li class="itemize">
     <!--l. 4505--><p class="noindent" > Arrangements will be ignored if their names start with a hash mark ‘<span 
class="cmtt-10">#</span>’ or dot ‘<span 
class="cmtt-10">.</span>’, or end with a
     tilde ‘<span 
class="cmtt-10">~</span>’, <span 
class="cmtt-10">.bak </span>or <span 
class="cmtt-10">.BAK</span>.
     </p></li>
     <li class="itemize">
     <!--l. 4508--><p class="noindent" > Thorns will be ignored if they are called doc or start with a hash mark ‘<span 
class="cmtt-10">#</span>’ or dot ‘<span 
class="cmtt-10">.</span>’, or end with
     a tilde ‘<span 
class="cmtt-10">~</span>’, <span 
class="cmtt-10">.bak </span>or <span 
class="cmtt-10">.BAK</span>.
                                                                                       
                                                                                       
     </p></li>
     <li class="itemize">
     <!--l. 4511--><p class="noindent" > Routine names have to be unique among all thorns.
     </p></li>
     <li class="itemize">
     <!--l. 4512--><p class="noindent" > Names of global variables have to be unique among all thorns.
</p>
     </li></ul>
<!--l. 4518--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.7   </span> <a 
 id="x1-141000C1.9.7"></a>General Naming Conventions</h4>
<!--l. 4520--><p class="noindent" >The following naming conventions are followed by the flesh and the supported Cactus arrangements. They are
not compulsory, but if followed, will allow for a homogeneous code.
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4526--><p class="noindent" >Parameters: lower case (except for acronyms) with words separated by an underscore. Examples:
     <span 
class="cmtt-10">my</span><span 
class="cmtt-10">_first</span><span 
class="cmtt-10">_parameter</span>, <span 
class="cmtt-10">solve</span><span 
class="cmtt-10">_PDE</span><span 
class="cmtt-10">_equation</span>.
     </p></li>
     <li class="itemize">
     <!--l. 4530--><p class="noindent" >Routine names and names of global variables: Prefixed by thorn name with an underscore, then
     capitalised words, with no spaces. Fortran modules should be placed into source files that have the
     same name as the module (see section <a 
href="#x1-90000doc">C1.6.2.0.0<!--tex4ht:ref: par:fortran_modules --></a> for details). Examples: <span 
class="cmtt-10">MyThorn</span><span 
class="cmtt-10">_StartUpRoutine</span>,
     <span 
class="cmtt-10">BestSolver</span><span 
class="cmtt-10">_InitialDataForPDE</span>, <span 
class="cmtt-10">BestSolver</span><span 
class="cmtt-10">_SpectralGrid</span>.
</p>
     </li></ul>
<!--l. 4541--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.9.8   </span> <a 
 id="x1-142000C1.9.8"></a>Data Types and Sizes</h4>
<!--l. 4545--><p class="noindent" >Cactus knows about the following fixed size data types:
</p>
                                                                                       
                                                                                       
<div class="center" 
>
<!--l. 4547--><p class="noindent" >
</p>
<div class="tabular"> <table id="TBL-5" class="tabular" 
 
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1" /></colgroup><colgroup id="TBL-5-2g"><col 
id="TBL-5-2" /></colgroup><colgroup id="TBL-5-3g"><col 
id="TBL-5-3" /></colgroup><colgroup id="TBL-5-4g"><col 
id="TBL-5-4" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-1-1"  
class="td11"> Data Type         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-1-2"  
class="td11"> Size (bytes)  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-1-3"  
class="td11"> Variable Type                   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-1-4"  
class="td11"> Fortran Equivalent  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-2-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_BYTE</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-2-2"  
class="td11"> 1                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-2-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_BYTE</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-2-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">integer*1</span></span>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-3-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT1</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-3-2"  
class="td11"> 1                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-3-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_INT1</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-3-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">integer*1</span></span>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-4-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT2</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-4-2"  
class="td11"> 2                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-4-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_INT2</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-4-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">integer*2</span></span>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-5-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT4</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-5-2"  
class="td11"> 4                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-5-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_INT4</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-5-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">integer*4</span></span>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-6-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT8</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-6-2"  
class="td11"> 8                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-6-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_INT8</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-6-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">integer*8</span></span>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-7-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL4</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-7-2"  
class="td11"> 4                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-7-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_REAL4</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-7-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">real*4</span></span>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-8-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL8</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-8-2"  
class="td11"> 8                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-8-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_REAL8</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-8-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">real*8</span></span>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-9-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL16</span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-9-2"  
class="td11"> 16              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-9-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_REAL16</span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-9-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">real*16</span></span>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-10-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX8</span></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-10-2"  
class="td11"> 8                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-10-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_COMPLEX8</span></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-10-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">complex*8</span></span>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-11-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX16</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-11-2"  
class="td11"> 16              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-11-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_COMPLEX16</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-11-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">complex*16</span></span>       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-12-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX32</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-12-2"  
class="td11"> 32              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-12-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_COMPLEX32</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-5-12-4"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">complex*32</span></span>       </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-5-13-1"  
class="td11">                </td>
</tr></table>                                                                                       </div></div>
<!--l. 4567--><p class="noindent" >The availability of these types, and the corresponding C data types, are platform-dependent. For each fixed-size
data type, there exists a corresponding preprocessor macro <span class="obeylines-h"><span 
class="cmtt-10">HAVE</span><span 
class="cmtt-10">_&#x003C;data type&#x003E;</span></span>, which should be used to check
whether the given CCTK data type is supported, e.g. 
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-115">
  /* declare variable with extended-precision complex data type if available,
     otherwise, with default CCTK precision */
  #ifdef HAVE_CCTK_COMPLEX32
  CCTK_COMPLEX32 var;
  #else
  CCTK_COMPLEX   var;
  #endif
</pre>
<!--l. 4580--><p class="nopar" >
</p><!--l. 4582--><p class="noindent" >In addition, Cactus provides three generic numeric data types which map onto the compilers’ native data types
used to represent integer, real, and complex values. The size for these generic types can be chosen at
configuration time (see Section <a 
href="#x1-20000B2.1.1">B2.1.1<!--tex4ht:ref: subsec:Compilation-Available_Options --></a>). This is to allow the code to be run easily at different precisions. Note
that the effectiveness of running the code, at a lower or higher precision, depends crucially on all thorns being
used making consistent use of the these generic data types:
</p>
<div class="center" 
>
<!--l. 4590--><p class="noindent" >
</p>
<div class="tabular"> <table id="TBL-6" class="tabular" 
 
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1" /></colgroup><colgroup id="TBL-6-2g"><col 
id="TBL-6-2" /></colgroup><colgroup id="TBL-6-3g"><col 
id="TBL-6-3" /></colgroup><colgroup id="TBL-6-4g"><col 
id="TBL-6-4" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-6-1-1"  
class="td11"> Data Type     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-1-2"  
class="td11"> Variable Type                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-1-3"  
class="td11"> Configuration Option   </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-6-2-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-2-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_INT</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-2-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">INTEGER</span><span 
class="cmtt-10">_PRECISION</span></span>   </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-6-3-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-3-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_REAL</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-3-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">REAL</span><span 
class="cmtt-10">_PRECISION</span></span> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-6-4-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-4-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_COMPLEX</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-6-4-3"  
class="td11"> Same as real precision  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-6-5-1"  
class="td11">              </td>
</tr></table>                                                                                       </div></div>
<!--l. 4603--><p class="noindent" >These variable types must be used by thorn writers to declare variables in the thorn interface files, and may be
used to declare variables in the thorn routines. Note that variable declarations in thorns should obviously match
the definitions in the interface files where appropriate.
</p><!--l. 4609--><p class="noindent" >A set of macros, which are interpreted by the preprocessor at compile time, to signify which data size is being
used, are also provided:
</p>
<div class="center" 
>
<!--l. 4613--><p class="noindent" >
</p>
                                                                                       
                                                                                       
<div class="tabular"> <table id="TBL-7" class="tabular" 
 
><colgroup id="TBL-7-1g"><col 
id="TBL-7-1" /></colgroup><colgroup id="TBL-7-2g"><col 
id="TBL-7-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-1-1"  
class="td11"> Data Type         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-1-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">#define</span></span>                   </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-2-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT1</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-2-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_1</span></span>      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-3-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT2</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-3-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_2</span></span> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-4-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT4</span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-4-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_4</span></span>      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-5-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT8</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-5-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_8</span></span> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-6-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL4</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-6-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_4</span></span>     </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-7-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL8</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-7-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_8</span></span> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-8-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL16</span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-8-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_16</span></span>    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-9-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX8</span></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-9-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_8</span></span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-10-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX16</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-10-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_16</span></span> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-11-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX32</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-7-11-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_COMPLEX</span><span 
class="cmtt-10">_PRECISION</span><span 
class="cmtt-10">_32</span></span> </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-12-1"  
class="td11">                </td>
</tr></table>                                                                                       </div></div>
<!--l. 4632--><p class="noindent" >Cactus also provides generic data and function pointers, which can be used from either C or Fortran:
</p>
<div class="center" 
>
<!--l. 4635--><p class="noindent" >
</p>
<div class="tabular"> <table id="TBL-8" class="tabular" 
 
><colgroup id="TBL-8-1g"><col 
id="TBL-8-1" /></colgroup><colgroup id="TBL-8-2g"><col 
id="TBL-8-2" /></colgroup><colgroup id="TBL-8-3g"><col 
id="TBL-8-3" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-8-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-8-1-1"  
class="td11"> Data Type                    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-1-2"  
class="td11"> Variable Type                              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-1-3"  
class="td11"> C equivalent                 </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-8-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-8-2-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POINTER</span></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-2-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_POINTER</span></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-2-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">void *data</span><span 
class="cmtt-10">_ptr</span></span>       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-8-3-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POINTER</span><span 
class="cmtt-10">_TO</span><span 
class="cmtt-10">_CONST</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-3-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_POINTER</span><span 
class="cmtt-10">_TO</span><span 
class="cmtt-10">_CONST</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-3-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">const void *data</span><span 
class="cmtt-10">_ptr</span></span> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-8-4-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_FPOINTER</span></span>         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-4-2"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VARIABLE</span><span 
class="cmtt-10">_FPOINTER</span></span>         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-8-4-3"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">void (*fn</span><span 
class="cmtt-10">_ptr)(void)</span></span> </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-8-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-8-5-1"  
class="td11">                       </td>
</tr></table>                                                                                       </div></div>
<!--l. 4658--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-143000"></a>Fortran Thorn Writers</h5>
<!--l. 4660--><p class="noindent" >Cactus provides the data types <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POINTER </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POINTER</span><span 
class="cmtt-10">_TO</span><span 
class="cmtt-10">_CONST </span>for use in Fortran code to declare a
pointer passed from C. For example, the variable <span 
class="cmtt-10">cctkGH </span>is of the type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POINTER</span>. The data type
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STRING </span>is, in Fortran, also an opaque type; it corresponds to a C pointer, and one has to use the function
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_FortranString </span>to convert it to a Fortran string, or the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Equals </span>to compare it to a Fortran
String.
</p><!--l. 4669--><p class="noindent" >Since the data types, <span 
class="cmtt-10">integer </span>in Fortran and <span 
class="cmtt-10">int </span>in C, may be
different<span class="footnote-mark"><a 
href="UsersGuide9.html#fn6x9"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-143001f6"></a> ,
many routines that can be called from both, C and Fortran, take arguments of the type <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>. This type can
be different from the type <span 
class="cmtt-10">integer</span>. Fortran does not convert routine arguments automatically, and it is,
therefore, necessary to pay attention to the exact argument types that a routine expects, and to convert between
<span 
class="cmtt-10">integer </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>, accordingly. Currently, most flesh functions take <span 
class="cmtt-10">integer </span>arguments, while all aliased
functions take <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT </span>arguments.
     </p><blockquote class="quote">
                                                                                       
                                                                                       
     <!--l. 4682--><p class="noindent" >NOTE:  If  you  make  errors  in  passing  Fortran  arguments,  and  if  there  are  no  interfaces
     (“prototypes”) available for the routines that are called, then the compiler cannot detect these
     errors. Be careful, when you write Fortran code yourself, consider placing routines in modules,
     which implicitly define interfaces for all contained routines.</p></blockquote>
<!--l. 4690--><p class="noindent" >There are two convenient ways to convert between these types. An easy way, is to define parameters or to declare
variables of the desired type, assign a value to these parameters or variables, and then pass the parameter or
value. This makes for very readable code, since the name of the parameter or variable serves as additional
documentation:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-116">
CCTK_INT, parameter : jtwo = 2
integer  :: vindex_gxx, vindex_kxx
CCTK_INT :: syncvars(jtwo)

call CCTK_VarIndex (vindex_gxx, &#x0022;ADMBase::gxx&#x0022;)
call CCTK_VarIndex (vindex_kxx, &#x0022;ADMBase::kxx&#x0022;)

syncvars(1) = vindex_gxx
syncvars(2) = vindex_kxx
call CCTK_SyncGroupsI (cctkGH, jtwo, syncvars)
</pre>
<!--l. 4707--><p class="nopar" >
</p><!--l. 4709--><p class="noindent" >(You have probably seen the strange Fortran convention, where people introduce constants named <span 
class="cmtt-10">zero </span>or
<span 
class="cmtt-10">two</span>—it is a convenient way to make sure that the constant has the correct type.)
</p><!--l. 4713--><p class="noindent" >Another possibility are explicit type conversions. They can rather easily be added to existing code:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-117">
! Boilerplate code to determine type kinds
integer,  parameter :: izero = 0   ! A dummy variable of type integer
CCTK_INT, parameter :: jzero = 0   ! A dummy variable of type CCTK_ITN
integer,  parameter :: ik = kind (izero)   ! The kind of &#x0022;integer&#x0022;
integer,  parameter :: jk = kind (jzero)   ! The kind of &#x0022;CCTK_INT&#x0022;

integer :: syncvars(2)

call CCTK_VarIndex (syncvars(1), &#x0022;ADMBase::gxx&#x0022;)
call CCTK_VarIndex (syncvars(2), &#x0022;ADMBase::kxx&#x0022;)

call CCTK_SyncGroupsI (cctkGH, int(2,jk), int(syncvars,jk))
</pre>
<!--l. 4729--><p class="nopar" >
</p><!--l. 4731--><p class="noindent" >Fortran distinguishes between different integer <span 
class="cmti-10">kinds</span>. These kinds are what is different between <span 
class="cmtt-10">integer </span>and
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>. The expression <span 
class="cmtt-10">int(EXPR,KIND) </span>converts <span 
class="cmtt-10">EXPR </span>to an integer of kind <span 
class="cmtt-10">KIND</span>. Above, we use the
convention that the prefix <span 
class="cmtt-10">i </span>denotes things having to do with <span 
class="cmtt-10">integer</span>, and the prefix <span 
class="cmtt-10">j </span>denotes
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>.
</p><!--l. 4739--><p class="noindent" >Note that we declare the array <span 
class="cmtt-10">syncvars </span>with the type that is necessary to set its values. Type conversions are
only possible if variables are read, not when they are written to.
</p>
<h3 class="sectionHead"><span class="titlemark">C1.10   </span> <a 
 id="x1-144000C1.10"></a>Telling the Make system What to Do</h3>
<!--l. 4751--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.10.1   </span> <a 
 id="x1-145000C1.10.1"></a>Basic Recipe</h4>
<!--l. 4755--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.10.2   </span> <a 
 id="x1-146000C1.10.2"></a>Make Concepts</h4>
                                                                                       
                                                                                       
<!--l. 4759--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.10.3   </span> <a 
 id="x1-147000C1.10.3"></a>The Four Files</h4>
<!--l. 4763--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C1.10.4   </span> <a 
 id="x1-148000C1.10.4"></a>How your code is built</h4>
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter C2</span><br /><a 
 id="x1-149000C2"></a>Infrastructure Thorns</h2>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 21--><p class="noindent" > Concepts and terminology (Overloading and registration of functions)
     </p></li>
     <li class="itemize">
     <!--l. 22--><p class="noindent" > The cGH structure — what it is and how to use it
     </p></li>
     <li class="itemize">
     <!--l. 23--><p class="noindent" > Extending the cGH structure
     </p></li>
     <li class="itemize">
     <!--l. 24--><p class="noindent" > Querying group and variable information
     </p></li>
     <li class="itemize">
     <!--l. 25--><p class="noindent" > Providing an I/O layer
     </p></li>
     <li class="itemize">
     <!--l. 26--><p class="noindent" > Providing a communication layer
     </p></li>
     <li class="itemize">
     <!--l. 27--><p class="noindent" > Providing a reduction operator
     </p></li>
     <li class="itemize">
     <!--l. 28--><p class="noindent" > Providing an interpolation operator
     </p></li>
     <li class="itemize">
     <!--l. 29--><p class="noindent" > Overloadable functions</p></li></ul>
<h3 class="sectionHead"><span class="titlemark">C2.1   </span> <a 
 id="x1-150000C2.1"></a>Concepts and Terminology</h3>
<!--l. 35--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.1.1   </span> <a 
 id="x1-151000C2.1.1"></a>Overloading and Registration</h4>
                                                                                       
                                                                                       
<!--l. 37--><p class="noindent" >The flesh defines a core API which guarantees the presence of a set of functions. Although the flesh guarantees
the presence of these functions, they can be provided by thorns. Thorns do this by either the <span 
class="cmti-10">overloading </span>or the
<span 
class="cmti-10">registration </span>of functions.
</p><!--l. 42--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-152000"></a>Overloading</h5>
<!--l. 44--><p class="noindent" >Some functions can only be provided by one thorn. The first thorn to <span 
class="cmti-10">overload </span>this function succeeds, and any
later attempt to overload the function fails. For each overloadable function, there is a function with a name
something like <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Overload... </span>which is passed the function pointer.
</p><!--l. 50--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-153000"></a>Registration</h5>
<!--l. 52--><p class="noindent" >Some functions may be provided by several thorns. The thorns <span 
class="cmti-10">register </span>their function with the flesh, and when
the flesh-provided function is called, the flesh calls all the registered functions.
</p><!--l. 56--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.1.2   </span> <a 
 id="x1-154000C2.1.2"></a>GH Extensions</h4>
<!--l. 58--><p class="noindent" >A GH extension is a way to associate data with each cGH. This data should be data that is required to be
associated with a particular GH by a thorn.
</p><!--l. 61--><p class="noindent" >Each GH extension is given a unique handle.
</p><!--l. 63--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.1.3   </span> <a 
 id="x1-155000C2.1.3"></a>I/O Methods</h4>
<!--l. 65--><p class="noindent" >An I/O method is a distinct way to output data. Each I/O method has a unique name, and the flesh-provided
I/O functions operate on all registered I/O methods.
                                                                                       
                                                                                       
</p><!--l. 68--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.2   </span> <a 
 id="x1-156000C2.2"></a>GH Extensions</h3>
<!--l. 70--><p class="noindent" >A GH extension is created by calling <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RegisterGHExtension</span>, with the name of the extension. This returns
a unique handle that identifies the extension. (This handle can be retrieved at any time by a call to
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_GHExtensionHandle</span>.)
</p><!--l. 74--><p class="noindent" >Associated with a GH extension are three functions
</p><!--l. 76--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">SetupGH</span>           </dt><dd 
class="list">
                  <!--l. 77--><p class="noindent" >this is used to actually create the data structure holding the extension. It is called
                  when a new cGH is created.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">InitGH</span>            </dt><dd 
class="list">
                  <!--l. 80--><p class="noindent" >this is used to initialise the extension. It is called after the scheduler has been
                  initialised on the cGH.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">ScheduleTraverseGH</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 83--><p class="noindent" >this is called whenever the schedule tree is due to be traversed on the GH. It should
                  initialise the data on the cGH and the call <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ScheduleTraverse </span>to traverse the
                  schedule tree.</p></dd></dl>
<!--l. 89--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.3   </span> <a 
 id="x1-157000C2.3"></a>Overloadable and Registerable Functions in Main</h3>
<div class="tabular"> <table id="TBL-9" class="tabular" 
 
><colgroup id="TBL-9-1g"><col 
id="TBL-9-1" /></colgroup><colgroup id="TBL-9-2g"><col 
id="TBL-9-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-9-1-1"  
class="td11"> <span 
class="cmbx-10">Function          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-1-2"  
class="td11"> <span 
class="cmbx-10">Default  </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-9-2-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Initialise</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-2-2"  
class="td11"> </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-9-3-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Evolve</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-3-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-9-4-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Shutdown</span></span>   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-9-4-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-9-5-1"  
class="td11">                 </td>
</tr></table>                                                                                       </div>
<!--l. 99--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.4   </span> <a 
 id="x1-158000C2.4"></a>Overloadable and Registerable Functions in Comm</h3>
                                                                                       
                                                                                       
<div class="tabular"> <table id="TBL-10" class="tabular" 
 
><colgroup id="TBL-10-1g"><col 
id="TBL-10-1" /></colgroup><colgroup id="TBL-10-2g"><col 
id="TBL-10-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-1-1"  
class="td11"> <span 
class="cmbx-10">Function                      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-1-2"  
class="td11"> <span 
class="cmbx-10">Default  </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-2-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroup</span></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-2-2"  
class="td11">         </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-3-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroupsByDirI</span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-3-2"  
class="td11">         </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-4-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EnableGroupStorage</span></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-4-2"  
class="td11">         </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-5-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DisableGroupStorage</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-5-2"  
class="td11">         </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-6-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_QueryMaxTimeLevels</span></span>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-6-2"  
class="td11">         </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-7-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EnableGroupComm</span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-7-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-8-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DisableGroupComm</span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-8-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-9-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Barrier</span></span>             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-9-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-10-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Reduce</span></span>              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-10-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-11-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Interp</span></span>              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-11-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-12-1"  
class="td11"> <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ParallelInit</span></span>        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-10-12-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-10-13-1"  
class="td11">                          </td>
</tr></table>                                                                                       </div>
<!--l. 117--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.5   </span> <a 
 id="x1-159000C2.5"></a>Overloadable and Registerable Functions in I/O</h3>
<div class="tabular"> <table id="TBL-11" class="tabular" 
 
><colgroup id="TBL-11-1g"><col 
id="TBL-11-1" /></colgroup><colgroup id="TBL-11-2g"><col 
id="TBL-11-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-11-1-1"  
class="td11"> <span 
class="cmbx-10">Function                      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-1-2"  
class="td11"> <span 
class="cmbx-10">Default  </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-11-2-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputGH</span></span>            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-2-2"  
class="td11">         </td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-11-3-1"  
class="td11">
 <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputVarAsByMethod</span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-11-3-2"  
class="td11">         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-11-4-1"  
class="td11">                          </td>
</tr></table>                                                                                       </div>
<!--l. 126--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.6   </span> <a 
 id="x1-160000C2.6"></a>Drivers</h3>
<!--l. 128--><p class="noindent" >The flesh does not know about memory allocation for grid variables, about how to communicate data when
synchronisation is called for, or about multiple patches or adaptive mesh refinement. All this is the job of a
driver.
</p><!--l. 132--><p class="noindent" >This chapter describes how to add a driver to your code.
</p><!--l. 134--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.6.1   </span> <a 
 id="x1-161000C2.6.1"></a>Anatomy</h4>
<!--l. 136--><p class="noindent" >A driver consists of a Startup routine which creates a GH extension, registers its associated functions, and
overloads the communication functions. It may optionally register interpolation, reduction, and I/O
methods.
</p><!--l. 140--><p class="noindent" >A driver may also overload the default Initialisation and Evolution routines, although a simple unigrid evolver is
supplied in the flesh.
                                                                                       
                                                                                       
</p><!--l. 143--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.6.2   </span> <a 
 id="x1-162000C2.6.2"></a>Startup</h4>
<!--l. 145--><p class="noindent" >A driver consists of a GH extension, and the following overloaded functions.
</p><!--l. 148--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-162002x1">
     <!--l. 149--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EnableGroupStorage</span>
     </p></li>
<li 
  class="enumerate" id="x1-162004x2">
     <!--l. 150--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DisableGroupStorage</span>
     </p></li>
<li 
  class="enumerate" id="x1-162006x3">
     <!--l. 151--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_QueryMaxTimeLevels</span>
     </p></li>
<li 
  class="enumerate" id="x1-162008x4">
     <!--l. 152--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ArrayGroupSizeB</span>
     </p></li>
<li 
  class="enumerate" id="x1-162010x5">
     <!--l. 153--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_QueryGroupStorageB</span>
     </p></li>
<li 
  class="enumerate" id="x1-162012x6">
     <!--l. 154--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroup</span>
     </p></li>
<li 
  class="enumerate" id="x1-162014x7">
     <!--l. 155--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroupsByDirI</span>
     </p></li>
<li 
  class="enumerate" id="x1-162016x8">
     <!--l. 156--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EnableGroupComm</span>
     </p></li>
<li 
  class="enumerate" id="x1-162018x9">
     <!--l. 157--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DisableGroupComm</span>
                                                                                       
                                                                                       
     </p></li>
<li 
  class="enumerate" id="x1-162020x10">
     <!--l. 158--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_Barrier</span>
     </p></li>
<li 
  class="enumerate" id="x1-162022x11">
     <!--l. 159--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OverloadParallelInit</span>
     </p></li>
<li 
  class="enumerate" id="x1-162024x12">
     <!--l. 160--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OverloadExit</span>
     </p></li>
<li 
  class="enumerate" id="x1-162026x13">
     <!--l. 161--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OverloadAbort</span>
     </p></li>
<li 
  class="enumerate" id="x1-162028x14">
     <!--l. 162--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OverloadMyProc</span>
     </p></li>
<li 
  class="enumerate" id="x1-162030x15">
     <!--l. 163--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OverloadnProcs</span></p></li></ol>
<!--l. 166--><p class="noindent" >The overloadable function <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroup </span>is deprecated, a driver should instead provide a routine to overload
the more general function <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SyncGroupsByDirI</span>.
</p><!--l. 170--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.6.3   </span> <a 
 id="x1-163000C2.6.3"></a>The GH Extension</h4>
<!--l. 172--><p class="noindent" >The GH extension is where the driver stores all its grid-dependent information. This is stuff like any data
associated with a grid variable (e.g. storage and communication state), how many grids if it is AMR, ... It is
very difficult to describe in general, but one simple example might be
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-118">

struct SimpleExtension
{
  /* The data associated with each variable */
  /* data[var][timelevel][ijk]                */
  void ***data
} ;

</pre>
<!--l. 186--><p class="nopar" >
</p><!--l. 188--><p class="noindent" >with a <span 
class="cmtt-10">SetupGH </span>routine like
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-119">

struct SimpleExtension *SimpleSetupGH(tFleshConfig *config, int conv_level, cGH *GH)
{
   struct SimpleExtension *extension;

   extension = NULL;

   if(conv_level &#x003C; max_conv_level)
   {
      /* Create the extension */
      extension = malloc(sizeof(struct SimpleExtension));

      /* Allocate data for all the variables */
      extension-&#x003E;data = malloc(num_vars*sizeof(void**));

      for(var = 0 ; var &#x003C; num_vars; var++)
      {
        /* Allocate the memory for the time levels */
        extension-&#x003E;data[var] = malloc(num_var_time_levels*sizeof(void *));

        for(time_level = 0; time_level &#x003C; num_var_time_level; time_level++)
        {
          /* Initialise the data to NULL */
          extension-&#x003E;data[var][time_level] = NULL;
        }
      }
    }

   return extension;
}

</pre>
<!--l. 222--><p class="nopar" >
</p><!--l. 224--><p class="noindent" >Basically, what this example is doing is preparing a data array for use. The function can query the flesh for
information on every variable. Note that scalars should always have memory actually assigned to
them.
</p><!--l. 228--><p class="noindent" >An <span 
class="cmtt-10">InitGH </span>function isn’t strictly necessary, and in this case, it could just be a dummy function.
</p><!--l. 231--><p class="noindent" >The <span 
class="cmtt-10">ScheduleTraverseGH </span>function needs to fill out the cGH data, and then call <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ScheduleTraverse </span>to
have the functions scheduled at that point executed on the grid
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-120">

int SimpleScheduleTraverseGH(cGH *GH, const char *where)
{
  int retcode;
  int  var;
  int  gtype;
  int  ntimelevels;
  int  level;
  int  idir;

  extension = (struct SimpleExtension *)GH-&#x003E;extensions[SimpleExtension];

#ifdef CCTK_HAVE_CGH_LEVEL
  GH-&#x003E;cctk_level = 0;
#endif
#ifdef CCTK_HAVE_CGH_COMPONENT
  GH-&#x003E;cctk_component = extension-&#x003E;myproc;
#endif
  for (idir=0;idir&#x003C;GH-&#x003E;cctk_dim;idir++)
  {
    GH-&#x003E;cctk_levfac[idir] = 1;
    GH-&#x003E;cctk_nghostzones[idir] = extension-&#x003E;nghostzones[idir];
    GH-&#x003E;cctk_lsh[idir]         = extension-&#x003E;lnsize[idir];
    GH-&#x003E;cctk_gsh[idir]         = extension-&#x003E;nsize[idir];
    GH-&#x003E;cctk_bbox[2*idir]      = extension-&#x003E;lb[extension-&#x003E;myproc][idir] == 0;
    GH-&#x003E;cctk_bbox[2*idir+1]    = extension-&#x003E;ub[extension-&#x003E;myproc][idir]
                              == extension-&#x003E;nsize[idir]-1;
    GH-&#x003E;cctk_lbnd[idir]        = extension-&#x003E;lb[extension-&#x003E;myproc][idir];
    GH-&#x003E;cctk_ubnd[idir]        = extension-&#x003E;ub[extension-&#x003E;myproc][idir];
#ifdef CCTK_HAVE_CGH_TILE
    GH-&#x003E;cctk_tile_min[idir]    = extension-&#x003E;tmin[extension-&#x003E;myproc][idir];
    GH-&#x003E;cctk_tile_max[idir]    = extension-&#x003E;tmax[extension-&#x003E;myproc][idir];
#endif

  }

  for(var = 0; var &#x003C; extension-&#x003E;nvariables; var++)
  {
    gtype = CCTK_GroupTypeFromVarI(var);
    ntimelevels = CCTK_MaxTimeLevelsVI(var);

    for(level = 0; level &#x003C; ntimelevels; level++)
    {
      switch(gtype)
      {
                                                                                       
                                                                                       
        case CCTK_SCALAR :
          GH-&#x003E;data[var][level] = extension-&#x003E;variables[var][level];
          break;
        case CCTK_GF     :
          GH-&#x003E;data[var][level] =
            ((pGF ***)(extension-&#x003E;variables))[var][level]-&#x003E;data;
          break;
        case CCTK_ARRAY :
          GH-&#x003E;data[var][level] =
            ((pGA ***)(extension-&#x003E;variables))[var][level]-&#x003E;data;
          break;
        default:
          CCTK_WARN(CCTK_WARN_ALERT,&#x0022;Unknown group type in SimpleScheduleTraverse&#x0022;);
      }
    }
  }

  retcode = CCTK_ScheduleTraverse(where, GH, NULL);

  return retcode;

}

</pre>
<!--l. 304--><p class="nopar" >
</p><!--l. 306--><p class="noindent" >The third argument to <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ScheduleTraverse </span>is actually a function which will be called by the scheduler
when it wants to call a function scheduled by a thorn. This function is given some information about the
function to call, and is an alternative place where the cGH can be setup.
</p><!--l. 311--><p class="noindent" >This function is optional, but a simple implementation might be
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-121">

int SimpleCallFunction(void *function,
                       cFunctionData *fdata,
                       void *data)
{
  void (*standardfunc)(void *);

  int (*noargsfunc)(void);

  switch(fdata-&#x003E;type)
  {
    case FunctionNoArgs:
      noargsfunc = (int (*)(void))function;
      noargsfunc();
      break;
    case FunctionStandard:
      switch(fdata-&#x003E;language)
      {
        case LangC:
          standardfunc = (void (*)(void *))function;
          standardfunc(data);
          break;
        case LangFortran:
          fdata-&#x003E;FortranCaller(data, function);
          break;
        default :
          CCTK_WARN(CCTK_WARN_ALERT, &#x0022;Unknown language.&#x0022;);
      }
      break;
    default :
      CCTK_WARN(CCTK_WARN_ALERT, &#x0022;Unknown function type.&#x0022;);
  }

  /* Return 0, meaning didn’t synchronise */
  return 0;
}

</pre>
<!--l. 351--><p class="nopar" >
</p><!--l. 353--><p class="noindent" >The return code of the function signifies whether or not the function synchronised the groups in this functions
synchronisation list of not.
</p><!--l. 356--><p class="noindent" >The flesh will synchronise them if the function returns false.
                                                                                       
                                                                                       
</p><!--l. 358--><p class="noindent" >Providing this function is probably the easiest way to do multi-patch or AMR drivers.
</p><!--l. 361--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.6.4   </span> <a 
 id="x1-164000C2.6.4"></a>Memory Functions</h4>
<!--l. 363--><p class="noindent" >These consist of
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-164002x1">
     <!--l. 365--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EnableGroupStorage</span>
     </p></li>
<li 
  class="enumerate" id="x1-164004x2">
     <!--l. 366--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DisableGroupStorage</span>
     </p></li>
<li 
  class="enumerate" id="x1-164006x3">
     <!--l. 367--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_QueryMaxTimeLevels</span>
     </p></li>
<li 
  class="enumerate" id="x1-164008x4">
     <!--l. 368--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_QueryGroupStorageB</span>
     </p></li>
<li 
  class="enumerate" id="x1-164010x5">
     <!--l. 369--><p class="noindent" > <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ArrayGroupSizeB</span></p></li></ol>
<!--l. 372--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-165000"></a>En/Disable Group Storage</h5>
<!--l. 374--><p class="noindent" >These are responsible for switching the memory for all variables in a group on or off. They should return the
former state, e.g. if the group already has storage assigned, they should return 1.
</p><!--l. 378--><p class="noindent" >In our simple example above, the enabling routine would look something like
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-122">

int SimpleEnableGroupStorage(cGH *GH, const char *groupname)
{

  extension = (struct SimpleExtension *)GH-&#x003E;extensions[SimpleExtension];

  if(extension-&#x003E;data[first][0][0] == NULL)
  {
    for(var = first; var &#x003C;= last; var++)
    {
      allocate memory for all time levels;
    }
    retcode = 0;
  }
  else
  {
    retcode = 1;
  }

  return retcode;
}

</pre>
<!--l. 404--><p class="nopar" >
</p><!--l. 406--><p class="noindent" >The disable function is basically the reverse of the enable one.
</p><!--l. 408--><p class="noindent" >The <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_QueryMaxTimeLevels </span>function returns the maximum number of timelevels ever activated for a given
group ie. the size of the <span 
class="cmtt-10">data </span>member of <span 
class="cmtt-10">cGH</span>.
</p><!--l. 412--><p class="noindent" >The <span 
class="cmtt-10">QueryGroupStorage </span>function basically returns true or false if there is storage for the group, and the
<span 
class="cmtt-10">ArrayGroupSize </span>returns the size of the grid function or array group in a particular direction.
</p><!--l. 416--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-166000"></a>En/Disable Group Comm</h5>
<!--l. 418--><p class="noindent" >These are the communication analogues to the storage functions. Basically, they flag that communication is to
be done on that group or not, and may initialise data structures for the communication.
                                                                                       
                                                                                       
</p><!--l. 423--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.7   </span> <a 
 id="x1-167000C2.7"></a>I/O Methods</h3>
<!--l. 426--><p class="noindent" >The flesh by itself does not provide output for grid variables or other data. Instead, it provides a mechanism for
thorns to register their own routines as I/O methods, and to invoke these I/O methods by either the flesh
scheduler or by other thorn routines.
</p><!--l. 431--><p class="noindent" >This chapter explains how to implement your own I/O methods and register them with the flesh.
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.7.1   </span> <a 
 id="x1-168000C2.7.1"></a>I/O Method Registration</h4>
<!--l. 436--><p class="noindent" >All I/O methods have to be registered with the flesh before they can be used.
</p><!--l. 438--><p class="noindent" >The flesh I/O registration API provides a routine <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RegisterIOMethod()</span></span> to create a handle for a new I/O
method which is identified by its name (this name must be unique for all I/O methods). With such a handle, a
thorn can then register a set of functions (using the <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RegisterIOMethod*()</span></span> routines from the flesh) for
doing periodic, triggered, and/or unconditional output.
</p><!--l. 445--><p class="noindent" >The following example shows how a thorn would register an I/O method, <span 
class="cmtt-10">SimpleIO</span>, with routines to provide all
these different types of output.
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-123">
  void SimpleIO_Startup (void)
  {
    int handle = CCTK_RegisterIOMethod (&#x0022;SimpleIO&#x0022;);
    if (handle &#x003E;= 0)
    {
      CCTK_RegisterIOMethodOutputGH (handle, SimpleIO_OutputGH);

      CCTK_RegisterIOMethodTimeToOutput (handle, SimpleIO_TimeToOutput);
      CCTK_RegisterIOMethodTriggerOutput (handle, SimpleIO_TriggerOutput);

      CCTK_RegisterIOMethodOutputVarAs (handle, SimpleIO_OutputVarAs);
    }
  }
</pre>
<!--l. 462--><p class="nopar" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.7.2   </span> <a 
 id="x1-169000C2.7.2"></a>Periodic Output of Grid Variables</h4>
<!--l. 467--><p class="noindent" >The flesh scheduler will automatically call <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputGH()</span></span> at every iteration after the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS </span>time
bin. This function loops over all I/O methods and calls their routines registered as <span class="obeylines-h"><span 
class="cmtt-10">OutputGH()</span></span> (see also Section
<a 
href="#x1-51000doc">C1.2.3.0<!--tex4ht:ref: subsec:schedule_ccl --></a>). </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> int</span><span 
class="cmtt-10"> SimpleIO_OutputGH</span><span 
class="cmtt-10"> (const</span><span 
class="cmtt-10"> cGH</span><span 
class="cmtt-10"> *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">);</span>
</div>
</div> The <span class="obeylines-h"><span 
class="cmtt-10">OutputGH()</span></span> routine itself should loop over all variables living on the <span 
class="cmtt-10">GH </span>grid hierarchy, and do all necessary
output if requested (this is usually determined by I/O parameter settings).
<!--l. 480--><p class="noindent" >As its return code, it should pass back the number of variables which were output at the current iteration, or
zero if no output was done by this I/O method.
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.7.3   </span> <a 
 id="x1-170000C2.7.3"></a>Triggered Output of Grid Variables</h4>
<!--l. 486--><p class="noindent" >Besides the periodic output at every so many iterations using <span class="obeylines-h"><span 
class="cmtt-10">OutputGH()</span></span>, analysis and output of grid variables
                                                                                       
                                                                                       
can also be done via triggers. For this, a <span class="obeylines-h"><span 
class="cmtt-10">TimeToOutput()</span></span> routine is registered with an I/O method.
This routine will be called by the flesh scheduler at every iteration before <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS </span>with the
triggering variable(s) as defined in the schedule block for all <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS </span>routines (see Section
<a 
href="#x1-80000C1.5.4">C1.5.4<!--tex4ht:ref: scheduling:schedule_block --></a>).
</p><!--l. 493--><p class="noindent" >If the <span class="obeylines-h"><span 
class="cmtt-10">TimeToOutput()</span></span> routine decides that it is now time to do output, the flesh scheduler will invoke the
corresponding analysis routine and also request output of the triggering variable(s) using <span class="obeylines-h"><span 
class="cmtt-10">TriggerOutput()</span></span>.
</p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> int</span><span 
class="cmtt-10"> SimpleIO_TimeToOutput</span><span 
class="cmtt-10"> (const</span><span 
class="cmtt-10"> cGH</span><span 
class="cmtt-10"> *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10"> int</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">varindex</span><span 
class="cmtt-10">);</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> int</span><span 
class="cmtt-10"> SimpleIO_TriggerOutput</span><span 
class="cmtt-10"> (const</span><span 
class="cmtt-10"> cGH</span><span 
class="cmtt-10"> *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10"> int</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">varindex</span><span 
class="cmtt-10">);</span>
</div>
</div> Both routines get passed the index of a possible triggering grid variable.
<div class="obeylines-v"><span 
class="cmtt-10">TimeToOutput()</span></div> should return a non-zero value if analysis and output for <span 
class="cmsltt-10">varindex </span>should take place at the
current iteration, and zero otherwise.
<div class="obeylines-v"><span 
class="cmtt-10">TriggerOutput()</span></div> should return zero for successful output of variable <span 
class="cmsltt-10">varindex</span>, and a negative value in case of
an error.
<h4 class="subsectionHead"><span class="titlemark">C2.7.4   </span> <a 
 id="x1-171000C2.7.4"></a>Unconditional Output of Grid Variables</h4>
<!--l. 514--><p class="noindent" >An I/O method’s <span class="obeylines-h"><span 
class="cmtt-10">OutputVarAs()</span></span> routine is supposed to do output for a specific grid variable if ever possible. It
will be invoked by the flesh I/O API routines <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_OutputVar*()</span></span> for unconditional, non-triggered output of
grid variables (see also Section <a 
href="#x1-108000C1.7.3">C1.7.3<!--tex4ht:ref: sec:io --></a>).
</p><!--l. 519--><p class="noindent" >A function registered as an <span 
class="cmtt-10">OutputVarAs() </span>routine has the following prototype: </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> int</span><span 
class="cmtt-10"> SimpleIO_OutputVarAs</span><span 
class="cmtt-10"> (const</span><span 
class="cmtt-10"> cGH</span><span 
class="cmtt-10"> *</span><span 
class="cmsltt-10">GH</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10"> const</span><span 
class="cmtt-10"> char</span><span 
class="cmtt-10"> *</span><span 
class="cmsltt-10">varname</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10"> const</span><span 
class="cmtt-10"> char</span><span 
class="cmtt-10"> *</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">);</span>
</div>
</div> The variable to output, <span 
class="cmsltt-10">varname</span>, is given by its full name. The full name may have appended an optional I/O
options string enclosed in curly braces (with no space between the full name and the opening curly brace). In
addition to that, an <span 
class="cmsltt-10">alias </span>string can be passed which then serves the purpose of constructing a unique name for
the output file.
<!--l. 532--><p class="noindent" >The <span class="obeylines-h"><span 
class="cmtt-10">OutputVarAs()</span></span> routine should return zero if output for <span 
class="cmsltt-10">varname </span>was done successfully, or a negative error
code otherwise.
                                                                                       
                                                                                       
</p><!--l. 538--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.8   </span> <a 
 id="x1-172000C2.8"></a>Checkpointing/Recovery Methods</h3>
<!--l. 541--><p class="noindent" >Like for I/O methods, checkpointing/recovery functionality must be implemented by thorns. The flesh only
provides specific time bins at which the scheduler will call thorns’ routines, in order to perform checkpointing
and/or recovery.
</p><!--l. 545--><p class="noindent" >This chapter explains how to implement checkpointing and recovery methods in your thorn. For further
information, see the documentation for thorn <span 
class="cmtt-10">CactusBase/IOUtil</span>.
</p><!--l. 549--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.8.1   </span> <a 
 id="x1-173000C2.8.1"></a>Checkpointing Invocation</h4>
<!--l. 551--><p class="noindent" >Thorns register their checkpointing routines at <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CPINITIAL</span></span> and/or <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CHECKPOINT</span></span> and/or
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TERMINATE</span></span>. These time bins are scheduled right after all initial data has been set up, after every evolution
timestep, and after the last time step of a simulation, respectively. (See Section <a 
href="#x1-51000doc">C1.2.3.0<!--tex4ht:ref: subsec:schedule_ccl --></a> for a description of all
timebins). Depending on parameter settings, the checkpoint routines decide whether to write an initial data
checkpoint, and when to write an evolution checkpoint.
</p><!--l. 560--><p class="noindent" >Each checkpoint routine should save all information to persistent storage, which is necessary to
restart the simulation at a later time from exactly the same state. Such information would include
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 565--><p class="noindent" >the current settings of all parameters
     </p></li>
     <li class="itemize">
     <!--l. 566--><p class="noindent" >the  contents  of  all  grid  variables  which  have  global  storage  assigned  and  are  not  tagged  with
     <span 
class="cmtt-10">checkpoint=&#x0022;no&#x0022; </span>(see also Section <a 
href="#x1-184000D2.2.4">D2.2.4<!--tex4ht:ref: subsec:Appendix.interface-variables --></a> on page <a 
href="#x1-184000D2.2.4">D16<!--tex4ht:ref: subsec:Appendix.interface-variables --></a> for a list of possible tags)<br 
class="newline" />Note that grid variables should be synced before writing them to disk.
     </p></li>
     <li class="itemize">
     <!--l. 569--><p class="noindent" >other relevant information such as the current iteration number and physical time, the number of
     processors, etc.</p></li></ul>
<!--l. 574--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">C2.8.2   </span> <a 
 id="x1-174000C2.8.2"></a>Recovery Invocation</h4>
                                                                                       
                                                                                       
<!--l. 576--><p class="noindent" >Recovering from a checkpoint is a two-phase operation for which the flesh provides distinct timebins for recovery
routines to be scheduled at:
                  </p><dl class="list1"><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_PARAMETERS</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 580--><p class="noindent" >This time bin is executed before <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span></span>, in which the parameter file is
                  parsed. From these parameter settings, the recovery routines should decide whether
                  recovery was requested, and if so, restore all parameters from the checkpoint file
                  and overwrite those which aren’t steerable.<br 
class="newline" />The flesh loops over all registered recovery routines to find out whether recovery was
                  requested. Each recovery routine should, therefore, return a positive integer value
                  for successful parameter recovery (causing a shortcut of the loop over all registered
                  recovery routines), zero for no recovery, or a negative value to flag an error.<br 
class="newline" />If recovery was requested, but no routine could successfully recover parameters,
                  the flesh will abort the run with an error message. If no routine recovered any
                  parameters, i.e. if all parameter recovery routines returned zero, then this indicates
                  that this run is not a recovery run.<br 
class="newline" />If                                         parameter                                         recovery
                  was performed successfully, the scheduler will set the <span 
class="cmtt-10">recovered </span>flag which—in
                  combination with the setting of the <span 
class="cmtt-10">Cactus::recovery</span><span 
class="cmtt-10">_mode </span>parameter—decides
                  whether any thorn routine scheduled for <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INITIAL</span></span> and <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTINITIAL</span></span>
                  will be called. The default is to not execute these initial time bins during recovery,
                  because the initial data will be set up from the checkpoint file during the following
                  <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_VARIABLES</span></span> time bin.
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_VARIABLES</span></span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 602--><p class="noindent" >Recovery  routines  scheduled  for  this  time  bin  are  responsible  for  restoring  the
                  contents of all grid variables with storage assigned from the checkpoint.<br 
class="newline" />Depending on the setting of <span 
class="cmtt-10">Cactus::recovery</span><span 
class="cmtt-10">_mode</span>, they should also decide how
                  to treat errors in recovering individual grid variables. Strict recovery (which is the
                  default) requires all variables to be restored successfully (and will stop the code
                  if not), whereas a relaxed mode could, e.g. allow for grid variables, which are not
                  found in the checkpoint file, to be gracefully ignored during recovery.</p></dd></dl>
<!--l. 616--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">C2.9   </span> <a 
 id="x1-175000C2.9"></a>Clocks for Timing</h3>
<!--l. 619--><p class="noindent" >To add a Cactus clock, you need to write several functions to provide the timer functionality (see Section
<a 
href="#x1-121000C1.9.1">C1.9.1<!--tex4ht:ref: sec:timers --></a>), and then register these functions with the flesh as a named clock.
</p><!--l. 623--><p class="noindent" >The function pointers are placed in function pointer fields of a <span 
class="cmtt-10">cClockFuncs </span>structure. The fields of this
structure are are:
</p><!--l. 626--><p class="noindent" >
                                                                                       
                                                                                       
                  </p><dl class="list1"><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">create</span></span>            </dt><dd 
class="list">
                  <!--l. 628--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void *(*create)(int)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">destroy</span></span>           </dt><dd 
class="list">
                  <!--l. 629--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void (*destroy)(int, void *)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">start</span></span>             </dt><dd 
class="list">
                  <!--l. 630--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void (*start)(int, void *)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">stop</span></span>              </dt><dd 
class="list">
                  <!--l. 631--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void (*stop)(int, void *)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">reset</span></span>             </dt><dd 
class="list">
                  <!--l. 632--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void (*reset)(int, void *)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">get</span></span>               </dt><dd 
class="list">
                  <!--l. 633--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void (*get)(int, void *, cTimerVal *)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">set</span></span>               </dt><dd 
class="list">
                  <!--l. 634--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">void (*set)(int, void *, cTimerVal *)</span></span>
                  </p></dd><dt class="list">
<span class="obeylines-h"><span 
class="cmtt-10">n</span><span 
class="cmtt-10">_vals</span></span>            </dt><dd 
class="list">
                  <!--l. 635--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">int</span></span>
</p>
                  </dd></dl>
<!--l. 639--><p class="noindent" >The first <span 
class="cmtt-10">int </span>argument of the functions may be used in any way you see fit.
</p><!--l. 642--><p class="noindent" >The <span 
class="cmtt-10">n</span><span 
class="cmtt-10">_vals </span>field holds the number of elements in the <span 
class="cmtt-10">vals </span>array field of the <span 
class="cmtt-10">cTimerVal </span>structure used by your
timer (usually 1).
</p><!--l. 646--><p class="noindent" >The return value of the <span 
class="cmtt-10">create </span>function will be a pointer to a new structure representing your
clock.
</p><!--l. 649--><p class="noindent" >The second <span 
class="cmtt-10">void* </span>argument of all the other functions will be the pointer returned from the <span 
class="cmtt-10">create</span>
function.
</p><!--l. 652--><p class="noindent" >The <span 
class="cmtt-10">get </span>and <span 
class="cmtt-10">set </span>functions should write to and read from (respectively) a structure pointed to by the
<span 
class="cmtt-10">cTimerVal* </span>argument:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-124">
typedef enum {val_none, val_int, val_long, val_double} cTimerValType;

typedef struct
{
  cTimerValType type;
  const char *heading;
  const char *units;
  union
 {
    int        i;
    long int   l;
    double     d;
  } val;
  double seconds;
  double resolution;
} cTimerVal;
</pre>
<!--l. 672--><p class="nopar" >
</p><!--l. 674--><p class="noindent" >The <span 
class="cmtt-10">heading </span>field is the name of the clock, the <span 
class="cmtt-10">units </span>field holds a string describing the type held in the <span 
class="cmtt-10">val</span>
field, and the <span 
class="cmtt-10">seconds </span>field is the time elapsed in seconds. The <span 
class="cmtt-10">resolution </span>field is the smallest non-zero
difference in values of two calls to the timer, in seconds. For example, it could reflect that the clock saves the
time value internally as an integer value representing milliseconds.
</p><!--l. 682--><p class="noindent" >To name and register the clock with the flesh, call the function </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10"> CCTK_ClockRegister(</span><span 
class="cmtt-10"> &#x0022;</span><span 
class="cmsltt-10">my_clock_name</span><span 
class="cmtt-10">&#x0022;,</span><span 
class="cmtt-10"> &#x0026;</span><span 
class="cmsltt-10">clock_func</span><span 
class="cmtt-10"> ).</span>
</div>
</div>
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
<h1 class="partHead"><span class="titlemark">Part D<br /></span><a 
 id="x1-176000D"></a>Appendices</h1>
<!--l. 11--><p class="noindent" >
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter D1</span><br /><a 
 id="x1-177000D1"></a>Glossary</h2>
                  <dl class="list1"><dt class="list">
<span 
class="cmss-10">alias function</span>        </dt><dd 
class="list">
                  <!--l. 24--><p class="noindent" >See <span 
class="cmti-10">function aliasing</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">AMR</span>              </dt><dd 
class="list">
                  <!--l. 26--><p class="noindent" ><span 
class="cmti-10">Automatic Mesh Refinement</span>
                  </p></dd><dt class="list">
<span 
class="cmss-10">analysis</span>            </dt><dd 
class="list">
                  <!--l. 28--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">API</span>               </dt><dd 
class="list">
                  <!--l. 29--><p class="noindent" ><span 
class="cmti-10">Applications  Programming  Interface</span>,  the  interface  provided  by  some  software
                  component to programmers who use the component. An API usually consists of
                  subroutine/function calls, but may also include structure definitions and definition
                  of constant values. The Cactus Reference Manual documents most of the Cactus
                  flesh APIs.
                  </p></dd><dt class="list">
<span 
class="cmss-10">arrangement</span>        </dt><dd 
class="list">
                  <!--l. 35--><p class="noindent" >A  collection  of  thorns,  stored  in  a  subdirectory  of  the  Cactus  <span class="obeylines-h"><code class="verb">arrangements</code></span>
                  directory. See Section <a 
href="#x1-42000C1.1.2">C1.1.2<!--tex4ht:ref: sec:arrangements --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">autoconf</span>           </dt><dd 
class="list">
                  <!--l. 38--><p class="noindent" >A GNU program which builds a configuration script which can be used to make a
                  Makefile.
                  </p></dd><dt class="list">
<span 
class="cmss-10">boundary zone</span>       </dt><dd 
class="list">
                  <!--l. 41--><p class="noindent" >A  boundary  zone  is  a  set  of  points  at  the  edge  of  a  grid,  interpreted  as  the
                  boundary of the physical problem, and which contains boundary data, e.g. Dirichlet
                  conditions or von Neumann conditions. (See also <span 
class="cmti-10">symmetry zone</span>, <span 
class="cmti-10">ghost zone</span>.)
                  </p></dd><dt class="list">
<span 
class="cmss-10">Cactus</span>             </dt><dd 
class="list">
                  <!--l. 46--><p class="noindent" >Distinctive and unusual plant, which is adapted to extremely arid and hot environments,
                  showing  a  wide  range  of  anatomical  and  physiological  features  which  conserve
                  water. Cacti stems have expanded into green succulent structures containing the
                  chlorophyll necessary for life and growth, while the leaves have become the spines for
                  which cacti are so well known.<span class="footnote-mark"><a 
href="UsersGuide10.html#fn1x11"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-177001f1"></a> 
                  </p></dd><dt class="list">
<span 
class="cmss-10">CCTK</span>             </dt><dd 
class="list">
                  <!--l. 50--><p class="noindent" ><span 
class="cmti-10">Cactus Computational Tool Kit </span>(The Cactus flesh and computational thorns).
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmss-10">CCL</span>               </dt><dd 
class="list">
                  <!--l. 53--><p class="noindent" >The  <span 
class="cmti-10">Cactus  Configuration  Language</span>,  this  is  the  language  that  the  thorn
                  configuration files are written in. See Section <a 
href="#x1-178000D2">D2<!--tex4ht:ref: sec:Appendix.ccl --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">configuration</span>        </dt><dd 
class="list">
                  <!--l. 58--><p class="noindent" >The combination of a set of thorns, and all the Cactus configure options which affect
                  what binary will be produced when compiling Cactus. For example, the choice of
                  compilers and linker (Cactus <span class="obeylines-h"><code class="verb">CC</code></span>, <span class="obeylines-h"><code class="verb">CXX</code></span>, <span class="obeylines-h"><code class="verb">CUCC</code></span>, <span class="obeylines-h"><code class="verb">F90</code></span>, and <span class="obeylines-h"><code class="verb">LD</code></span> configure options) and
                  the compiler optimization settings (<span class="obeylines-h"><code class="verb">OPTIMISE</code></span>/<span class="obeylines-h"><code class="verb">OPTIMIZE</code></span> and <span class="obeylines-h"><code class="verb">*_OPTIMISE_FLAGS</code></span>
                  configure options) are part of a configuration (these flags change what binary is
                  produced), but the Cactus <span class="obeylines-h"><code class="verb">VERBOSE</code></span> and <span class="obeylines-h"><code class="verb">WARN</code></span> configure options aren’t part of a
                  configuration (they don’t change what binary will be produced). See Section <a 
href="#x1-6000A1.2.1">A1.2.1<!--tex4ht:ref: sec:configurations --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">checkout</span>           </dt><dd 
class="list">
                  <!--l. 70--><p class="noindent" >Get a copy of source code from git. See Section <a 
href="#x1-3000A1.1">A1.1<!--tex4ht:ref: sec:checkout --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">checkpoint</span>          </dt><dd 
class="list">
                  <!--l. 72--><p class="noindent" >Save the entire state of a Cactus run to a file, so that the run can be restarted at
                  a later time. See Sections <a 
href="#x1-11000A3">A3<!--tex4ht:ref: sec:checkpointing --></a>, <a 
href="#x1-172000C2.8">C2.8<!--tex4ht:ref: chap:cp_recovery_methods --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">computational grid</span>   </dt><dd 
class="list">
                  <!--l. 76--><p class="noindent" >A  discrete  finite  set  of  spatial  points  in  \(\Re ^n\)  (typically,  \(1 \le n \le 3\)).  Historically,  Cactus  has
                  required these points to be uniformly spaced (uniformly spaced grid), but now,
                  Cactus  supports  non-uniform  spacings  (non-uniformly  spaced  grid),  and  mesh
                  refinement.
                  </p><!--l. 83--><p class="noindent" >The grid consists of the physical domain and the boundary and symmetry points.
                  </p><!--l. 86--><p class="noindent" >See <span 
class="cmti-10">grid functions </span>for the typical use of grid points.
                  </p></dd><dt class="list">
<span 
class="cmss-10">convergence</span>        </dt><dd 
class="list">
                  <!--l. 87--><p class="noindent" >Important, but often neglected.
                  </p></dd><dt class="list">
<span 
class="cmss-10">CST</span>               </dt><dd 
class="list">
                  <!--l. 89--><p class="noindent" >The <span 
class="cmti-10">Cactus Specification Tool</span>, which is the set of Perl scripts which parse the thorns’
                  <span 
class="cmtt-10">.ccl </span>files, and generates the code that binds the thorn source files with the flesh.
                  </p></dd><dt class="list">
<span 
class="cmss-10">git</span>                </dt><dd 
class="list">
                  <!--l. 93--><p class="noindent" ><span 
class="cmti-10">git </span>is the favoured code distribution system for Cactus. See Section <a 
href="#x1-3000A1.1">A1.1<!--tex4ht:ref: sec:checkout --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">domain decomposition</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 96--><p class="noindent" >The technique of breaking up a large computational problem into parts that are
                  easier to solve. In Cactus, it refers especially to a decomposition wherein the parts
                  are solved in parallel on separate computer processors.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmss-10">driver</span>              </dt><dd 
class="list">
                  <!--l. 100--><p class="noindent" >A special kind of thorn which creates and handles grid hierarchies and grid variables.
                  Drivers  are  responsible  for  memory  management  for  grid  variables,  and  for  all
                  parallel operations, in response to requests from the scheduler. See Section <a 
href="#x1-101000C1.6.3">C1.6.3<!--tex4ht:ref: sec:parallelisation --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">evolution</span>           </dt><dd 
class="list">
                  <!--l. 107--><p class="noindent" >An iteration interpreted as a step through time. Also, a particular Cactus schedule
                  bin for executing routines when evolution occurs.
                  </p></dd><dt class="list">
<span 
class="cmss-10">flesh</span>               </dt><dd 
class="list">
                  <!--l. 110--><p class="noindent" >The Cactus routines which hold the thorns together, allowing them to communicate
                  and scheduling things to happen with them. This is what you get if you check out
                  Cactus from our git repository.
                  </p></dd><dt class="list">
<span 
class="cmss-10">friend</span>              </dt><dd 
class="list">
                  <!--l. 114--><p class="noindent" >Interfaces that are <span 
class="cmti-10">friends</span>, share their collective set of protected grid variables. See
                  Section <a 
href="#x1-180000D2.2">D2.2<!--tex4ht:ref: sec:Appendix.interface --></a> <a 
href="#x1-49000doc">C1.2.3.0<!--tex4ht:ref: subsec:interface_ccl --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">function aliasing</span>     </dt><dd 
class="list">
                  <!--l. 117--><p class="noindent" >The process of referring to a function to be provided by an interface independently
                  of which thorn actually contains the function, or what language the function is
                  written in. The function is called an <span 
class="cmti-10">alias function</span>. See Section <a 
href="#x1-134000C1.9.5">C1.9.5<!--tex4ht:ref: sec:function_aliasing --></a>, <a 
href="#x1-183000D2.2.3">D2.2.3<!--tex4ht:ref: subsec:Appendix.interface.function_aliasing --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">GA</span>                </dt><dd 
class="list">
                  <!--l. 123--><p class="noindent" >Shorthand for a <span 
class="cmti-10">grid array</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">GF</span>                </dt><dd 
class="list">
                  <!--l. 125--><p class="noindent" >Shorthand for a <span 
class="cmti-10">grid function</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">gmake</span>             </dt><dd 
class="list">
                  <!--l. 127--><p class="noindent" >GNU version of the <span 
class="cmtt-10">make </span>utility.
                  </p></dd><dt class="list">
<span 
class="cmss-10">ghost zone</span>          </dt><dd 
class="list">
                  <!--l. 129--><p class="noindent" >A set of points added for parallelisation purposes to a block of a grid lying on one
                  processor, corresponding to points on the boundary of an adjoining block of the grid
                  lying on another processor. Points from the boundary of the one block are copied
                  (via an inter-processor communication mechanism) during synchronisation to the
                  corresponding ghost zone of the other block, and vice versa. In single processor
                  runs there are no ghost zones. Contrast with symmetry or boundary zones. See
                  Section <a 
href="#x1-64000C1.3.5">C1.3.5<!--tex4ht:ref: sec:ghost_size --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid</span>               </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 139--><p class="noindent" >Short for <span 
class="cmti-10">computational grid</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid array</span>           </dt><dd 
class="list">
                  <!--l. 141--><p class="noindent" >A <span 
class="cmti-10">grid variable </span>whose global size need not be that of the computational grid; instead,
                  the size is declared explicitly in an <span class="obeylines-h"><code class="verb">interface.ccl</code></span> file.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid function</span>        </dt><dd 
class="list">
                  <!--l. 145--><p class="noindent" >A <span 
class="cmti-10">grid variable </span>whose global size is the size of the computational grid. (See also <span 
class="cmti-10">local</span>
                  <span 
class="cmti-10">array</span>.) From another perspective, <span 
class="cmti-10">grid functions </span>are functions (of any of the Cactus
                  data types (see Section <a 
href="#x1-142000C1.9.8">C1.9.8<!--tex4ht:ref: sect-ThornWriting/DataTypes --></a>) defined on the domain of grid points. Typically,
                  grid functions are used to discretely approximate functions defined on the domain
                  \(\Re ^n\), with <span 
class="cmti-10">finite differencing </span>used to approximate partial derivatives.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid hierarchy</span>       </dt><dd 
class="list">
                  <!--l. 155--><p class="noindent" >A <span 
class="cmti-10">computational grid</span>, and the <span 
class="cmti-10">grid variables </span>associated with it.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid point</span>          </dt><dd 
class="list">
                  <!--l. 158--><p class="noindent" >A spatial point in the <span 
class="cmti-10">computational grid</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid scalar</span>          </dt><dd 
class="list">
                  <!--l. 160--><p class="noindent" >A <span 
class="cmti-10">grid variable </span>with index zero, i.e. just a number on each processor.
                  </p></dd><dt class="list">
<span 
class="cmss-10">grid variable</span>        </dt><dd 
class="list">
                  <!--l. 163--><p class="noindent" >A variable which is passed through the flesh interface, either between thorns or
                  between routines of the same thorn. This implies the variable is related to the
                  computational grid, as opposed to being an internal variable of the thorn or one
                  of its routines. <span 
class="cmti-10">grid scalar</span>, <span 
class="cmti-10">grid function</span>, and <span 
class="cmti-10">grid array </span>are all examples of <span 
class="cmti-10">grid</span>
                  <span 
class="cmti-10">variables</span>. See Sections <a 
href="#x1-61000C1.3.2">C1.3.2<!--tex4ht:ref: sec:cactus_variables-groups --></a>, <a 
href="#x1-184000D2.2.4">D2.2.4<!--tex4ht:ref: subsec:Appendix.interface-variables --></a>
                  </p></dd><dt class="list">
<span 
class="cmss-10">GNATS</span>            </dt><dd 
class="list">
                  <!--l. 172--><p class="noindent" >The  GNU  program  we  use  for  reporting  and  tracking  bugs,  comments  and
                  suggestions.
                  </p></dd><dt class="list">
<span 
class="cmss-10">GNU</span>              </dt><dd 
class="list">
                  <!--l. 175--><p class="noindent" ><span 
class="cmti-10">GNU’s Not Unix</span>: a freely-distributable code project. See <a 
href="http://www.gnu.org/" class="url" ><span 
class="cmtt-10">http://www.gnu.org/</span></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">GV</span>                </dt><dd 
class="list">
                  <!--l. 178--><p class="noindent" >Shorthand for <span 
class="cmti-10">grid variable</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">handle</span>             </dt><dd 
class="list">
                  <!--l. 180--><p class="noindent" >A signed integer value \(&gt;= 0\) passed by many Cactus routines and used to represent a
                  dynamic data or code object.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmss-10">HDF5</span>             </dt><dd 
class="list">
                  <!--l. 183--><p class="noindent" ><span 
class="cmti-10">Hierarchical Data Format </span>version 5, an API, subroutine library, and file format for
                  storing structured data. An HDF5 file can store both data (for example, Cactus
                  grid variables), and meta data (data describing the other data, for example, Cactus
                  coordinate systems). See Section <a 
href="#x1-21000B2.2">B2.2<!--tex4ht:ref: subsec:cowiexpa --></a>, also <a 
href="https://www.hdfgroup.org/HDF5/" class="url" ><span 
class="cmtt-10">https://www.hdfgroup.org/HDF5/</span></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">implementation</span>      </dt><dd 
class="list">
                  <!--l. 191--><p class="noindent" >Defines the interface that a thorn presents to the rest of a Cactus program. See
                  Section <a 
href="#x1-43000C1.1.3">C1.1.3<!--tex4ht:ref: sec:implementations --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">inherit</span>             </dt><dd 
class="list">
                  <!--l. 194--><p class="noindent" >A  thorn  that  <span 
class="cmti-10">inherits  </span>from  another  implementation  can  access  all  the  other
                  implementation’s public variables. See Section <a 
href="#x1-180000D2.2">D2.2<!--tex4ht:ref: sec:Appendix.interface --></a>, <a 
href="#x1-49000doc">C1.2.3.0<!--tex4ht:ref: subsec:interface_ccl --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">interface</span>           </dt><dd 
class="list">
                  <!--l. 197--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">interpolation</span>        </dt><dd 
class="list">
                  <!--l. 198--><p class="noindent" >Given a set of grid variables and interpolation points (points in the grid coordinate
                  space, which are typically distinct from the grid points), interpolation is the act of
                  producing values for the grid variables at each interpolation point over the entire
                  grid hierarchy. (Contrast with <span 
class="cmti-10">local interpolation</span>.)
                  </p></dd><dt class="list">
<span 
class="cmss-10">local array</span>          </dt><dd 
class="list">
                  <!--l. 204--><p class="noindent" >An  array  that  is  declared  in  thorn  code,  but  not  declared  in  the  thorn’s
                  <span class="obeylines-h"><code class="verb">interface.ccl</code></span>, as opposed to a <span 
class="cmti-10">grid array</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">local interpolation</span>    </dt><dd 
class="list">
                  <!--l. 207--><p class="noindent" >Given a set of grid variables and interpolation points (points in the grid coordinate
                  space ,which are typically distinct from the grid points), interpolation is the act of
                  producing values for the grid variables at each interpolation point on a particular
                  grid. (Contrast with <span 
class="cmti-10">interpolation</span>.)
                  </p></dd><dt class="list">
<span 
class="cmss-10">Makefile</span>           </dt><dd 
class="list">
                  <!--l. 213--><p class="noindent" >The default input file for <span 
class="cmtt-10">make </span>(or <span 
class="cmtt-10">gmake</span>). Includes rules for building targets.
                  </p></dd><dt class="list">
<span 
class="cmss-10">make</span>              </dt><dd 
class="list">
                  <!--l. 216--><p class="noindent" >A system for building software. It uses rules involving dependencies of one part of
                  software on another, and information of what has changed since the last build, to
                  determine what parts need to be built.
                  </p></dd><dt class="list">
<span 
class="cmss-10">MPI</span>               </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 220--><p class="noindent" ><span 
class="cmti-10">Message  Passing  Interface</span>,  an  API  and  software  library  for  sending  messages
                  between processors in a multiprocessor system. See Section <a 
href="#x1-21000B2.2">B2.2<!--tex4ht:ref: subsec:cowiexpa --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">multi-patch</span>         </dt><dd 
class="list">
                  <!--l. 224--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">mutual recursion</span>     </dt><dd 
class="list">
                  <!--l. 225--><p class="noindent" >See <span 
class="cmti-10">recursion, mutual</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">NUL character</span>      </dt><dd 
class="list">
                  <!--l. 227--><p class="noindent" >The  C  programming  language  uses  a  “NUL  character”  to  terminate  character
                  strings. A NUL character has the integer value zero, but it’s useful to write it as
                  <span class="obeylines-h"><code class="verb">’\0’</code></span>, to emphasize to human readers that this has type <span class="obeylines-h"><code class="verb">char</code></span> rather than <span class="obeylines-h"><code class="verb">int</code></span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">null pointer, NULL pointer</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 232--><p class="noindent" >C defines a “null pointer”, often (slightly incorrectly) called a “NULL pointer”,
                  which is guaranteed not to point to any object. You get a null pointer by converting
                  the integer constant 0 to a pointer type, e.g. <span class="obeylines-h"><code class="verb">int* ptr = 0;</code></span>.<span class="footnote-mark"><a 
href="UsersGuide11.html#fn2x11"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-177003f2"></a>
                  </p><!--l. 247--><p class="noindent" >Many programmers prefer to use the predefined macro <span class="obeylines-h"><code class="verb">NULL</code></span> (defined in <span class="obeylines-h"><code class="verb">&#x003C;stdlib.h&#x003E;</code></span>,
                  <span class="obeylines-h"><code class="verb">&#x003C;stdio.h&#x003E;</code></span>,  and  possibly  other  system  header  files)  to  create  null  pointers,
                  e.g. <span class="obeylines-h"><code class="verb">int* ptr = NULL;</code></span>, to emphasize to human readers that this is a null <span 
class="cmti-10">pointer</span>
                  rather than “just” the integer zero.
                  </p><!--l. 253--><p class="noindent" >Note that it is explicitly <span 
class="cmti-10">not </span>defined whether a null pointer is represented by a bit
                  pattern of all zero bits—this varies from system to system, and there are real-world
                  systems where null pointers are, in fact, <span 
class="cmti-10">not </span>represented this way.
                  </p><!--l. 258--><p class="noindent" >For                         further                         information,                         see
                  the section “Null pointers” in the (excellent) <span 
class="cmtt-10">comp.lang.c FAQ</span>, available online at
                  <a 
href="http://www.eskimo.com/~scs/C-faq/top.html" class="url" ><span 
class="cmtt-10">http://www.eskimo.com/</span><span 
class="cmtt-10">~</span><span 
class="cmtt-10">scs/C-faq/top.html</span></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">parallelisation</span>       </dt><dd 
class="list">
                  <!--l. 261--><p class="noindent" >The process of utilising multiple computer processors to work on different parts
                  of a computational problem at the same time, in order to obtain a solution of
                  the  problem  more  quickly.  Cactus  achieves  parallelisation  by  means  of  <span 
class="cmti-10">domain</span>
                  <span 
class="cmti-10">decomposition</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">parameter</span>          </dt><dd 
class="list">
                  <!--l. 266--><p class="noindent" >A  variable  that  controls  the  run  time  behaviour  of  the  Cactus  executable.
                  Parameters  have  default  values  which  can  be  set  in  a  <span 
class="cmti-10">parameter  file</span>.  (See
                  Chapter <a 
href="#x1-67000C1.4">C1.4<!--tex4ht:ref: chap:Cactus_parameters --></a>). The flesh has parameters; thorn parameters are made available
                  to  the  rest  of  Cactus  by  describing  them  in  the  thorn’s  <span 
class="cmtt-10">param.ccl </span>file  (See
                  Appendix <a 
href="#x1-185000D2.3">D2.3<!--tex4ht:ref: sec:Appendix.param --></a>).
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmss-10">parameter file</span>       </dt><dd 
class="list">
                  <!--l. 273--><p class="noindent" >(Also called <span 
class="cmti-10">par file</span>.) A text file used as the input of a Cactus program, specifying
                  initial values of thorn parameters. See Section <a 
href="#x1-33000B3.2">B3.2<!--tex4ht:ref: sec:Parameter_File --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">processor topology</span>   </dt><dd 
class="list">
                  <!--l. 277--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">PUGH</span>             </dt><dd 
class="list">
                  <!--l. 278--><p class="noindent" >The default driver thorn for Cactus which uses MPI. See Section <a 
href="#x1-15000B1.1">B1.1<!--tex4ht:ref: sec:required_software --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">PVM</span>              </dt><dd 
class="list">
                  <!--l. 281--><p class="noindent" ><span 
class="cmti-10">Parallel   Virtual   Machine</span>,    provides    interprocessor    communication.    See
                  Section <a 
href="#x1-15000B1.1">B1.1<!--tex4ht:ref: sec:required_software --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">recursion, mutual</span>    </dt><dd 
class="list">
                  <!--l. 284--><p class="noindent" >See <span 
class="cmti-10">mutual recursion</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">reduction</span>           </dt><dd 
class="list">
                  <!--l. 286--><p class="noindent" >Given a set of grid variables on a computational grid, <span 
class="cmti-10">reduction </span>is the process of
                  producing values for the variables on a proper subset of points from the grid.
                  </p></dd><dt class="list">
<span 
class="cmss-10">scheduler</span>           </dt><dd 
class="list">
                  <!--l. 290--><p class="noindent" >The part of the Cactus flesh that determines the order and circumstances in which
                  to execute Cactus routines. Thorn functions and schedule groups are registered
                  with  the  flesh  via  the  thorn’s  <span 
class="cmtt-10">schedule.ccl </span>file  to  be  executed  in  a  certain
                  schedule bin, before or after another function or group executes, and so forth. See
                  section <a 
href="#x1-188000D2.4">D2.4<!--tex4ht:ref: sec:Appendix.schedule --></a> <a 
href="#x1-76000C1.5">C1.5<!--tex4ht:ref: chap:scheduling --></a>,
                  </p></dd><dt class="list">
<span 
class="cmss-10">schedule bin</span>        </dt><dd 
class="list">
                  <!--l. 297--><p class="noindent" >One of a set of special timebins pre-defined by Cactus. See Section <a 
href="#x1-207000D4">D4<!--tex4ht:ref: sec:Appendix.schedule_bins --></a> for a list.
                  </p></dd><dt class="list">
<span 
class="cmss-10">schedule group</span>      </dt><dd 
class="list">
                  <!--l. 300--><p class="noindent" >A timebin defined by a thorn, in its <span 
class="cmtt-10">schedule.ccl </span>file (see Appendix <a 
href="#x1-188000D2.4">D2.4<!--tex4ht:ref: sec:Appendix.schedule --></a>). Each
                  schedule  group  must  be  defined  to  occur  in  a  Cactus  schedule  bin  or  another
                  schedule group. See Chapter <a 
href="#x1-76000C1.5">C1.5<!--tex4ht:ref: chap:scheduling --></a>, <a 
href="#x1-77000C1.5.1">C1.5.1<!--tex4ht:ref: scheduling:schedule_bins --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">shares</span>             </dt><dd 
class="list">
                  <!--l. 306--><p class="noindent" >An implementation may <span 
class="cmti-10">share </span>restricted parameters with another implementation,
                  which means the other implementation can get the parameter values, and if the
                  parameters are steerable, it can change them. See Section <a 
href="#x1-185000D2.3">D2.3<!--tex4ht:ref: sec:Appendix.param --></a> <a 
href="#x1-50000doc">C1.2.3.0<!--tex4ht:ref: subsec:param_ccl --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">steerable parameter</span>   </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 311--><p class="noindent" >A  parameter  which  can  be  changed  at  any  time  after  the  program  has  been
                  initialised. See Section <a 
href="#x1-75000C1.4.3">C1.4.3<!--tex4ht:ref: sec:Cactus_parameters.steerable --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">symmetry operation</span>  </dt><dd 
class="list">
                  <!--l. 314--><p class="noindent" >A grid operation that is a manifestation of a geometrical symmetry, especially
                  rotation or reflection.
                  </p></dd><dt class="list">
<span 
class="cmss-10">symmetry zone</span>      </dt><dd 
class="list">
                  <!--l. 317--><p class="noindent" >A set of points laying at the edge of the computational grid and containing data
                  obtained by some symmetry operation from another part of the same grid. (Contrast
                  with <span 
class="cmti-10">boundary zone</span>, <span 
class="cmti-10">ghost zone</span>.)
                  </p></dd><dt class="list">
<span 
class="cmss-10">synchronisation</span>      </dt><dd 
class="list">
                  <!--l. 322--><p class="noindent" >The process of copying information from the outer part of a computational interior
                  on one processor to the corresponding ghost zone (see) on another processor. Also
                  refers to a special Cactus timebin corresponding to the occurrence of this process.
                  See Section <a 
href="#x1-64000C1.3.5">C1.3.5<!--tex4ht:ref: sec:ghost_size --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">TAGS</span>             </dt><dd 
class="list">
                  <!--l. 328--><p class="noindent" >See Section <a 
href="#x1-212000D7">D7<!--tex4ht:ref: sec:Appendix.tags --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">target</span>             </dt><dd 
class="list">
                  <!--l. 330--><p class="noindent" >A <span 
class="cmti-10">make target </span>is the name of a set of rules for <span 
class="cmtt-10">make </span>(or <span 
class="cmtt-10">gmake</span>). When the target
                  is included in the command line for <span 
class="cmtt-10">make</span>, the rules are executed, usually to build
                  some software.
                  </p></dd><dt class="list">
<span 
class="cmss-10">test suite</span>           </dt><dd 
class="list">
                  <!--l. 335--><p class="noindent" >See Sections <a 
href="#x1-30000B2.6">B2.6<!--tex4ht:ref: sec:testing --></a>, <a 
href="#x1-118000C1.8.5">C1.8.5<!--tex4ht:ref: sec:adding_test_suite --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">thorn</span>              </dt><dd 
class="list">
                  <!--l. 337--><p class="noindent" >A collection of subroutines defining a Cactus interface. See Chapters <a 
href="#x1-40000C1.1">C1.1<!--tex4ht:ref: chap:thorn_concepts --></a>, <a 
href="#x1-44000C1.2">C1.2<!--tex4ht:ref: chap:thorn_anatomy --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">ThornList</span>          </dt><dd 
class="list">
                  <!--l. 340--><p class="noindent" >A file used by the Cactus CST to determine which thorns to compile into a Cactus
                  executable (see Section <a 
href="#x1-25000B2.4.1">B2.4.1<!--tex4ht:ref: sec:gmtafobuanadco --></a>, <a 
href="#x1-26000B2.4.2">B2.4.2<!--tex4ht:ref: sec:cointh --></a>). Can also be used to determine which thorns
                  to check out from git. (see Section <a 
href="#x1-3000A1.1">A1.1<!--tex4ht:ref: sec:checkout --></a>). A ThornList for each Cactus configuration
                  lies in the configuration subdirectory of the Cactus <span 
class="cmtt-10">configs </span>directory.
                  </p></dd><dt class="list">
<span 
class="cmss-10">time bin</span>            </dt><dd 
class="list">
                  <!--l. 348--><p class="noindent" >A time interval in the duration of a Cactus run wherein the flesh runs specified
                  routines. See <span 
class="cmti-10">scheduler</span>, <span 
class="cmti-10">schedule bin</span>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">time level</span>          </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 351--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">timer</span>              </dt><dd 
class="list">
                  <!--l. 352--><p class="noindent" >A Cactus API for reporting time. See Section <a 
href="#x1-121000C1.9.1">C1.9.1<!--tex4ht:ref: sec:timers --></a>.
                  </p></dd><dt class="list">
<span 
class="cmss-10">trigger</span>             </dt><dd 
class="list">
                  <!--l. 354--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">unigrid</span>             </dt><dd 
class="list">
                  <!--l. 355--><p class="noindent" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">wrapper</span>            </dt><dd 
class="list">
                  <!--l. 356--><p class="noindent" >
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter D2</span><br /><a 
 id="x1-178000D2"></a>Configuration File Syntax</h2>
<h3 class="sectionHead"><span class="titlemark">D2.1   </span> <a 
 id="x1-179000D2.1"></a>General Concepts</h3>
<!--l. 369--><p class="noindent" >Each thorn is configured by three compulsory and one optional files in the top level thorn directory:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 372--><p class="noindent" > <span 
class="cmtt-10">interface.ccl</span>
     </p></li>
     <li class="itemize">
     <!--l. 373--><p class="noindent" > <span 
class="cmtt-10">param.ccl</span>
     </p></li>
     <li class="itemize">
     <!--l. 374--><p class="noindent" > <span 
class="cmtt-10">schedule.ccl</span>
     </p></li>
     <li class="itemize">
     <!--l. 375--><p class="noindent" > <span 
class="cmtt-10">configuration.ccl </span>(optional)</p></li></ul>
<!--l. 377--><p class="noindent" >These files are written in the <span 
class="cmti-10">Cactus Configuration Language </span>which is case insensitive.
</p><!--l. 386--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D2.2   </span> <a 
 id="x1-180000D2.2"></a>interface.ccl</h3>
<!--l. 389--><p class="noindent" >The interface configuration file consists of: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 391--><p class="noindent" >A header block giving details of the thorn’s relationship with other thorns.
     </p></li>
     <li class="itemize">
     <!--l. 393--><p class="noindent" >A block detailing which include files are used from other thorns, and which include files are provided
     by this thorn.
     </p></li>
     <li class="itemize">
     <!--l. 395--><p class="noindent" >Blocks detailing aliased functions provided or used by this thorn.
                                                                                       
                                                                                       
     </p></li>
     <li class="itemize">
     <!--l. 396--><p class="noindent" >A series of blocks listing the thorn’s global variables.</p></li></ul>
<!--l. 398--><p class="noindent" >(For a more extensive discussion of Cactus variables, see Chapter <a 
href="#x1-59000C1.3">C1.3<!--tex4ht:ref: chap:cactus_variables --></a>.)
</p><!--l. 401--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.2.1   </span> <a 
 id="x1-181000D2.2.1"></a>Header Block</h4>
<!--l. 402--><p class="noindent" >The header block has the form: </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">implements:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">implementation</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10">inherits:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">implementation</span><span 
class="cmtt-10">&#x003E;,</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">implementation</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10">friend:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">implementation</span><span 
class="cmtt-10">&#x003E;,</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">implementation</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> where
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 410--><p class="noindent" > The implementation name must be unique among all thorns, except between thorns which have
     the same public and protected variables and global and restricted parameters.
     </p></li>
     <li class="itemize">
     <!--l. 413--><p class="noindent" > Inheriting from another implementation makes all that implementation’s public variables available
     to your thorn. At least one thorn providing any inherited implementation must be present at compile
     time. A thorn cannot inherit from itself. Inheritance is transitive (if \(A\) inherits from \(B\), and \(B\) inherits
     from \(C\), then \(A\) also implicitly inherits from \(C\)), but not commutative.
     </p></li>
     <li class="itemize">
     <!--l. 422--><p class="noindent" > Being a friend of another implementation makes all that implementation’s protected variables
     available to your thorn. At least one thorn providing an implementation for each friend must be
     present at compile time. A thorn cannot be its own friend. Friendship is associative, commutative
     and transitive (i.e. if \(A\) is a friend of \(B\), and \(B\) is a friend of \(C\), then \(A\) is implicitly a friend of \(C\)).</p></li></ul>
<!--l. 437--><p class="noindent" >
</p>
                                                                                       
                                                                                       
<h4 class="subsectionHead"><span class="titlemark">D2.2.2   </span> <a 
 id="x1-182000D2.2.2"></a>Include Files</h4>
<!--l. 438--><p class="noindent" >The include file section has the form: </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">USES</span><span 
class="cmtt-10"> INCLUDE</span><span 
class="cmtt-10"> [SOURCE|HEADER]:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">file_name</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10">INCLUDE[S]</span><span 
class="cmtt-10"> [SOURCE|HEADER]:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">file_to_include</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> in</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">file_name</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> The former is used when a thorn wishes to use an include file from another thorn. The latter indicates that this
thorn adds the code in <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">file</span><span 
class="cmsltt-10">_to</span><span 
class="cmsltt-10">_include</span><span 
class="cmtt-10">&#x003E; </span>to the include file <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">file</span><span 
class="cmsltt-10">_name</span><span 
class="cmtt-10">&#x003E;</span>. If the include file is
described as <span class="obeylines-h"><code class="verb">SOURCE</code></span>, the included code is only executed if the providing thorn is active. Both default to
<span class="obeylines-h"><code class="verb">HEADER</code></span>.
<!--l. 450--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.2.3   </span> <a 
 id="x1-183000D2.2.3"></a>Function Aliasing</h4>
<!--l. 452--><p class="noindent" >If any aliased function is to be used or provided by the thorn, then the prototype must be declared with the
form: </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">return_type</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> FUNCTION</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;(&#x003C;</span><span 
class="cmsltt-10">arg1_type</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">intent1</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [ARRAY]</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">arg1</span><span 
class="cmtt-10">&#x003E;,</span><span 
class="cmtt-10"> ...)</span>
</div>
</div> The <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">return</span><span 
class="cmsltt-10">_type</span><span 
class="cmtt-10">&#x003E; </span>must be either <span class="obeylines-h"><code class="verb">void</code></span>, <span class="obeylines-h"><code class="verb">CCTK_INT</code></span>, <span class="obeylines-h"><code class="verb">CCTK_REAL</code></span>, <span class="obeylines-h"><code class="verb">CCTK_COMPLEX</code></span>, <span class="obeylines-h"><code class="verb">CCTK_POINTER</code></span>, or
<span class="obeylines-h"><code class="verb">CCTK_POINTER_TO_CONST</code></span>. The keyword <span class="obeylines-h"><code class="verb">SUBROUTINE</code></span> is equivalent to <span class="obeylines-h"><code class="verb">void FUNCTION</code></span>. The name of the aliased
function <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E; </span>must contain at least one uppercase and one lowercase letter and follow the C standard for
function names. The type of each argument, <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">arg*</span><span 
class="cmsltt-10">_type</span><span 
class="cmtt-10">&#x003E;</span>, must be either <span class="obeylines-h"><code class="verb">CCTK_INT</code></span>, <span class="obeylines-h"><code class="verb">CCTK_REAL</code></span>, <span class="obeylines-h"><code class="verb">CCTK_COMPLEX</code></span>,
<span class="obeylines-h"><code class="verb">CCTK_POINTER</code></span>, <span class="obeylines-h"><code class="verb">CCTK_POINTER_TO_CONST</code></span>, or <span class="obeylines-h"><code class="verb">STRING</code></span>. All string arguments must be the last arguments in the
list. The intent of each argument, <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">intent*</span><span 
class="cmtt-10">&#x003E;</span>, must be either <span class="obeylines-h"><code class="verb">IN</code></span>, <span class="obeylines-h"><code class="verb">OUT</code></span>, or <span class="obeylines-h"><code class="verb">INOUT</code></span>. An argument may only be
modified if it is declared to have intent <span class="obeylines-h"><code class="verb">OUT</code></span> or <span class="obeylines-h"><code class="verb">INOUT</code></span>. If the argument is an array then the prefix <span class="obeylines-h"><code class="verb">ARRAY</code></span> must
also be given.
<!--l. 473--><p class="noindent" >If the argument <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">arg*</span><span 
class="cmtt-10">&#x003E; </span>is a function pointer, then the argument itself (which will preceded by the return type)
should be </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">CCTK_FPOINTER</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">function_arg1</span><span 
class="cmtt-10">&#x003E;(&#x003C;</span><span 
class="cmsltt-10">arg1_type</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">intent1</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">arg1</span><span 
class="cmtt-10">&#x003E;,</span><span 
class="cmtt-10"> ...)</span>
                                                                                       
                                                                                       
</div>
</div> Function pointers may not be nested.
<!--l. 480--><p class="noindent" >If an aliased function is to be required, then the block </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">REQUIRES</span><span 
class="cmtt-10"> FUNCTION</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> is required.
<!--l. 486--><p class="noindent" >If an aliased function is to be (optionally) used, then the block </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">USES</span><span 
class="cmtt-10"> FUNCTION</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> is required.
<!--l. 492--><p class="noindent" >If a function is provided, then the block </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">PROVIDES</span><span 
class="cmtt-10"> FUNCTION</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> WITH</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">provider</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> LANGUAGE</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">providing_language</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> is required. As with the alias name, <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">provider</span><span 
class="cmtt-10">&#x003E; </span>must contain at least one uppercase and one lowercase letter,
and follow the C standard for function names. Currently, the only supported values of <span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">providing</span><span 
class="cmsltt-10">_language</span><span 
class="cmtt-10">&#x003E;</span>
are <span class="obeylines-h"><code class="verb">C</code></span> and <span class="obeylines-h"><code class="verb">Fortran</code></span>.
<!--l. 502--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.2.4   </span> <a 
 id="x1-184000D2.2.4"></a>Variable Blocks</h4>
<!--l. 504--><p class="noindent" >The thorn’s variables are collected into groups. This is not only for convenience, but for collecting like variables
together. Storage assignment, communication assignment, and ghostzone synchronization take place for groups
only.
</p><!--l. 509--><p class="noindent" >The thorn’s variables are defined by:
</p>
<div class="alltt">
                                                                                       
                                                                                       
<div class="obeylines-v">
<br /><span 
class="cmtt-10">[&#x003C;</span><span 
class="cmsltt-10">access</span><span 
class="cmtt-10">&#x003E;:]</span>
<br />
<br /><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">data_type</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group_name</span><span 
class="cmtt-10">&#x003E;[[&#x003C;</span><span 
class="cmsltt-10">number</span><span 
class="cmtt-10">&#x003E;]]</span><span 
class="cmtt-10"> [TYPE=&#x003C;</span><span 
class="cmsltt-10">group_type</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [DIM=&#x003C;</span><span 
class="cmsltt-10">dim</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10">[TIMELEVELS=&#x003C;</span><span 
class="cmsltt-10">num</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10">[SIZE=&#x003C;</span><span 
class="cmsltt-10">size</span><span 
class="cmsltt-10"> in</span><span 
class="cmsltt-10"> each</span><span 
class="cmsltt-10"> direction</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [DISTRIB=&#x003C;</span><span 
class="cmsltt-10">distribution_type</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10">[GHOSTSIZE=&#x003C;</span><span 
class="cmsltt-10">ghostsize</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10">[TAGS=&#x003C;</span><span 
class="cmsltt-10">string</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [&#x0022;&#x003C;</span><span 
class="cmsltt-10">group_description</span><span 
class="cmtt-10">&#x003E;&#x0022;]</span>
<br /><span 
class="cmtt-10">[</span><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> [</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable_name</span><span 
class="cmtt-10">&#x003E;[,]&#x003C;</span><span 
class="cmsltt-10">variable_name</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable_name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> ]</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> [&#x0022;&#x003C;</span><span 
class="cmsltt-10">group_description</span><span 
class="cmtt-10">&#x003E;&#x0022;]</span><span 
class="cmtt-10"> ]</span>
</div>
</div> (The options <span class="obeylines-h"><span 
class="cmtt-10">TYPE</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">DIM</span></span>, etc., following <span class="obeylines-h"><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10">_name</span><span 
class="cmtt-10">&#x003E;</span></span> must all appear on one line.) Note that the
beginning brace (<span 
class="cmsy-10">{</span>) must sit on a line by itself; the ending brace (<span 
class="cmsy-10">}</span>) must be preceded by a carriage
return.
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 531--><p class="noindent" > <span class="obeylines-h"><span 
class="cmsltt-10">access</span></span> defines which thorns can use the following groups of variables. <span class="obeylines-h"><span 
class="cmsltt-10">access</span></span> can be either <span class="obeylines-h"><span 
class="cmtt-10">public</span></span>,
     <span class="obeylines-h"><span 
class="cmtt-10">protected</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">private</span></span>.
     </p></li>
     <li class="itemize">
     <!--l. 534--><p class="noindent" > <span class="obeylines-h"><span 
class="cmsltt-10">data</span><span 
class="cmsltt-10">_type</span></span> defines the data type of the variables in the group. Supported data types are <span class="obeylines-h"><span 
class="cmtt-10">CHAR</span></span>,
     <span class="obeylines-h"><span 
class="cmtt-10">BYTE</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">INT</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">REAL</span></span>, and <span class="obeylines-h"><span 
class="cmtt-10">COMPLEX</span></span>.
     </p></li>
     <li class="itemize">
     <!--l. 537--><p class="noindent" > <span class="obeylines-h"><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10">_name</span></span> must be an alphanumeric name (which may also contain underscores) which is unique
     across group and variable names within the scope of the thorn. A group name is compulsory.
     </p></li>
     <li class="itemize">
     <!--l. 540--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">[</span><span 
class="cmsltt-10">number</span><span 
class="cmtt-10">]</span></span>, if present, indicates that this is a <span 
class="cmti-10">vector </span>group. The number can be any valid arithmetical
     expression consisting of integers or integer-valued parameters. Each variable in that group appears
     as a one-dimensional array of grid variables. When the variable is accessed in the code, then the
     last index is the member-index, and any other indices are the normal spatial indices for a group of
     this type and dimension.
     </p></li>
     <li class="itemize">
     <!--l. 547--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">TYPE</span></span> designates the kind of variables held by the group. The choices are <span class="obeylines-h"><span 
class="cmtt-10">GF</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">ARRAY</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">SCALAR</span></span>. This
     field is optional, with the default variable type being <span class="obeylines-h"><span 
class="cmtt-10">SCALAR</span></span>.
     </p></li>
     <li class="itemize">
     <!--l. 550--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">DIM</span></span> defines the spatial dimension of the <span class="obeylines-h"><span 
class="cmtt-10">ARRAY</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">GF</span></span>. The default value is <span class="obeylines-h"><span 
class="cmtt-10">DIM=3</span></span>.
                                                                                       
                                                                                       
     </p></li>
     <li class="itemize">
     <!--l. 552--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">TIMELEVELS</span></span> defines the number of timelevels a group has if the group is of type <span class="obeylines-h"><span 
class="cmtt-10">ARRAY</span></span> or <span class="obeylines-h"><span 
class="cmtt-10">GF</span></span>, and
     can take any positive value. The default is one timelevel.
     </p></li>
     <li class="itemize">
     <!--l. 555--><p class="noindent" >  <span class="obeylines-h"><span 
class="cmtt-10">SIZE</span></span> defines  the  number  grid-points  an  <span 
class="cmtt-10">ARRAY </span>has  in  each  direction.  This  should  be  a
     comma-separated  list  of  valid  arithmetical  expressions  consisting  of  integers  or  integer-valued
     parameters.
     </p></li>
     <li class="itemize">
     <!--l. 558--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">DISTRIB</span></span> defines the processor decomposition of an <span 
class="cmtt-10">ARRAY</span>. <span 
class="cmtt-10">DISTRIB=DEFAULT </span>distributes <span 
class="cmtt-10">SIZE</span>
     grid-points  across  all  processors.  <span 
class="cmtt-10">DISTRIB=CONSTANT </span>implies  that  <span 
class="cmtt-10">SIZE </span>grid-points  should  be
     allocated on each processor. The default value is <span 
class="cmtt-10">DISTRIB=DEFAULT</span>.
     </p></li>
     <li class="itemize">
     <!--l. 563--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">GHOSTSIZE</span></span> defines number of ghost zones in each dimension of an <span 
class="cmtt-10">ARRAY</span>. It defaults to zero.
     </p></li>
     <li class="itemize">
     <!--l. 565--><p class="noindent" > <span class="obeylines-h"><span 
class="cmtt-10">TAGS</span></span> defines an optional string which is used to create a set of key-value pairs associated with
     the group. The keys are case independent. The string (which must be deliminated by single or
     double quotes) is interpreted by the function <span class="obeylines-h"><span 
class="cmtt-10">Util</span><span 
class="cmtt-10">_TableSetFromString()</span></span>, which is described in
     the Reference Manual.<br 
class="newline" />Currently the CST parser and the flesh do not evaluate any information passed in an optional
     <span class="obeylines-h"><span 
class="cmtt-10">TAGS</span></span> string.  Thorns  may  do  so  by  querying  the  key/value  table  information  for  a  group  by
     using <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_GroupTagsTable()</span></span> and the appropriate <span class="obeylines-h"><span 
class="cmtt-10">Util</span><span 
class="cmtt-10">_TableGet*()</span></span> utility functions (see the
     ReferenceManual for detailed descriptions).<br 
class="newline" />For a list of currently supported <span class="obeylines-h"><span 
class="cmtt-10">TAGS</span></span> key-value table information, please refer to the corresponding
     chapter in the documentation of the <span class="obeylines-h"><code class="verb">CactusDoc</code></span> arrangement. (Section <a 
href="#x1-29000B2.5">B2.5<!--tex4ht:ref: sec:OtherGmakeTargetsDoc --></a> on page <a 
href="#x1-29000B2.5">B30<!--tex4ht:ref: sec:OtherGmakeTargetsDoc --></a> explains
     how to build this documentation).
     </p></li>
     <li class="itemize">
     <!--l. 582--><p class="noindent" > The (optional) block following the group declaration line, contains a list of variables contained in the
     group. All variables in a group have the same data type, variable type, dimension and distribution.
     The list can be separated by spaces, commas, or new lines. The variable names must be unique
     within the scope of the thorn. A variable can only be a member of one group. The block must be
     delimited by brackets on new lines. If no block is given after a group declaration line, a variable
     with the same name as the group is created. Apart from this case, a group name cannot be the
     same as the name of any variable seen by this thorn.
     </p></li>
     <li class="itemize">
     <!--l. 592--><p class="noindent" > An optional description of the group can be given on the last line. If the variable block is omitted,
     this description can be given at the end of the declaration line.</p></li></ul>
<!--l. 597--><p class="noindent" >The process of sharing code among thorns using include files is discussed in Section <a 
href="#x1-125000C1.9.2">C1.9.2<!--tex4ht:ref: sec:includefiles --></a>.
                                                                                       
                                                                                       
</p><!--l. 600--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D2.3   </span> <a 
 id="x1-185000D2.3"></a>param.ccl</h3>
<!--l. 603--><p class="noindent" >The parameter configuration file consists of a list of <span 
class="cmti-10">parameter object specification items </span>(OSIs) giving the type
and range of the parameter separated by optional <span 
class="cmti-10">parameter data scoping items </span>(DSIs), which
detail access to the parameter. (For a more extensive discussion of Cactus parameters, see Chapter
<a 
href="#x1-67000C1.4">C1.4<!--tex4ht:ref: chap:Cactus_parameters --></a>.)
</p><!--l. 610--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.3.1   </span> <a 
 id="x1-186000D2.3.1"></a>Parameter Data Scoping Items</h4>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">access</span><span 
class="cmtt-10">&#x003E;:</span>
</div>
</div>
<!--l. 616--><p class="noindent" >The keyword <span class="obeylines-h"><span 
class="cmsltt-10">access</span></span> designates that all parameter object specification items, up to the next parameter data
scoping item, are in the same protection or scoping class. <span 
class="cmsltt-10">access </span>can take the values:
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">global</span>            </dt><dd 
class="list">
                  <!--l. 620--><p class="noindent" >all thorns have access to global parameters
                  </p></dd><dt class="list">
<span 
class="cmtt-10">restricted</span>        </dt><dd 
class="list">
                  <!--l. 621--><p class="noindent" >other thorns can have access to these parameters, if they specifically request it in
                  their own param.ccl
                  </p></dd><dt class="list">
<span 
class="cmtt-10">private</span>           </dt><dd 
class="list">
                  <!--l. 624--><p class="noindent" >only your thorn has access to private parameters
                  </p></dd><dt class="list">
<span 
class="cmtt-10">shares</span>            </dt><dd 
class="list">
                  <!--l. 625--><p class="noindent" >in this case, an <span class="obeylines-h"><span 
class="cmtt-10">implementation</span></span> name must follow the colon. It declares that all the
                  parameters in the following scoping block are restricted variables from the specified
                  <span 
class="cmtt-10">implementation</span>. (Note: only one implementation can be specified on this line.)</p></dd></dl>
                                                                                       
                                                                                       
<!--l. 633--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.3.2   </span> <a 
 id="x1-187000D2.3.2"></a>Parameter Object Specification Items</h4>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">[EXTENDS|USES]</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> type</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;[[&#x003C;</span><span 
class="cmsltt-10">len</span><span 
class="cmtt-10">&#x003E;]]</span><span 
class="cmtt-10"> &#x0022;&#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> description</span><span 
class="cmtt-10">&#x003E;&#x0022;</span>
<br /><span 
class="cmtt-10">[AS</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [STEERABLE=&#x003C;NEVER|ALWAYS|RECOVER&#x003E;]</span>
<br /><span 
class="cmtt-10">[ACCUMULATOR=&#x003C;</span><span 
class="cmsltt-10">expression</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [ACCUMULATOR-BASE=&#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">parameter</span><span 
class="cmsltt-10"> values</span><span 
class="cmtt-10">&#x003E;</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">default</span><span 
class="cmsltt-10"> value</span><span 
class="cmtt-10">&#x003E;</span>
</div>
</div> where the options <span class="obeylines-h"><span 
class="cmtt-10">AS</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">STEERABLE</span></span>, etc., following <span class="obeylines-h"><span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">parameter description</span><span 
class="cmtt-10">&#x003E;</span></span>, must all appear in one line. Note
that the beginning brace (<span class="obeylines-h"><span 
class="cmsy-10">{</span></span>) must sit on a line by itself; the ending brace (<span class="obeylines-h"><span 
class="cmsy-10">}</span></span>) must be at the beginning of a line
followed by <span 
class="cmsltt-10">&#x003C;default value&#x003E; </span>on that same line.
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 652--><p class="noindent" >The <span 
class="cmsltt-10">parameter values </span>depend on the <span 
class="cmsltt-10">parameter type</span>, which may be one of the following:
                       </p><dl class="list2"><dt class="list">
     <span class="obeylines-h"><span 
class="cmtt-10">INT</span></span>               </dt><dd 
class="list">
                       <!--l. 655--><p class="noindent" >The specification of <span 
class="cmsltt-10">parameter value</span>s takes the form of one or more lines, each of
                       the form </p><div class="alltt">
                       <div class="obeylines-v">
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;range</span><span 
class="cmsltt-10"> description&#x003E;</span><span 
class="cmtt-10"> [::&#x0022;</span><span 
class="cmsltt-10">&#x003C;comment</span><span 
class="cmsltt-10"> describing</span><span 
class="cmsltt-10"> this</span><span 
class="cmsltt-10"> range&#x003E;</span><span 
class="cmtt-10">&#x0022;]</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span>
</div>
                       </div> Here, a <span 
class="cmsltt-10">&#x003C;range description&#x003E; </span>specifies a set of integers, and has one of the
                       following forms: <div class="alltt">
                       <div class="obeylines-v">
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> *</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> any</span><span 
class="cmtt-10"> integer</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> only</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;lower</span><span 
class="cmsltt-10"> bound&#x003E;</span><span 
class="cmtt-10">:</span><span 
class="cmsltt-10">&#x003C;upper</span><span 
class="cmsltt-10"> bound&#x003E;</span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> all</span><span 
class="cmtt-10"> integers</span><span 
class="cmtt-10"> in</span><span 
class="cmtt-10"> the</span><span 
class="cmtt-10"> range</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> from</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;lower</span><span 
class="cmsltt-10"> bound&#x003E;</span><span 
class="cmtt-10"> to</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;upper</span><span 
class="cmsltt-10"> bound&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;lower</span><span 
class="cmsltt-10"> bound&#x003E;</span><span 
class="cmtt-10">:</span><span 
class="cmsltt-10">&#x003C;upper</span><span 
class="cmsltt-10"> bound&#x003E;</span><span 
class="cmtt-10">:</span><span 
class="cmsltt-10">&#x003C;positive</span><span 
class="cmsltt-10"> step&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> all</span><span 
class="cmtt-10"> integers</span><span 
class="cmtt-10"> in</span><span 
class="cmtt-10"> the</span><span 
class="cmtt-10"> range</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> from</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;lower</span><span 
class="cmsltt-10"> bound&#x003E;</span><span 
class="cmtt-10"> to</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;upper</span><span 
class="cmsltt-10"> bound&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> in</span><span 
class="cmtt-10"> steps</span><span 
class="cmtt-10"> of</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;positive</span><span 
class="cmsltt-10"> step&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span>
                                                                                       
                                                                                       
</div>
                       </div> where <span 
class="cmsltt-10">&#x003C;lower bound&#x003E; </span>has one of the forms <div class="alltt">
                       <div class="obeylines-v">
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;empty</span><span 
class="cmsltt-10"> field&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> no</span><span 
class="cmtt-10"> lower</span><span 
class="cmtt-10"> limit</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> *</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> no</span><span 
class="cmtt-10"> lower</span><span 
class="cmtt-10"> limit</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> a</span><span 
class="cmtt-10"> closed</span><span 
class="cmtt-10"> interval</span><span 
class="cmtt-10"> starting</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [</span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> also</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> a</span><span 
class="cmtt-10"> closed</span><span 
class="cmtt-10"> interval</span><span 
class="cmtt-10"> starting</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> (</span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> an</span><span 
class="cmtt-10"> open</span><span 
class="cmtt-10"> interval</span><span 
class="cmtt-10"> starting</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span>
</div>
                       </div> and <span 
class="cmsltt-10">&#x003C;upper bound&#x003E; </span>has one of the forms <div class="alltt">
                       <div class="obeylines-v">
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;empty</span><span 
class="cmsltt-10"> field&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> no</span><span 
class="cmtt-10"> upper</span><span 
class="cmtt-10"> limit</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> *</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> no</span><span 
class="cmtt-10"> upper</span><span 
class="cmtt-10"> limit</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> a</span><span 
class="cmtt-10"> closed</span><span 
class="cmtt-10"> interval</span><span 
class="cmtt-10"> ending</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10">]</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> also</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> a</span><span 
class="cmtt-10"> closed</span><span 
class="cmtt-10"> interval</span><span 
class="cmtt-10"> ending</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> #</span><span 
class="cmtt-10"> means</span><span 
class="cmtt-10"> an</span><span 
class="cmtt-10"> open</span><span 
class="cmtt-10"> interval</span><span 
class="cmtt-10"> ending</span><span 
class="cmtt-10"> at</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">&#x003C;integer&#x003E;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span>
</div>
                       </div>
                       </dd><dt class="list">
     <span class="obeylines-h"><span 
class="cmtt-10">REAL</span></span>              </dt><dd 
class="list">
                       <!--l. 690--><p class="noindent" >The range specification is the same as with integers, except that here, no <span 
class="cmsltt-10">step</span>
                       implies a continuum of values. Note that numeric constants should be expressed as in
                       C (e.g. <span class="obeylines-h"><span 
class="cmtt-10">1e-10</span></span>). Note also that one cannot use the Cactus types such as <span class="obeylines-h"><span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL4</span></span>
                       to specify the precision of the parameter; parameters always have the default
                       precision.
                       </p></dd><dt class="list">
     <span class="obeylines-h"><span 
class="cmtt-10">KEYWORD</span></span>           </dt><dd 
class="list">
                       <!--l. 698--><p class="noindent" >Each entry in the list of acceptable values for a keyword has the form
                       </p><div class="alltt">
                       <div class="obeylines-v">
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">keyword</span><span 
class="cmsltt-10"> value</span><span 
class="cmtt-10">&#x003E;,</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">keyword</span><span 
class="cmsltt-10"> value</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> ::</span><span 
class="cmtt-10"> &#x0022;&#x003C;</span><span 
class="cmsltt-10">description</span><span 
class="cmtt-10">&#x003E;&#x0022;</span>
                       <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span>
</div>
                       </div> Keyword values should be enclosed in double quotes. The double quotes are
                       mandatory if the keyword contains spaces.
                       </dd><dt class="list">
     <span class="obeylines-h"><span 
class="cmtt-10">STRING</span></span>            </dt><dd 
class="list">
                       <!--l. 707--><p class="noindent" >Allowed values for strings should be specified using regular expressions. To allow any
                       string, the regular expression <span 
class="cmtt-10">&#x0022;&#x0022; </span>should be used. (An empty regular expression
                       matches anything.) Regular expressions and string values should be enclosed in
                       double quotes. The double quotes are mandatory if the regular expression or the
                       string value is empty or contains spaces.
                                                                                       
                                                                                       
                       </p></dd><dt class="list">
     <span class="obeylines-h"><span 
class="cmtt-10">BOOLEAN</span></span>           </dt><dd 
class="list">
                       <!--l. 715--><p class="noindent" >No <span 
class="cmsltt-10">parameter values </span>should be specified for a boolean parameter. The default
                       value for a boolean can be </p>
                          <ul class="itemize2">
                          <li class="itemize">
                          <!--l. 719--><p class="noindent" >True: <span class="obeylines-h"><span 
class="cmtt-10">1</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">yes</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">y</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">t</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">true</span></span>
                          </p></li>
                          <li class="itemize">
                          <!--l. 720--><p class="noindent" >False: <span class="obeylines-h"><span 
class="cmtt-10">0</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">no</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">n</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">f</span></span>, <span class="obeylines-h"><span 
class="cmtt-10">false</span></span></p></li></ul>
                       <!--l. 722--><p class="noindent" >Boolean values may optionally be enclosed in double quotes.
</p>
                       </dd></dl>
     </li>
     <li class="itemize">
     <!--l. 727--><p class="noindent" >The <span 
class="cmsltt-10">parameter name </span>must be unique within the scope of the thorn.
     </p></li>
     <li class="itemize">
     <!--l. 731--><p class="noindent" >The <span 
class="cmsltt-10">default value </span>must match one of the ranges given in the <span 
class="cmsltt-10">parameter type</span>
     </p></li>
     <li class="itemize">
     <!--l. 735--><p class="noindent" >A thorn can declare that it <span class="obeylines-h"><span 
class="cmtt-10">EXTENDS</span></span> a parameter of another thorn. This allows it to declare additional
     acceptable values. By default, it is acceptable for two thorns to declare the same value as
     acceptable.
     </p></li>
     <li class="itemize">
     <!--l. 741--><p class="noindent" >If the thorn wants to simply use a parameter from another thorn, without declaring additional values, use
     <span class="obeylines-h"><span 
class="cmtt-10">USES</span></span> instead.
     </p></li>
     <li class="itemize">
     <!--l. 745--><p class="noindent" ><span 
class="cmtt-10">[</span><span 
class="cmsltt-10">len</span><span 
class="cmtt-10">] </span>(where <span 
class="cmsltt-10">len </span>is an integer), if present, indicates that this is an <span 
class="cmti-10">array </span>parameter of <span 
class="cmsltt-10">len </span>values of the
     specified type. (Note that the notation used above for the parameter specification breaks down here, as
     there must be square brackets around the length).
     </p></li>
     <li class="itemize">
     <!--l. 752--><p class="noindent" ><span 
class="cmsltt-10">alias </span>allows a parameter to appear under a different name in this thorn, other than its original name in
     another thorn. The name, as seen in the parameter file, is unchanged.
     </p></li>
     <li class="itemize">
     <!--l. 757--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">STEERABLE</span></span> specifies when a parameter value may be changed. By default, parameters may not be
     changed after the parameter file has been read, or on restarting from checkpoint. This option
     relaxes this restriction, specifying that the parameter may be changed at recovery time from a
     parameter file or at any time using the flesh routine <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ParameterSet</span>—see the Reference
     Guide.
                                                                                       
                                                                                       
     </p><!--l. 764--><p class="noindent" >The value <span 
class="cmtt-10">RECOVERY </span>is used in checkpoint/recovery situations, and indicates that the parameter may be
     altered until the value is read in from a recovery par file, but not after.
     </p></li>
     <li class="itemize">
     <!--l. 769--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">ACCUMULATOR</span></span> specifies that this is an <span 
class="cmti-10">accumulator </span>parameter. Such parameters cannot be set directly, but
     are set by other parameters who specify this one as an <span 
class="cmtt-10">ACCUMULATOR-BASE</span>. The expression is a
     two-parameter arithmetical expression of \(x\) and \(y\). Setting the parameter consists of evaluating this
     expression successively, with \(x\) being the current value of the parameter (at the first iteration this
     is the default value), and \(y\) the value of the setting parameter. This procedure is repeated,
     starting from the default value of the parameter, each time one of the setting parameters
     changes.
     </p></li>
     <li class="itemize">
     <!--l. 781--><p class="noindent" ><span class="obeylines-h"><span 
class="cmtt-10">ACCUMULATOR-BASE</span></span> specifies the name of an <span 
class="cmtt-10">ACCUMULATOR </span>parameter which this parameter
     sets.
</p>
     </li></ul>
<!--l. 786--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D2.4   </span> <a 
 id="x1-188000D2.4"></a>schedule.ccl</h3>
<!--l. 789--><p class="noindent" >(A more extensive discussion of Cactus scheduling is provided in Chapter <a 
href="#x1-76000C1.5">C1.5<!--tex4ht:ref: chap:scheduling --></a>.) A schedule configuration file
consists of: </p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 794--><p class="noindent" > <span 
class="cmti-10">Assignment statements </span>to switch on storage for grid variables for the entire duration of program
     execution.
     </p></li>
     <li class="itemize">
     <!--l. 797--><p class="noindent" > <span 
class="cmti-10">Schedule blocks </span>to schedule a subroutine from a thorn to be called at specific times during program
     execution in a given manner.
     </p></li>
     <li class="itemize">
     <!--l. 800--><p class="noindent" > <span 
class="cmti-10">Conditional statements </span>for both assignment statements and schedule blocks to allow them to be
     processed depending on parameter values.
</p>
     </li></ul>
                                                                                       
                                                                                       
<!--l. 805--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.4.1   </span> <a 
 id="x1-189000D2.4.1"></a>Assignment Statements</h4>
<!--l. 807--><p class="noindent" ><span 
class="cmti-10">Assignment statements</span>, currently only assign storage.
</p><!--l. 809--><p class="noindent" >These lines have the form: </p><div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">[STORAGE:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">],</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">]]</span>
</div>
</div>
<!--l. 814--><p class="noindent" >If the thorn is active, storage will be allocated, for the given groups, for the duration of program
execution (unless storage is explicitly switched off by some call to <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_DisableGroupStorage </span>within a
thorn).
</p><!--l. 819--><p class="noindent" >The storage line includes the number of timelevels to activate storage for, this number can be from 1 up to the
maximum number or timelevels for the group, as specified in the defining <span 
class="cmtt-10">interface.ccl </span>file. If the maximum
number of timelevels is 1 (the default), this number may be omitted. Alternatively <span 
class="cmsltt-10">timelevels </span>can be the name
of a parameter accessible to the thorn. The parameter name is the same as used in C routines of the
thorn, fully qualified parameter names of the form <span 
class="cmsltt-10">thorn</span><span 
class="cmtt-10">::</span><span 
class="cmsltt-10">parameter </span>are not allowed. In this
case 0 (zero) <span 
class="cmsltt-10">timelevels </span>can be requested, which is equivalent to the <span 
class="cmtt-10">STORAGE </span>statement being
absent.
</p><!--l. 830--><p class="noindent" >The behaviour of an assignment statement is independent of its position in the schedule file (so long as it is
outside a schedule block).
</p><!--l. 834--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.4.2   </span> <a 
 id="x1-190000D2.4.2"></a>Schedule Blocks</h4>
<!--l. 836--><p class="noindent" >Each <span 
class="cmti-10">schedule block </span>in the file <span class="obeylines-h"><span 
class="cmtt-10">schedule.ccl</span></span> must have the syntax
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">schedule</span><span 
class="cmtt-10"> [GROUP]</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">function</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">|</span><span 
class="cmsltt-10">group</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> AT|IN</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">time</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> </span><code class="verb">\</code>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [AS</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">alias</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> </span><code class="verb">\</code>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [WHILE</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> [IF</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">variable</span><span 
class="cmtt-10">&#x003E;]</span><span 
class="cmtt-10"> </span><code class="verb">\</code>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [BEFORE|AFTER</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">function</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;|(&#x003C;</span><span 
class="cmsltt-10">function</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">function</span><span 
class="cmsltt-10"> name</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> ...)]</span><span 
class="cmtt-10"> </span><code class="verb">\</code>
                                                                                       
                                                                                       
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [LANG:</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">language</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [OPTIONS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [TAGS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">keyword=value</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">keyword=value</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [STORAGE:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">],&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;[</span><span 
class="cmsltt-10">timelevels</span><span 
class="cmtt-10">]...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [READS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group-or-variable</span><span 
class="cmtt-10">&#x003E;[(</span><span 
class="cmsltt-10">region</span><span 
class="cmtt-10">)],[&#x003C;</span><span 
class="cmsltt-10">group-or-variable</span><span 
class="cmtt-10">&#x003E;[(</span><span 
class="cmsltt-10">region</span><span 
class="cmtt-10">)]]...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [WRITES:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group-or-variable</span><span 
class="cmtt-10">&#x003E;[(</span><span 
class="cmsltt-10">region</span><span 
class="cmtt-10">)],[&#x003C;</span><span 
class="cmsltt-10">group-or-variable</span><span 
class="cmtt-10">&#x003E;[(</span><span 
class="cmsltt-10">region</span><span 
class="cmtt-10">)]]...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [TRIGGER:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [SYNCHRONISE:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [OPTIONS:</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E;,&#x003C;</span><span 
class="cmsltt-10">option</span><span 
class="cmtt-10">&#x003E;...]</span>
<br /><span 
class="cmsy-10">}</span><span 
class="cmtt-10"> &#x0022;</span><span 
class="cmsltt-10">Description</span><span 
class="cmsltt-10"> of</span><span 
class="cmsltt-10"> function</span><span 
class="cmtt-10">&#x0022;</span>
</div>
</div>
<!--l. 856--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">GROUP</span>             </dt><dd 
class="list">
                  <!--l. 857--><p class="noindent" >Schedule  a  schedule  group  with  the  same  options  as  a  schedule  function.  The
                  schedule group will be created if it doesn’t exist.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">function name</span><span 
class="cmtt-10">|</span><span 
class="cmsltt-10">group name</span><span 
class="cmtt-10">&#x003E;</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 860--><p class="noindent" >The name of a function or a schedule group to be scheduled. Function and schedule
                  group names are case sensitive.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">&#x003C;</span><span 
class="cmsltt-10">group</span><span 
class="cmtt-10">&#x003E;</span>           </dt><dd 
class="list">
                  <!--l. 864--><p class="noindent" >A group of grid variables. Variable groups inherited from other thorns may be used,
                  but they must then be fully qualified with the implementation name.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">AT</span>                </dt><dd 
class="list">
                  <!--l. 868--><p class="noindent" >Functions  can  be  scheduled  to  run  at  the  Cactus  schedule  bins,  for  example,
                  <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EVOL</span>, and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span>. A complete list and description of these is provided
                  in Appendix <a 
href="#x1-207000D4">D4<!--tex4ht:ref: sec:Appendix.schedule_bins --></a>. The initial letters <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ </span>are optional. Grid variables cannot be
                  used in the <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN </span>timebins.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">IN</span>                </dt><dd 
class="list">
                  <!--l. 875--><p class="noindent" >Schedules a function or schedule group to run in a schedule group, rather than in
                  a Cactus timebin.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">AS</span>                </dt><dd 
class="list">
                  <!--l. 878--><p class="noindent" >Provides  an  alias  for  a  function  or  schedule  group  which  should  be  used  for
                  scheduling before, after or in. This can be used to provide thorn independence for
                  other thorns scheduling functions, or schedule groups relative to this one.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">WHILE</span>             </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 883--><p class="noindent" >Executes a function or schedule group until the given variable (which must be a
                  fully qualified integer grid scalar) has the value zero.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">IF</span>                </dt><dd 
class="list">
                  <!--l. 887--><p class="noindent" >Executes a function or schedule group only if the given variable (which must be a
                  fully qualified integer grid scalar) has a non-zero value.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">BEFORE/AFTER</span>      </dt><dd 
class="list">
                  <!--l. 891--><p class="noindent" >Takes  a  function  name,  a  function  alias,  a  schedule  group  name,  or  a
                  parentheses-enclosed whitespace-separated list of these. (Any names that are not
                  provided by an active thorn are ignored.) Note that a single schedule block may
                  have multiple <span 
class="cmtt-10">BEFORE/AFTER </span>clauses. See Section <a 
href="#x1-76000C1.5">C1.5<!--tex4ht:ref: chap:scheduling --></a> (“Scheduling”) in the Cactus
                  Users’ Guide for more information about <span 
class="cmtt-10">BEFORE/AFTER </span>clauses.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LANG</span>              </dt><dd 
class="list">
                  <!--l. 900--><p class="noindent" >The code language for the function (either <span 
class="cmtt-10">C </span>or <span 
class="cmtt-10">FORTRAN</span>). No language should be
                  specified for a schedule group.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">OPTIONS</span>           </dt><dd 
class="list">
                  <!--l. 903--><p class="noindent" >Schedule options are used for mesh refinement and multi-block simulations, and they
                  determine “where” a routine executes. Possible options are:
                      </p><dl class="description"><dt class="description">
                  <span 
class="cmtt-10">meta</span> </dt><dd 
class="description">
                      <!--l. 907--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">meta</span><span 
class="cmtt-10">_early</span> </dt><dd 
class="description">
                      <!--l. 908--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">meta</span><span 
class="cmtt-10">_late</span> </dt><dd 
class="description">
                      <!--l. 909--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">global</span> </dt><dd 
class="description">
                      <!--l. 910--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">global</span><span 
class="cmtt-10">_early</span> </dt><dd 
class="description">
                      <!--l. 911--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">global</span><span 
class="cmtt-10">_late</span> </dt><dd 
class="description">
                      <!--l. 912--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">level</span> </dt><dd 
class="description">
                      <!--l. 913--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">singlemap</span> </dt><dd 
class="description">
                      <!--l. 914--><p class="noindent" >
                                                                                       
                                                                                       
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">local</span> </dt><dd 
class="description">
                      <!--l. 915--><p class="noindent" >(default, may be omitted)</p></dd></dl>
                  <!--l. 917--><p class="noindent" >(Only one of these options may be used.) These options can be combined with the
                  following:
                      </p><dl class="description"><dt class="description">
                  <span 
class="cmtt-10">loop</span><span 
class="cmtt-10">_meta</span> </dt><dd 
class="description">
                      <!--l. 920--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">loop</span><span 
class="cmtt-10">_global</span> </dt><dd 
class="description">
                      <!--l. 921--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">loop</span><span 
class="cmtt-10">_level</span> </dt><dd 
class="description">
                      <!--l. 922--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">loop</span><span 
class="cmtt-10">_singlemap</span> </dt><dd 
class="description">
                      <!--l. 923--><p class="noindent" >
                      </p></dd><dt class="description">
                  <span 
class="cmtt-10">loop</span><span 
class="cmtt-10">_local</span> </dt><dd 
class="description">
                      <!--l. 924--><p class="noindent" ></p></dd></dl>
                  <!--l. 926--><p class="noindent" >(At most one of the <span 
class="cmtt-10">loop</span><span 
class="cmtt-10">_... </span>options may be used.)
                  </p></dd><dt class="list">
<span 
class="cmtt-10">TAGS</span>              </dt><dd 
class="list">
                  <!--l. 928--><p class="noindent" >Schedule tags. These tags must have the form <span 
class="cmtt-10">keyword=value</span>, and must be in a syntax
                  accepted by <span 
class="cmtt-10">Util</span><span 
class="cmtt-10">_TableCreateFromString</span>.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">STORAGE</span>           </dt><dd 
class="list">
                  <!--l. 932--><p class="noindent" >List of variable groups which should have storage switched on for the duration of the
                  function or schedule group. Each group must specify how many timelevels to activate
                  storage for, from 1 up to the maximum number for the group as specified in the defining
                  <span 
class="cmtt-10">interface.ccl </span>file. If the maximum is 1 (the default) this number may be omitted.
                  Alternatively <span 
class="cmsltt-10">timelevels </span>can be the name of a parameter accessible to the thorn. The
                  parameter name is the same as used in C routines of the thorn, fully qualified parameter
                  names of the form <span 
class="cmsltt-10">thorn</span><span 
class="cmtt-10">::</span><span 
class="cmsltt-10">parameter </span>are not allowed. In this case 0 (zero)
                  <span 
class="cmsltt-10">timelevels </span>can be requested, which is equivalent to the <span 
class="cmtt-10">STORAGE </span>statement being
                  absent.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">READS/WRITES</span>      </dt><dd 
class="list">
                  <!--l. 944--><p class="noindent" ><span 
class="cmtt-10">READS/WRITES </span>are used to declare which grid variables are read/written by the routine.
                  This information is used e.g. to determine which variables need to be synchronized, copied
                  between host and device for OpenCL or CUDA kernel, or poisoned as part of error
                  checking.
                  </p><!--l. 949--><p class="noindent" ><span 
class="cmtt-10">READS/WRITE </span>directives can be applied to either a variable or a group of variables and may
                  also contain a region specification. The region specification can be EVERYWHERE, or
                  ALL, INTERIOR, or IN, INTERIOWITHBOUNDARY, or BOUNDARY. A
                                                                                       
                                                                                       
                  missing region defaults to EVERYWHERE for <span 
class="cmtt-10">READS </span>and INTERIOR for
                  <span 
class="cmtt-10">WRITES</span>. If a function needs to read a given grid function everywhere and
                  only the interior is valid (i.e. has been written to), then a synchronization is
                  required and will happen automatically if enabled with the Cactus parameter
                  <span 
class="cmtt-10">presync</span><span 
class="cmtt-10">_mode</span>.
                  </p><!--l. 957--><p class="noindent" >When grid functions are updated in this way, not only ghost zones, but boundary zones
                  will be updated by the drier. Use either the function <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SelectGroupForBC </span>or
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SelectVarForBC </span>to tell the driver how it should update a group or variable. The
                  arguments to both functions are the same as those found in the Boundary thorn, but with
                  the prefix <span 
class="cmtt-10">Boundary</span><span 
class="cmtt-10">_ </span>instead of <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_</span>:
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-125">
                  Driver_SelectGroupForBC(CCTK_ARGUMENTS,
                                          CCTK_INT faces,
                                          CCTK_INT width,
                                          CCTK_INT table_handle,
                                          CCTK_STRING group_name,
                                          CCTK_STRING bc_name)
                  
                  Driver_SelectVarForBC(CCTK_ARGUMENTS,
                                        CCTK_INT faces,
                                        CCTK_INT width,
                                        CCTK_INT table_handle,
                                        CCTK_STRING var_name,
                                        CCTK_STRING bc_name)
</pre>
                  <!--l. 978--><p class="nopar" >
                  </p><!--l. 980--><p class="noindent" >Note that the above two functions, unlike their similarly named components in the
                  Boundary thorn, only need to be called once. The information they provide will
                  then be used each time the driver synchronizes the named grid function or
                  group.
                  </p><!--l. 982--><p class="noindent" >It is possible, however, that the thorn you are creating does not know the correct
                  READS/WRITES information at compile time. I/O thorns, for example, do not know
                  which grid functions they will access until run time. Likewise, the Method of
                  Lines thorn does not know which grid functions it is operating on until run
                  time.
                  </p><!--l. 985--><p class="noindent" >For situations like these, we have the following functions which can be used
                  to check READS/WRITES data and perform synchronization at run time:
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_RequireValidData</span>, <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_NotifyDataModified</span>, <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_GetValidRegion</span>, and
                  <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SetValidRegion</span>. For details on these functions, please consult the Reference
                  Manual.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">TRIGGER</span>           </dt><dd 
class="list">
                  <!--l. 988--><p class="noindent" >List of grid variables or groups to be used as triggers for causing an <span 
class="cmtt-10">ANALYSIS </span>function or
                  group to be executed. Any schedule block for an analysis function or analysis group may
                  contain a <span 
class="cmtt-10">TRIGGER </span>line.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">SYNCHRONISE</span>       </dt><dd 
class="list">
                  <!--l. 993--><p class="noindent" >List of groups to be synchronised, as soon as the function or schedule group is
                  exited.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">OPTIONS</span>           </dt><dd 
class="list">
                  <!--l. 996--><p class="noindent" >List of additional options (see below) for the scheduled function or group of
                  functions
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<!--l. 1000--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-191000"></a>Allowed Options</h5>
<a 
 id="x1-191000doc"></a>
<!--l. 1004--><p class="noindent" >Cactus understands the following options. These options are interpreted by the driver, not by Cactus. The
current set of options is useful for Berger-Oliger mesh refinement which has subcycling in time, and for
multi-patch simulations in which the domain is split into several distinct patches. Given this, the meanings of the
options below is only tentative, and their exact meaning needs to be obtained from the driver documentation.
The standard driver PUGH ignores all options.
</p><!--l. 1013--><p class="noindent" >Option names are case-insensitive. There can be several options given at the same time.
</p><!--l. 1016--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">META</span>              </dt><dd 
class="list">
                  <!--l. 1018--><p class="noindent" >This routine will only be called once, even if several simulations are performed at
                  the same time. This can be used, for example, to initialise external libraries, or to
                  set up data structures that live in global variables.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">META-EARLY</span>        </dt><dd 
class="list">
                  <!--l. 1023--><p class="noindent" >This option is identical to to <span 
class="cmtt-10">META </span>option with the exception that the routine will
                  be called together with the routines on the first subgrid.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">META-LATE</span>         </dt><dd 
class="list">
                  <!--l. 1027--><p class="noindent" >This option is identical to to <span 
class="cmtt-10">META </span>option with the exception that the routine will
                  be called together with the routines on the last subgrid.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">GLOBAL</span>            </dt><dd 
class="list">
                  <!--l. 1031--><p class="noindent" >This routine will only be called once on a grid hierarchy, not for all subgrids making
                  up the hierarchy. This can be used, for example, for analysis routines which use
                  global reduction or interpolation routines, rather than the local subgrid passed to
                  them, and hence should only be called once.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">GLOBAL-EARLY</span>      </dt><dd 
class="list">
                  <!--l. 1037--><p class="noindent" >This option is identical to to <span 
class="cmtt-10">GLOBAL </span>option with the exception that the routine
                  will be called together with the routines on the first subgrid.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">GLOBAL-LATE</span>       </dt><dd 
class="list">
                  <!--l. 1041--><p class="noindent" >This option is identical to to <span 
class="cmtt-10">GLOBAL </span>option with the exception that the routine
                  will be called together with the routines on the last subgrid.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LEVEL</span>             </dt><dd 
class="list">
                  <!--l. 1045--><p class="noindent" >This routine will only be called once on any “level” of the grid hierarchy. That is, it
                  will only be called once for any set of sub-grids which have the same <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_levfac</span>
                  and <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_level </span>numbers.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">SINGLEMAP</span>         </dt><dd 
class="list">
                  <!--l. 1050--><p class="noindent" >This routine will only be called once on any of the “patches” that form a “level” of
                  the grid hierarchy.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LOCAL </span><span 
class="cmss-10">(this is the default)</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1053--><p class="noindent" >This   routine   will   be   called   on   every   “component”,   identified   by   their
                  <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_component </span>number.
</p>
                  </dd></dl>
<!--l. 1059--><p class="noindent" >When the above options are used, it is often the case that a certain routine should, e.g. be called at the time for
a <span 
class="cmtt-10">GLOBAL </span>routine, but should actually loop over all “components”. The following set of options allows
this:
</p><!--l. 1064--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">LOOP-META</span>         </dt><dd 
class="list">
                  <!--l. 1066--><p class="noindent" >Loop once.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LOOP-GLOBAL</span>       </dt><dd 
class="list">
                  <!--l. 1068--><p class="noindent" >Loop over all simulations.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LOOP-LEVEL</span>        </dt><dd 
class="list">
                  <!--l. 1070--><p class="noindent" >Loop over all “levels”.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LOOP-SINGLEMAP</span>    </dt><dd 
class="list">
                  <!--l. 1072--><p class="noindent" >Loop over all “patches”.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">LOOP-LOCAL</span>        </dt><dd 
class="list">
                  <!--l. 1074--><p class="noindent" >Loop over all “components”.
</p>
                  </dd></dl>
<!--l. 1078--><p class="noindent" >For example, the specification </p><div class="alltt">
                                                                                       
                                                                                       
<div class="obeylines-v">
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> OPTIONS:</span><span 
class="cmtt-10"> global</span><span 
class="cmtt-10"> loop-local</span>
</div>
</div> schedules a routine at the time when a <span 
class="cmtt-10">GLOBAL </span>routine is scheduled, and then calls the routine in a loop over all
“components”.
<!--l. 1087--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.4.3   </span> <a 
 id="x1-192000D2.4.3"></a>Conditional Statements</h4>
<!--l. 1089--><p class="noindent" >Any schedule block or assignment statements can be optionally surrounded by conditional <span class="obeylines-h"><span 
class="cmtt-10">if-elseif-else</span></span>
constructs using the parameter data base. These can be nested, and have the general form:
</p>
<div class="alltt">
<div class="obeylines-v">
<br /><span 
class="cmtt-10">if</span><span 
class="cmtt-10"> (&#x003C;</span><span 
class="cmsltt-10">conditional-expression</span><span 
class="cmtt-10">&#x003E;)</span>
<br /><span 
class="cmsy-10">{</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [&#x003C;</span><span 
class="cmsltt-10">assignments</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [&#x003C;</span><span 
class="cmsltt-10">schedule</span><span 
class="cmsltt-10"> blocks</span><span 
class="cmtt-10">&#x003E;]</span>
<br /><span 
class="cmsy-10">}</span>
</div>
</div>
<!--l. 1101--><p class="noindent" >¡<span 
class="cmsltt-10">conditional-expression</span>¿ can be any valid C construct evaluating to a truth value. Such conditionals are
evaluated only at program startup, and are used to pick between different static schedule options. For dynamic
scheduling, the <span 
class="cmtt-10">SCHEDULE WHILE </span>construction should be used.
</p><!--l. 1107--><p class="noindent" >Conditional constructs cannot be used inside a schedule block.
</p><!--l. 1111--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D2.5   </span> <a 
 id="x1-193000D2.5"></a>configuration.ccl</h3>
<!--l. 1114--><p class="noindent" >[<span 
class="cmbx-10">NOTE: </span>The configuration.ccl is still relatively new, and not all features listed below may be fully implemented
or functional.]
                                                                                       
                                                                                       
</p><!--l. 1117--><p class="noindent" >A configuration.ccl file defines <span 
class="cmbx-10">capabilities </span>which a thorn either provides or requires, or may use if available.
Unlike <span 
class="cmbx-10">implementations</span>, only one thorn providing a particular capability may be compiled into a
configuration at one time. Thus, this mechanism may be used to, for example: provide access to external
libraries; provide access to functions which other thorns must call, but are too complex for function
aliasing; or to split a thorn into several thorns, all of which require some common (not aliased)
functions.
</p><!--l. 1126--><p class="noindent" >A configuration options file can contain any number of the following sections:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1132--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">PROVIDES</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Capability</span><span 
class="cmtt-10">&#x003E;</span>
     <br /><span 
class="cmsy-10">{</span>
     <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> SCRIPT</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Configuration</span><span 
class="cmsltt-10"> script</span><span 
class="cmtt-10">&#x003E;</span>
     <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [VERSION</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Version</span><span 
class="cmsltt-10"> String</span><span 
class="cmtt-10">&#x003E;]</span>
     <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> LANG</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Language</span><span 
class="cmtt-10">&#x003E;</span>
     <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> [OPTIONS</span><span 
class="cmtt-10"> [&#x003C;option&#x003E;[,&#x003C;option&#x003E;]...]]</span>
     <br /><span 
class="cmsy-10">}</span>
</div>
     </div>
     <!--l. 1143--><p class="noindent" >Informs the CST that this thorn provides a given capability, and that this capability has a given detection
     script which may be used to configure it (e.g. running an autoconf script or detecting an
     external library’s location). The script should output configuration information on its standard
     output—the syntax is described below in Section <a 
href="#x1-194000D2.5.1">D2.5.1<!--tex4ht:ref: sec:Appendix.configuration.ccl.configscript --></a>. The script may also indicate the failure to
     detect a capability by returning a non-zero exit code; this will stop the build after the CST
     stage.
     </p><!--l. 1153--><p class="noindent" >All capabilities have an optional version attached to them, so that other thorns can depend on such a
     specific version. Version strings can only contain letters, numbers, or “.+-:” (dot, plus, minus, colon), and
     have to start with a number. Specifying a version number is optional. If none is given, “0.0.1” is
     assumed.
     </p><!--l. 1159--><p class="noindent" >Scripts can be in any language. If an interpreter is needed to run the script, for example <span class="obeylines-h"><code class="verb">Perl</code></span>, this should
     be indicated by the <span class="obeylines-h"><code class="verb">LANG</code></span> option.
     </p><!--l. 1163--><p class="noindent" >The specified options are checked for in the original configuration, and any options passed on the
     command line (including an ‘options’ file) at compile time when the thorn is added, or if
     the CST is rerun. These options need be set only once, and will be remembered between
     builds.
     </p></li>
     <li class="itemize">
     <!--l. 1170--><p class="noindent" >
                                                                                       
                                                                                       
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">REQUIRES</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Capability</span><span 
class="cmtt-10">&#x003E;</span><span 
class="cmtt-10"> [(</span><span 
class="cmsltt-10">Comparison</span><span 
class="cmsltt-10"> operator</span><span 
class="cmtt-10"> </span><span 
class="cmsltt-10">Version</span><span 
class="cmsltt-10"> string</span><span 
class="cmtt-10">)]</span>
</div>
     </div>
     <!--l. 1175--><p class="noindent" >Informs the CST that this thorn requires a certain capability to be present. If no thorn providing the
     capability is in the ThornList, the build will stop after the CST stage.
     </p><!--l. 1179--><p class="noindent" >Optionally, thorns can depend on a capability version. This has to be enclosed in parentheses, following the
     capability name. Inside the parenthesis, first a comparison operator determines the kind of dependency on
     the requested capability version, which has to be attached without spaces. Valid operators and their
     meaning are: </p>
         <ul class="itemize2">
         <li class="itemize">
         <!--l. 1184--><p class="noindent" >Requesting capability strictly older than given version
         </p></li>
         <li class="itemize">
         <!--l. 1185--><p class="noindent" >Requesting capability older or equal to given version
         </p></li>
         <li class="itemize">
         <!--l. 1186--><p class="noindent" >Requesting capability exactly equal to given version
         </p></li>
         <li class="itemize">
         <!--l. 1187--><p class="noindent" >Requesting capability newer or equal to given version
         </p></li>
         <li class="itemize">
         <!--l. 1188--><p class="noindent" >Requesting capability strictly newer than given version.</p></li></ul>
     <!--l. 1190--><p class="noindent" >Version strings are compared from left to right. First the initial part of each string consisting entirely of
     digits is determined. The integer values of these two parts are compared. If a difference is found it is
     returned. Then the initial part of the remainder of each string which consists entirely of non-digit
     characters is determined. The two parts are compared lexically, and any difference found is returned as the
     result of the comparison. The lexical comparison is a comparison of ASCII values. These two steps
     (comparing and removing initial non-digit strings and initial digit strings) are repeated until a difference is
     found or both strings are exhausted. Spaces inside the parentheses are allowed, except inside the operator
     or version string.
     </p><!--l. 1201--><p class="noindent" >Example:
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">REQUIRES</span><span 
class="cmtt-10"> ExampleCapability</span><span 
class="cmtt-10"> (&#x003E;=2.43.2dev-1)</span>
                                                                                       
                                                                                       
</div>
     </div>
     </li>
     <li class="itemize">
     <!--l. 1209--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">OPTIONAL</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">Capability</span><span 
class="cmtt-10">&#x003E;</span>
     <br /><span 
class="cmsy-10">{</span>
     <br /><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> DEFINE</span><span 
class="cmtt-10"> &#x003C;</span><span 
class="cmsltt-10">macro</span><span 
class="cmtt-10">&#x003E;</span>
     <br /><span 
class="cmsy-10">}</span>
</div>
     </div>
     <!--l. 1217--><p class="noindent" >Informs the CST that this thorn may use a certain capability, if a thorn providing it is in the
     ThornList. If present, the preprocessor macro, <span class="obeylines-h"><code class="verb">macro</code></span>, will be defined and given the value
     “1”.
</p>
     </li></ul>
<!--l. 1223--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D2.5.1   </span> <a 
 id="x1-194000D2.5.1"></a>Configuration Scripts</h4>
<!--l. 1226--><p class="noindent" >The configuration script may tell the CST to add certain features to the Cactus environment—either to the
make system or to header files included by thorns. It does this by outputting lines to its standard
output:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 1236--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">BEGIN</span><span 
class="cmtt-10"> DEFINE</span>
     <br /><span 
class="cmtt-10">&#x003C;text&#x003E;</span>
     <br /><span 
class="cmtt-10">END</span><span 
class="cmtt-10"> DEFINE</span>
                                                                                       
                                                                                       
</div>
     </div>
     <!--l. 1243--><p class="noindent" >Places a set of definitions in a header file which will be included by all thorns using this capability (either
     through an OPTIONAL or REQUIRES entry in their configuration.ccl files).
     </p></li>
     <li class="itemize">
     <!--l. 1248--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">INCLUDE_DIRECTORY</span><span 
class="cmtt-10"> </span><span 
class="cmtt-10"> &#x003C;directory&#x003E;</span>
</div>
     </div>
     <!--l. 1253--><p class="noindent" >Adds a directory to the include path used for compiling files in thorns using this capability.
     </p></li>
     <li class="itemize">
     <!--l. 1257--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">BEGIN</span><span 
class="cmtt-10"> MAKE_DEFINITION</span>
     <br /><span 
class="cmtt-10">&#x003C;text&#x003E;</span>
     <br /><span 
class="cmtt-10">END</span><span 
class="cmtt-10"> MAKE_DEFINITION</span>
</div>
     </div>
     <!--l. 1264--><p class="noindent" >Adds a makefile definition into the compilation of all thorns using this capability.
     </p></li>
     <li class="itemize">
     <!--l. 1268--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">BEGIN</span><span 
class="cmtt-10"> MAKE_DEPENDENCY</span>
     <br /><span 
class="cmtt-10">&#x003C;text&#x003E;</span>
     <br /><span 
class="cmtt-10">END</span><span 
class="cmtt-10"> MAKE_DEPENDENCY</span>
</div>
     </div>
     <!--l. 1275--><p class="noindent" >Adds makefile dependency information into the compilation of all thorns using this capability.
                                                                                       
                                                                                       
     </p></li>
     <li class="itemize">
     <!--l. 1279--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">LIBRARY</span><span 
class="cmtt-10"> &#x003C;library&#x003E;</span>
</div>
     </div>
     <!--l. 1284--><p class="noindent" >Adds a library to the final cactus link.
     </p></li>
     <li class="itemize">
     <!--l. 1287--><p class="noindent" >
</p>
     <div class="alltt">
     <div class="obeylines-v">
     <br /><span 
class="cmtt-10">LIBRARY_DIRECTORY</span><span 
class="cmtt-10"> &#x003C;library&#x003E;</span>
</div>
     </div>
     <!--l. 1292--><p class="noindent" >Adds a directory to the list of directories searched for libraries at link time.
</p>
     </li></ul>
<!--l. 1297--><p class="noindent" >No other lines should be output by the script.
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter D3</span><br /><a 
 id="x1-195000D3"></a>Utility Routines</h2>
<h3 class="sectionHead"><span class="titlemark">D3.1   </span> <a 
 id="x1-196000D3.1"></a>Introduction</h3>
<!--l. 1307--><p class="noindent" >As well as the high-level <span class="obeylines-h"><code class="verb">CCTK_</code></span>* routines, Cactus also provides a set of lower-level <span class="obeylines-h"><code class="verb">Util_</code></span>* utility routines, which
are mostly independent of the rest of Cactus. This chapter gives a general overview of programming with these
utility routines.
</p><!--l. 1314--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D3.2   </span> <a 
 id="x1-197000D3.2"></a>Key/Value Tables</h3>
<!--l. 1318--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.1   </span> <a 
 id="x1-198000D3.2.1"></a>Motivation</h4>
<!--l. 1320--><p class="noindent" >Cactus functions may need to pass information through a generic interface. In the past, we have used various ad
hoc means to do this, and we often had trouble passing ”extra” information that wasn’t anticipated in the
original design. For example, for periodic output of grid variables, <span class="obeylines-h"><code class="verb">CCTK_OutputVarAsByMethod()</code></span> requires that
any parameters (such as hyperslabbing parameters) be appended as an option string to the variable’s character
string name. Similarly, elliptic solvers often need to pass various parameters, but we haven’t had a good way to
do this.
</p><!--l. 1331--><p class="noindent" >Key/value tables (<span 
class="cmti-10">tables </span>for short) provide a clean solution to these problems. They’re implemented by the
<span class="obeylines-h"><code class="verb">Util_Table</code></span>* functions (described in detail in the Reference Manual).
</p><!--l. 1337--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.2   </span> <a 
 id="x1-199000D3.2.2"></a>The Basic Idea</h4>
<!--l. 1339--><p class="noindent" >Basically, a table is an object which maps strings to almost arbitrary user-defined data. (If you know Perl, a
table is very much like a Perl hash table. Alternatively, if you know Unix shells, a table is like the set of all
environment variables. As yet another analogy, if you know Awk, a table is like an Awk associative
                                                                                       
                                                                                       
array.)<span class="footnote-mark"><a 
href="UsersGuide12.html#fn1x13"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-199001f1"></a> 
</p><!--l. 1352--><p class="noindent" >More formally, a table is an object which stores a set of <span 
class="cmti-10">keys </span>and a corresponding set of <span 
class="cmti-10">values</span>. We refer to a
(key,value) pair as a table <span 
class="cmti-10">entry</span>.
</p><!--l. 1356--><p class="noindent" >Keys are C-style null-terminated character strings, with the slash character ‘<span 
class="cmtt-10">/</span>’ reserved for future
expansion.<span class="footnote-mark"><a 
href="UsersGuide13.html#fn2x13"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-199003f2"></a> 
</p><!--l. 1363--><p class="noindent" >Values are 1-dimensional arrays of any of the usual Cactus data types, described in Section <a 
href="#x1-142000C1.9.8">C1.9.8<!--tex4ht:ref: sect-ThornWriting/DataTypes --></a>. A string
can be stored by treating it as a 1-dimensional array of <span class="obeylines-h"><code class="verb">CCTK_CHAR</code></span> (there’s an example of this
below).
</p><!--l. 1368--><p class="noindent" >The basic “life cycle” of a table looks like this:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-199006x1">
     <!--l. 1370--><p class="noindent" >Some code creates it with <span class="obeylines-h"><code class="verb">Util_TableCreate()</code></span> or <span class="obeylines-h"><code class="verb">Util_TableClone()</code></span>.
     </p></li>
<li 
  class="enumerate" id="x1-199008x2">
     <!--l. 1372--><p class="noindent" >Some  code  (often  the  same  piece  of  code,  but  maybe  some  other  piece)  sets  entries  in  it
     using one or more of the <span class="obeylines-h"><code class="verb">Util_TableSet*()</code></span>, <span class="obeylines-h"><code class="verb">Util_TableSet*Array()</code></span>, <span class="obeylines-h"><code class="verb">Util_TableSetGeneric()</code></span>,
     <span class="obeylines-h"><code class="verb">Util_TableSetGenericArray()</code></span>, and/or <span class="obeylines-h"><code class="verb">Util_TableSetString()</code></span> functions.
     </p></li>
<li 
  class="enumerate" id="x1-199010x3">
     <!--l. 1377--><p class="noindent" >Some  other  piece  or  pieces  of  code  can  get  (copies  of)  the  values  which  were  set,  using
     one  or  more  of  the  <span class="obeylines-h"><code class="verb">Util_TableGet*()</code></span>,  <span class="obeylines-h"><code class="verb">Util_TableGet*Array()</code></span>,  <span class="obeylines-h"><code class="verb">Util_TableGetGeneric()</code></span>,
     <span class="obeylines-h"><code class="verb">Util_TableGetGenericArray()</code></span>, and/or <span class="obeylines-h"><code class="verb">Util_TableGetString()</code></span> functions.
     </p></li>
<li 
  class="enumerate" id="x1-199012x4">
     <!--l. 1382--><p class="noindent" >When  everyone  is  through  with  a  table,  some  (single)  piece  of  code  should  destroy  it  with
     <span class="obeylines-h"><code class="verb">Util_TableDestroy()</code></span>.</p></li></ol>
<!--l. 1386--><p class="noindent" >There are also convenience functions <span class="obeylines-h"><code class="verb">Util_TableSetFromString()</code></span> to set entries in a table based on a
parameter-file-style string, and <span class="obeylines-h"><code class="verb">Util_TableCreateFromString()</code></span> to create a table and then set entries in it
based on a parameter-file-style string.
                                                                                       
                                                                                       
</p><!--l. 1391--><p class="noindent" >As well, there are “table iterator” functions <span class="obeylines-h"><code class="verb">Util_TableIt*()</code></span> to allow manipulation of a table even if you don’t
know its keys.
</p><!--l. 1394--><p class="noindent" >A table has an integer “flags word” which may be used to specify various options, via bit flags defined in
<span class="obeylines-h"><code class="verb">util_Table.h</code></span>. For example, the flags word can be used to control whether keys should be compared as case
sensitive or case insensitive strings. See the detailed function description of <span class="obeylines-h"><code class="verb">Util_TableCreate()</code></span> in the
Reference Manual for a list of the possible bit flags and their semantics.
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.3   </span> <a 
 id="x1-200000D3.2.3"></a>A Simple Example</h4>
<!--l. 1407--><p class="noindent" >Here’s a simple example (in C)<span class="footnote-mark"><a 
href="UsersGuide14.html#fn3x13"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-200001f3"></a> 
of how to use a table:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-126">
#include &#x0022;util_Table.h&#x0022;
#include &#x0022;cctk.h&#x0022;

/* create a table and set some entries in it */
int handle = Util_TableCreate(UTIL_TABLE_FLAGS_DEFAULT);
Util_TableSetInt(handle, 2, &#x0022;two&#x0022;);
Util_TableSetReal(handle, 3.14, &#x0022;pi&#x0022;);

...

/* get the values from the table */
CCTK_INT two_value;
CCTK_REAL pi_value;
Util_TableGetInt(handle, &#x0026;two_value, &#x0022;two&#x0022;);    /* sets two_value = 2 */
Util_TableGetReal(handle, &#x0026;pi_value, &#x0022;pi&#x0022;);     /* sets pi_value = 3.14 */
</pre>
<!--l. 1431--><p class="nopar" >
</p><!--l. 1433--><p class="noindent" >Actually, you shouldn’t write code like this—in the real world errors sometimes happen, and it’s much better to
catch them close to their point of occurrence, rather than silently produce garbage results or crash your
program. So, the <span 
class="cmti-10">right </span>thing to do is to always check for errors. To allow this, all the table routines return a
status, which is zero or positive for a successful return, but negative if and only if some sort of error has
occurred.<span class="footnote-mark"><a 
href="UsersGuide15.html#fn4x13"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-200003f4"></a> 
So, the above example should be rewritten like this:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-127">
#include &#x0022;util_Table.h&#x0022;

/* create a table and set some entries in it */
int handle = Util_TableCreate(UTIL_TABLE_FLAGS_DEFAULT);
if (handle &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t create table!&#x0022;);

/* try to set some table entries */
if (Util_TableSetInt(handle, 2, &#x0022;two&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t set integer value in table!&#x0022;);
if (Util_TableSetReal(handle, 3.14, &#x0022;pi&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t set real value in table!&#x0022;);

...

/* try to get the values from the table */
CCTK_INT two_value;
CCTK_REAL pi_value;
if (Util_TableGetInt(handle, &#x0026;two_value, &#x0022;two&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t get integer value from table!&#x0022;);
if (Util_TableGetReal(handle, &#x0026;pi_value, &#x0022;pi&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t get integer value from table!&#x0022;);

/* if we get to here, then two_value = 2 and pi_value = 3.14 */
</pre>
<!--l. 1476--><p class="nopar" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.4   </span> <a 
 id="x1-201000D3.2.4"></a>Arrays as Table Values</h4>
<!--l. 1482--><p class="noindent" >As well as a single numbers (or characters or pointers), tables can also store 1-dimensional arrays of numbers (or characters
or pointers).<span class="footnote-mark"><a 
href="UsersGuide16.html#fn5x13"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-201001f5"></a> 
</p><!--l. 1492--><p class="noindent" >For example (continuing the previous example):
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-128">
static const CCTK_INT a[3] = { 42, 69, 105 };
if (Util_TableSetIntArray(handle, 3, a, &#x0022;my array&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t set integer array value in table!&#x0022;);

...

CCTK_INT blah[10];
int count = Util_TableGetIntArray(handle, 10, blah, &#x0022;my array&#x0022;);
if (count &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t get integer array value from table!&#x0022;);
/* now count = 3, blah[0] = 42, blah[1] = 69, blah[2] = 105, */
/*     and all remaining elements of blah[] are unchanged */
</pre>
<!--l. 1506--><p class="nopar" >As you can see, a table entry remembers the length of any array value that has been stored in
it.<span class="footnote-mark"><a 
href="UsersGuide17.html#fn6x13"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-201003f6"></a> 
</p><!--l. 1516--><p class="noindent" >If you only want the first few values of a larger array, just pass in the appropriate length of your array, that’s
OK:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-129">
CCTK_INT blah2[2];
int count = Util_TableGetIntArray(handle, 2, blah2, &#x0022;my array&#x0022;);
if (count &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t get integer array value from table!&#x0022;);
/* now count = 3, blah2[0] = 42, blah2[1] = 69 */
</pre>
<!--l. 1525--><p class="nopar" >You can even ask for just the first value:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-130">
CCTK_INT blah1;
int count = Util_TableGetInt(handle, &#x0026;blah1, &#x0022;my array&#x0022;);
if (count &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t get integer array value from table!&#x0022;);
/* now count = 3, blah1 = 42 */
</pre>
<!--l. 1533--><p class="nopar" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.5   </span> <a 
 id="x1-202000D3.2.5"></a>Character Strings</h4>
<!--l. 1539--><p class="noindent" >One very common thing you might want to store in a table is a character string. While you could do this by
explicitly storing an array of <span class="obeylines-h"><code class="verb">CCTK_CHAR</code></span>, there are also routines specially for conveniently setting and getting
strings:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-131">
if (Util_TableSetString(handle, &#x0022;black holes are fun&#x0022;, &#x0022;bh&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t set string value in table!&#x0022;);

...
char buffer[50];
if (Util_TableGetString(handle, 50, buffer, &#x0022;bh&#x0022;) &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t get string value from table!&#x0022;);

/* now buffer[] contains the string &#x0022;black holes are fun&#x0022; */
</pre>
<!--l. 1553--><p class="nopar" >
</p><!--l. 1555--><p class="noindent" ><span class="obeylines-h"><code class="verb">Util_TableGetString()</code></span> guarantees that the string is terminated by a null character (‘<span class="obeylines-h"><code class="verb">\0</code></span>’), and also returns an
error if the string is too long for the buffer.
</p><!--l. 1561--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.6   </span> <a 
 id="x1-203000D3.2.6"></a>Convenience Routines</h4>
<!--l. 1563--><p class="noindent" >There are also convenience routines for the common case of setting values in a table based on a
string.
</p><!--l. 1566--><p class="noindent" >For example, the following code sets up exactly the same table as the example in Section <a 
href="#x1-200000D3.2.3">D3.2.3<!--tex4ht:ref: Tables_Simple_Example --></a>:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-132">
#include &#x003C;util_Table.h&#x003E;

/* create a table and set some values in it */
int handle = Util_TableCreate(UTIL_TABLE_FLAGS_DEFAULT);
if (handle &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t create table!&#x0022;);

/* try to set some table entries */
if (Util_TableSetFromString(handle, &#x0022;two=2 pi=3.14&#x0022;) != 2)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t set values in table!&#x0022;);
</pre>
<!--l. 1580--><p class="nopar" >
</p><!--l. 1582--><p class="noindent" >There is also an even higher-level convenience function <span class="obeylines-h"><code class="verb">Util_TableCreateFromString()</code></span>: this creates a table
with the case insensitive flag set (to match Cactus parameter file semantics), then (assuming no errors occurred)
calls <span class="obeylines-h"><code class="verb">Util_TableSetFromString()</code></span> to set values in the table.
</p><!--l. 1588--><p class="noindent" >For example, the following code sets up a table (with the case insensitive flag set) with four entries: an integer
number (<span 
class="cmtt-10">two</span>), a real number (<span 
class="cmtt-10">pi</span>), a string (<span 
class="cmtt-10">buffer</span>), and an integer array with three elements
(<span 
class="cmtt-10">array</span>):
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-133">
#include &#x003C;util_Table.h&#x003E;

int handle = Util_TableCreateFromString(&#x0022; two    = 2 &#x0022;
                                        &#x0022; pi     = 3.14 &#x0022;
                                        &#x0022; buffer = ’Hello World’ &#x0022;
                                        &#x0022; array  = { 1 2 3 }&#x0022;);
if (handle &#x003C; 0)
        CCTK_WARN(CCTK_WARN_ABORT, &#x0022;couldn’t create table from string!&#x0022;);
</pre>
<!--l. 1602--><p class="nopar" >
</p><!--l. 1604--><p class="noindent" >Note  that  this  code  passes  a  single  string  to
<span class="obeylines-h"><code class="verb">Util_TableCreateFromString()</code></span><span class="footnote-mark"><a 
href="UsersGuide18.html#fn7x13"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-203001f7"></a> ,
which then gets parsed into key/value pairs, with the key separated from its corresponding value by an equals
sign.
</p><!--l. 1611--><p class="noindent" >Values for numbers are converted into integers (<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INT</span>) if possible (no decimal point appears in the value),
otherwise into reals (<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_REAL</span>). Strings must be enclosed in either single or double quotes. String values in
single quotes are interpreted literally, strings in double quotes may contain character escape codes which then
will be interpreted as in C. Arrays must be enclosed in curly braces, array elements must be single numbers of
the same type (either all integer or all real).
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.7   </span> <a 
 id="x1-204000D3.2.7"></a>Table Iterators</h4>
<!--l. 1624--><p class="noindent" >In the examples up to now, the code, which wanted to get values from the table, knew what the keys were. It’s
also useful to be able to write generic code which can operate on a table without knowing the keys. “Table
iterators” (“iterators”, for short) are used for this.
</p><!--l. 1629--><p class="noindent" >An iterator is an abstraction of a pointer to a particular table entry. Iterators are analogous to the <span class="obeylines-h"><code class="verb">DIR *</code></span>
pointers used by the POSIX <span class="obeylines-h"><code class="verb">opendir()</code></span>, <span class="obeylines-h"><code class="verb">readdir()</code></span>, <span class="obeylines-h"><code class="verb">closedir()</code></span>, and similar functions, to Perl hash
tables’ <span class="obeylines-h"><code class="verb">each()</code></span>, <span class="obeylines-h"><code class="verb">keys()</code></span>, and <span class="obeylines-h"><code class="verb">values()</code></span>, and to the C++ Standard Template Library’s forward
iterators.
</p><!--l. 1636--><p class="noindent" >At any time, the entries in a table may be considered to be in some arbitrary (implementation-defined) order; an
iterator may be used to walk through some or all of the table entries in this order. This order is guaranteed to
remain unchanged for any given table, so long as no changes are made to that table, i.e. so long as no
<span class="obeylines-h"><code class="verb">Util_TableSet*()</code></span>, <span class="obeylines-h"><code class="verb">Util_TableSet*Array()</code></span>, <span class="obeylines-h"><code class="verb">Util_TableSetGeneric()</code></span>, <span class="obeylines-h"><code class="verb">Util_TableSetGenericArray()</code></span>,
                                                                                       
                                                                                       
<span class="obeylines-h"><code class="verb">Util_TableSetString()</code></span>, or <span class="obeylines-h"><code class="verb">Util_TableDeleteKey()</code></span> calls are made on that table (making such calls on
other tables doesn’t matter). The order may change if there is any change in the table, and it may
differ even between different tables with identical key/value contents (including those produced by
<span class="obeylines-h"><code class="verb">Util_TableClone()</code></span>).<span class="footnote-mark"><a 
href="UsersGuide19.html#fn8x13"><sup class="textsuperscript">8</sup></a></span><a 
 id="x1-204001f8"></a> 
</p><!--l. 1656--><p class="noindent" >Any change in the table also invalidates all iterators pointing anywhere in the table; using any such iterator is an
error. Multiple iterators may point into the same table; they all use the same order, and (unlike in Perl) they’re
all independent.
</p><!--l. 1661--><p class="noindent" >The detailed function description in the Reference Manual for <span class="obeylines-h"><code class="verb">Util_TableItQueryKeyValueInfo()</code></span> has an
example of using an iterator to print out all the entries in a table.
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.8   </span> <a 
 id="x1-205000D3.2.8"></a>Multithreading and Multiprocessor Issues</h4>
<!--l. 1670--><p class="noindent" >At the moment, the table functions are <span 
class="cmti-10">not </span>thread-safe in a multithreaded environment.
</p><!--l. 1688--><p class="noindent" >Note that tables and iterators are process-wide, i.e. all threads see the same tables and iterators (think of them
as like the Unix current working directory, with the various routines which modify the table or change iterators
acting like a Unix <span class="obeylines-h"><code class="verb">chdir()</code></span> system call).
</p><!--l. 1694--><p class="noindent" >In a multiprocessor environment, tables are always processor-local.
</p><!--l. 1698--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">D3.2.9   </span> <a 
 id="x1-206000D3.2.9"></a>Metadata about All Tables</h4>
<!--l. 1700--><p class="noindent" >Tables do not <span 
class="cmti-10">themselves </span>have names or other attributes. However, we may add some special “system tables” to
be used by Cactus itself to store this sort of information for those cases where it’s needed. For example, we may
add support for a “checkpoint me” bit in a table’s flags word, so that if you want a table to be checkpointed, you
just need to set this bit. In this case, the table will probably get a system generated name in the checkpoint
dump file. But if you want the table to have some other name in the dump file, then you need to tell the
checkpointing code that, by setting an appropriate entry in a checkpoint table. (You would find the
checkpoint table by looking in a special “master system table” that records handles of other interesting
tables.)
                                                                                       
                                                                                       
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter D4</span><br /><a 
 id="x1-207000D4"></a>Schedule Bins</h2>
<!--l. 1721--><p class="noindent" >Using the <span 
class="cmtt-10">schedule.ccl </span>files, thorn functions can be scheduled to run in the different timebins which are
executed by the Cactus flesh. This chapter describes these standard timebins, and shows the flow of program
execution through them.
</p><!--l. 1726--><p class="noindent" >Scheduled functions must be declared as
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">In C:</span>              </dt><dd 
class="list">
                  <!--l. 1729--><p class="noindent" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-134">
                  #include &#x0022;cctk_Arguments.h&#x0022;
                  void MyFunction (CCTK_ARGUMENTS);
</pre>
                  <!--l. 1733--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">In C++:</span>           </dt><dd 
class="list">
                  <!--l. 1735--><p class="noindent" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-135">
                  #include &#x0022;cctk_Arguments.h&#x0022;
                  extern &#x0022;C&#x0022; void MyFunction (CCTK_ARGUMENTS);
</pre>
                  <!--l. 1739--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">In Fortran:</span>          </dt><dd 
class="list">
                  <!--l. 1741--><p class="noindent" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-136">
                  #include &#x0022;cctk_Arguments.h&#x0022;
                  subroutine MyFunction (CCTK_ARGUMENTS)
                     DECLARE_CCTK_ARGUMENTS
                  end
</pre>
                  <!--l. 1747--><p class="nopar" ></p></dd></dl>
<!--l. 1750--><p class="noindent" >Exceptions are the functions that are scheduled in the bins <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span>, <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_PARAMETERS</span>, and
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN</span>. They do not take arguments, and they return an integer. They must be declared
as
                  </p><dl class="list1"><dt class="list">
<span 
class="cmss-10">In C:</span>              </dt><dd 
class="list">
                  <!--l. 1756--><p class="noindent" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-137">
                  int MyFunction (void);
</pre>
                  <!--l. 1759--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">In C++</span>            </dt><dd 
class="list">
                  <!--l. 1761--><p class="noindent" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-138">
                  extern &#x0022;C&#x0022; int MyFunction ();
</pre>
                  <!--l. 1764--><p class="nopar" >
                  </p></dd><dt class="list">
<span 
class="cmss-10">In Fortran:</span>          </dt><dd 
class="list">
                  <!--l. 1766--><p class="noindent" >
                                                                                       
                                                                                       
</p>
                  <pre class="verbatim" id="verbatim-139">
                  integer function MyFunction ()
                  end
</pre>
                  <!--l. 1770--><p class="nopar" ></p></dd></dl>
<!--l. 1773--><p class="noindent" >The return value in <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP </span>and <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN </span>is unused, and might in the future be used to indicate
whether an error occurred. You should return 0.
</p><!--l. 1777--><p class="noindent" >The return value in <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_PARAMETERS </span>should be zero, positive, or negative, indicating that no
parameters were recovered, that parameters were recovered successfully, or that an error occurred, respectively.
Routines in this bin are executed in alphabetical order, according to the owning thorn’s name, until one returns
a positive value. All later routines are ignored. Schedule clauses <span 
class="cmtt-10">BEFORE</span>, <span 
class="cmtt-10">AFTER</span>, <span 
class="cmtt-10">WHILE</span>, <span 
class="cmtt-10">IF</span>, etc., are
ignored.
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_PARAMETERS</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1788--><p class="noindent" >Used by thorns with relevant I/O methods as the point to read parameters when
                  recovering from checkpoint files. Grid variables are not available in this timebin.
                  Scheduling in this timebin is special (see above).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_STARTUP</span>      </dt><dd 
class="list">
                  <!--l. 1794--><p class="noindent" >Run before any grids are constructed, this is the timebin, for example, where grid
                  independent information (e.g. output methods, reduction operators) is registered.
                  Note that since no grids are setup at this point, grid variables cannot be used in
                  routines scheduled here.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_WRAGH</span>        </dt><dd 
class="list">
                  <!--l. 1801--><p class="noindent" >This timebin is executed when all parameters are known, but before the driver thorn
                  constructs the grid. It should only be used to set up information that is needed by
                  the driver.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PARAMCHECK</span>   </dt><dd 
class="list">
                  <!--l. 1806--><p class="noindent" >This timebin is for thorns to check the validity of parameter combinations. This
                  bin is also executed before the grid hierarchy is made, so that routines scheduled
                  here only have access to the global grid size and the parameters.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PREREGRIDINITIAL</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1812--><p class="noindent" >This timebin is used in mesh refinement settings. It is ignored for unigrid runs. This
                  bin is executed whenever the grid hierarchy is about to change during evolution;
                  compare <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PREREGRID</span>. Routines that decide the new grid structure should be
                  scheduled in this bin.
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTREGRIDINITIAL</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1819--><p class="noindent" >This timebin is used in mesh refinement settings. It is ignored for unigrid runs.
                  This bin is executed whenever the grid hierarchy or patch setup has changed during
                  evolution; see <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTREGRID</span>. It is, e.g. necessary to re-apply the boundary
                  conditions or recalculate the grid points’ coordinates after every changing the grid
                  hierarchy.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_BASEGRID</span>     </dt><dd 
class="list">
                  <!--l. 1828--><p class="noindent" >This timebin is executed very early after a driver thorn constructs grid; this bin
                  should only be used to set up coordinate systems on the newly created grids.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INITIAL</span>      </dt><dd 
class="list">
                  <!--l. 1833--><p class="noindent" >This is the place to set up any required initial data. This timebin is not run when
                  recovering from a checkpoint file.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTINITIAL</span>  </dt><dd 
class="list">
                  <!--l. 1837--><p class="noindent" >This is the place to modify initial data, or to calculate data that depend on the
                  initial data. This timebin is also not run when recovering from a checkpoint file.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTRESTRICTINITIAL</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1842--><p class="noindent" >This timebin is used only in mesh refinement settings. It is ignored for unigrid
                  runs. This bin is executed after each restriction operation while initial data are set
                  up; compare <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTRESTRICT</span>. It is, e.g. necessary to re-apply the boundary
                  conditions after every restriction operation.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTPOSTINITIAL</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1850--><p class="noindent" >This is the place to modify initial data, or to calculate data that depend on the
                  initial data. This timebin is executed after the recursive initialisation of finer grids
                  if there is a mesh refinement hierarchy, and it is also not run when recovering from
                  a checkpoint file.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_VARIABLES</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1857--><p class="noindent" >Used by thorns with relevant I/O methods as the point to read in all the grid
                  variables when recovering from checkpoint files.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POST</span><span 
class="cmtt-10">_RECOVER</span><span 
class="cmtt-10">_VARIABLES</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1862--><p class="noindent" >This timebin exists for scheduling any functions which need to modify grid variables
                  after recovery.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CPINITIAL</span>    </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 1866--><p class="noindent" >Used by thorns with relevant I/O methods as the point to checkpoint initial data
                  if required.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_CHECKPOINT</span>   </dt><dd 
class="list">
                  <!--l. 1870--><p class="noindent" >Used by thorns with relevant I/O methods as the point to checkpoint data during
                  the iterative loop when required.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PREREGRID</span>    </dt><dd 
class="list">
                  <!--l. 1874--><p class="noindent" >This timebin is used in mesh refinement settings. It is ignored for unigrid runs. This
                  bin is executed whenever the grid hierarchy is about to change during evolution;
                  compare <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PREREGRIDINITIAL</span>. Routines that decide the new grid structure
                  should be scheduled in this bin.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTREGRID</span>   </dt><dd 
class="list">
                  <!--l. 1881--><p class="noindent" >This timebin is used in mesh refinement settings. It is ignored for unigrid runs.
                  This  bin  is  executed  whenever  the  grid  hierarchy  or  patch  setup  has  changed
                  during evolution; see <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTREGRIDINITIAL</span>. It is, e.g. necessary to re-apply the
                  boundary conditions or recalculate the grid points’ coordinates after every changing
                  the grid hierarchy.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PRESTEP</span>      </dt><dd 
class="list">
                  <!--l. 1890--><p class="noindent" >The  timebin  for  scheduling  any  routines  which  need  to  be  executed  before
                  any  routines  in  the  main  evolution  step.  This  timebin  exists  for  thorn  writers
                  convenience, the <span 
class="cmtt-10">BEFORE</span>, <span 
class="cmtt-10">AFTER</span>, etc., functionality of the <span 
class="cmtt-10">schedule.ccl </span>file should
                  allow all functions to be scheduled in the main <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EVOL </span>timebin.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EVOL</span>         </dt><dd 
class="list">
                  <!--l. 1898--><p class="noindent" >The timebin for the main evolution step.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTRESTRICT</span> </dt><dd 
class="list">
                  <!--l. 1901--><p class="noindent" >This timebin is used only in mesh refinement settings. It is ignored for unigrid
                  runs.  This  bin  is  executed  after  each  restriction  operation  during  evolution;
                  compare <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTRESTRICTINITIAL</span>. It is, e.g. necessary to re-apply the boundary
                  conditions after every restriction operation.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_POSTSTEP</span>     </dt><dd 
class="list">
                  <!--l. 1909--><p class="noindent" >The  timebin  for  scheduling  any  routines  which  need  to  be  executed  after  all
                  the  routines  in  the  main  evolution  step.  This  timebin  exists  for  thorn  writers
                  convenience, the <span 
class="cmtt-10">BEFORE</span>, <span 
class="cmtt-10">AFTER</span>, etc., functionality of the <span 
class="cmtt-10">schedule.ccl </span>file should
                  allow all functions to be scheduled in the main <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_EVOL </span>timebin.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_ANALYSIS</span>     </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 1917--><p class="noindent" >The <span 
class="cmtt-10">ANALYSIS </span>timebin is special, in that it is closely coupled with output, and
                  routines which are scheduled here are typically only executed if output of analysis
                  variables is required. Routines which perform analysis should be independent of the
                  main evolution loop (that is, it should not matter for the results of a simulation
                  whether routines in this timebin are executed or not).
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_TERMINATE</span>    </dt><dd 
class="list">
                  <!--l. 1926--><p class="noindent" >Called after the main iteration loop when Cactus terminates. Note that sometime,
                  in this timebin, a driver thorn should be destroying the grid hierarchy and removing
                  grid variables.
                  </p></dd><dt class="list">
<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_SHUTDOWN</span>     </dt><dd 
class="list">
                  <!--l. 1931--><p class="noindent" >Cactus final shutdown routines, after the grid hierarchy has been destroyed. Grid
                  variables are no longer available.
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter D5</span><br /><a 
 id="x1-208000D5"></a>Flesh Parameters</h2>
<!--l. 1943--><p class="noindent" >The flesh parameters are defined in the file <span 
class="cmtt-10">src/param.ccl</span>.
</p>
<h3 class="sectionHead"><span class="titlemark">D5.1   </span> <a 
 id="x1-209000D5.1"></a>Private Parameters</h3>
<!--l. 1947--><p class="noindent" >Here, the default value is shown in square brackets, while curly braces show allowed parameter
values.
</p><!--l. 1949--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">allow</span><span 
class="cmtt-10">_mixeddim</span><span 
class="cmtt-10">_gfs</span> </dt><dd 
class="list">
                  <!--l. 1951--><p class="noindent" >Allow use of GFs from different dimensions [<span 
class="cmtt-10">no</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_brief</span><span 
class="cmtt-10">_output</span> </dt><dd 
class="list">
                  <!--l. 1954--><p class="noindent" >Give only brief output [<span 
class="cmtt-10">no</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_full</span><span 
class="cmtt-10">_warnings</span> </dt><dd 
class="list">
                  <!--l. 1957--><p class="noindent" >Give detailed information for each warning statement [<span 
class="cmtt-10">yes</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_run</span><span 
class="cmtt-10">_title</span>    </dt><dd 
class="list">
                  <!--l. 1960--><p class="noindent" >Description of this simulation [<span 
class="cmtt-10">&#x0022;&#x0022;</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_show</span><span 
class="cmtt-10">_banners</span> </dt><dd 
class="list">
                  <!--l. 1963--><p class="noindent" >Show any registered banners for the different thorns [<span 
class="cmtt-10">yes</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_show</span><span 
class="cmtt-10">_schedule</span> </dt><dd 
class="list">
                  <!--l. 1966--><p class="noindent" >Print the scheduling tree to standard output [<span 
class="cmtt-10">yes</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_strong</span><span 
class="cmtt-10">_param</span><span 
class="cmtt-10">_check</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1969--><p class="noindent" >Die on parameter errors in <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_PARAMCHECK </span>[<span 
class="cmtt-10">yes</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_timer</span><span 
class="cmtt-10">_output</span> </dt><dd 
class="list">
                  <!--l. 1972--><p class="noindent" >Give timing information [<span 
class="cmtt-10">off</span>] <span 
class="cmsy-10">{</span><span 
class="cmtt-10">off, full</span><span 
class="cmsy-10">}</span>
                  </p></dd><dt class="list">
<span 
class="cmtt-10">recovery</span><span 
class="cmtt-10">_mode</span>     </dt><dd 
class="list">
                  <!--l. 1975--><p class="noindent" >How to behave when recovering from a checkpoint [<span 
class="cmtt-10">strict</span>] <span 
class="cmsy-10">{</span><span 
class="cmtt-10">strict, relaxed</span><span 
class="cmsy-10">}</span>
                                                                                       
                                                                                       
                  </p></dd><dt class="list">
<span 
class="cmtt-10">highlight</span><span 
class="cmtt-10">_warning</span><span 
class="cmtt-10">_messages</span><br 
class="newline" />                  </dt><dd 
class="list">
                  <!--l. 1978--><p class="noindent" >Highlight CCTK warning messages [<span 
class="cmtt-10">yes</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">info</span><span 
class="cmtt-10">_format</span>       </dt><dd 
class="list">
                  <!--l. 1981--><p class="noindent" >Specifies the content and format of <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INFO()</span>/<span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_VINFO</span> messages. [<span 
class="cmtt-10">basic</span>]
                  <span 
class="cmsy-10">{</span><span 
class="cmtt-10">&#x0022;basic&#x0022;</span>, <span 
class="cmtt-10">&#x0022;numeric time stamp&#x0022;</span>, <span 
class="cmtt-10">&#x0022;human-readable time stamp&#x0022;</span>,<br 
class="newline" /><span 
class="cmtt-10">&#x0022;full time stamp&#x0022;</span><span 
class="cmsy-10">}</span>
</p>
                  </dd></dl>
<!--l. 1994--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D5.2   </span> <a 
 id="x1-210000D5.2"></a>Restricted Parameters</h3>
<!--l. 1996--><p class="noindent" >
                  </p><dl class="list1"><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_final</span><span 
class="cmtt-10">_time</span>   </dt><dd 
class="list">
                  <!--l. 1998--><p class="noindent" >Final time for evolution, overridden by <span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_itlast </span>unless it is positive [<span 
class="cmtt-10">-1.0</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_initial</span><span 
class="cmtt-10">_time</span> </dt><dd 
class="list">
                  <!--l. 2001--><p class="noindent" >Initial time for evolution [<span 
class="cmtt-10">0.0</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">cctk</span><span 
class="cmtt-10">_itlast</span>       </dt><dd 
class="list">
                  <!--l. 2004--><p class="noindent" >Final iteration number [<span 
class="cmtt-10">10</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">max</span><span 
class="cmtt-10">_runtime</span>       </dt><dd 
class="list">
                  <!--l. 2007--><p class="noindent" >Terminate evolution loop after a certain elapsed runtime (in minutes); set to zero
                  to disable this termination condition [<span 
class="cmtt-10">0</span>]
                  </p></dd><dt class="list">
<span 
class="cmtt-10">presync</span><span 
class="cmtt-10">_mode</span>      </dt><dd 
class="list">
                  <!--l. 2010--><p class="noindent" >The   <span 
class="cmtt-10">presync</span><span 
class="cmtt-10">_mode  </span>parameter   defines   the   behavior   of   the   automatic
                  pre-synchronization of grid functions. A summary of the different modes available
                  is available in Table <a 
href="#x1-2100011">D5.1<!--tex4ht:ref: tab:presync --></a>.
                  </p><!--l. 2013--><p class="noindent" >The meaning of modes is as follows:
                      </p><dl class="description"><dt class="description">
                  <span 
class="cmbx-10">off</span> </dt><dd 
class="description">
                                                                                       
                                                                                       
                      <!--l. 2015--><p class="noindent" >:  This  is  the  default.  Cactus  behaves  as  it  did  prior  to  the  inclusion  of
                      PreSync. READS and WRITES declarations in the schedule have no effect.
                      Synchronization  of  ghost  zones  only  happens  when  a  SYNC  statement  is
                      encountered in the schedule.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">warn-only</span> </dt><dd 
class="description">
                      <!--l. 2018--><p class="noindent" >The same as <span 
class="cmtt-10">presync</span><span 
class="cmtt-10">_off</span>, except that now, if the Driver believes that a SYNC
                      is required but not executed, it issues a warning.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">mixed-warn</span> </dt><dd 
class="description">
                      <!--l. 2020--><p class="noindent" >In this mode, Cactus tries to honor both SYNC statements in the schedule as
                      well as providing automatic synchronization based on the READS/WRITES
                      declarations. It may, however, issue warnings about possible problems.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">mixed-error</span> </dt><dd 
class="description">
                      <!--l. 2024--><p class="noindent" >In this mode, Cactus tries to honor both SYNC statements in the schedule as
                      well as providing automatic synchronization based on the READS/WRITES
                      declarations.  It  may,  however,  issue  errors  when  encountering  possible
                      problems.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">presync-only</span> </dt><dd 
class="description">
                      <!--l. 2028--><p class="noindent" >In   this   mode,   Cactus   will   only   synchronize   ghost   zones   based   on
                      READS/WRITES  declarations  and  will  ingore  SYNC  statements  in  the
                      schedule.</p></dd></dl>
                      <dl class="description"><dt class="description">
                  <span 
class="cmbx-10">Sync triggered by</span> </dt><dd 
class="description">
                      <!--l. 2034--><p class="noindent" >describes what triggers the synchronization of ghost zones for a grid function.
                      “Schedule only,” in this context, means an explicit declaration of <span 
class="cmtt-10">SYNC </span>in the
                      schedule. “Driver,” in this context, means that a synchronization is triggered
                      because the schedule requires the variable to be valid everywhere, but it is
                      only valid in the interior. “sync if driver” indicates that a physical boundary
                      condition is registered for the grid function, and thus the driver can update
                      the exterior of the grid function.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">Can sync</span> </dt><dd 
class="description">
                      <!--l. 2037--><p class="noindent" >describes the condition in which the interior of a grid function contains valid
                      data, but the exterior does not. This will produce a warning in <span 
class="cmtt-10">warn-only</span>
                      mode, as it indicates a possibly incorrect synchronization.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">Can’t sync</span> </dt><dd 
class="description">
                      <!--l. 2038--><p class="noindent" >describes a situation where a read of the interior is needed (e.g. to perform
                      a synchronization), but (as far as the driver knows) the interior of the grid
                      function is not valid.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">IO Thorns</span> </dt><dd 
class="description">
                      <!--l. 2039--><p class="noindent" >describes what the various IO thorns should do if they are asked to write out
                      a grid function if they find invalid data in the interior and/or exterior of a grid
                      function.
                                                                                       
                                                                                       
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">Old Macro</span> </dt><dd 
class="description">
                      <!--l. 2041--><p class="noindent" >refers to the familiar <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_ARGUMENTS</span>, which declares all the grid
                      functions                                                                                 visible
                      to a thorn. The <span 
class="cmtt-10">DECLARE</span><span 
class="cmtt-10">_CCTK</span><span 
class="cmtt-10">_ARGUMENTS</span><span 
class="cmtt-10">_CHECKED(func</span><span 
class="cmtt-10">_name) </span>macros only
                      declare arguments visible based on the READS/WRITES declarations.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">Driver BC</span> </dt><dd 
class="description">
                      <!--l. 2044--><p class="noindent" >refers      to      boundary      condition      update      functions      registered
                      via <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SelectVarForBC </span>or <span 
class="cmtt-10">Driver</span><span 
class="cmtt-10">_SelectGroupForBC</span>. Once registered,
                      this function will be called whenever data is needed in the boundary for the
                      grid function or group.
                      </p></dd><dt class="description">
                  <span 
class="cmbx-10">Scheduled SYNC</span> </dt><dd 
class="description">
                      <!--l. 2047--><p class="noindent" >refers to the explicit SYNC declaration in the <span 
class="cmtt-10">schedule.ccl</span>.</p></dd></dl>
                  <div class="table">
                  <!--l. 2049--><p class="noindent" ><a 
 id="x1-2100011"></a></p><hr class="float" /><div class="float" 
>
                  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-12" class="tabular" 
 
><colgroup id="TBL-12-1g"><col 
id="TBL-12-1" /></colgroup><colgroup id="TBL-12-2g"><col 
id="TBL-12-2" /></colgroup><colgroup id="TBL-12-3g"><col 
id="TBL-12-3" /></colgroup><colgroup id="TBL-12-4g"><col 
id="TBL-12-4" /></colgroup><colgroup id="TBL-12-5g"><col 
id="TBL-12-5" /></colgroup><colgroup id="TBL-12-6g"><col 
id="TBL-12-6" /></colgroup><colgroup id="TBL-12-7g"><col 
id="TBL-12-7" /></colgroup><colgroup id="TBL-12-8g"><col 
id="TBL-12-8" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-1"  
class="td11">  <span 
class="cmbx-7">presync</span><span 
class="cmbx-7">_mode  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-2"  
class="td11">  <span 
class="cmbx-7">Synch triggered by                                                                                                                               </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-3"  
class="td11">  <span 
class="cmbx-7">Can sync                                                                                                                                            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-4"  
class="td11">  <span 
class="cmbx-7">Can’t sync  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-5"  
class="td11">  <span 
class="cmbx-7">IO Thorns                                                                                                                                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-6"  
class="td11">  <span 
class="cmbx-7">Old Macro  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-7"  
class="td11">  <span 
class="cmbx-7">Driver BC  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-1-8"  
class="td11">  <span 
class="cmbx-7">Scheduled SYNC   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-1"  
class="td11">  <span 
class="cmr-7">off                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-2"  
class="td11">  <span 
class="cmr-7">schedule only                                                                                                                                                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-3"  
class="td11">  <span 
class="cmr-7">nothing                                                                                                                                                                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-4"  
class="td11">  <span 
class="cmr-7">nothing        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-5"  
class="td11">  <span 
class="cmr-7">nothing                                                                                                                                                                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-6"  
class="td11">  <span 
class="cmr-7">allowed        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-7"  
class="td11">  <span 
class="cmr-7">ignored        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-2-8"  
class="td11">  <span 
class="cmr-7">honored                   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-1"  
class="td11">  <span 
class="cmr-7">warn-only           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-2"  
class="td11">  <span 
class="cmr-7">schedule only                                                                                                                                                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-3"  
class="td11">  <span 
class="cmr-7">warn                                                                                                                                                                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-4"  
class="td11">  <span 
class="cmr-7">warn            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-5"  
class="td11">  <span 
class="cmr-7">nothing                                                                                                                                                                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-6"  
class="td11">  <span 
class="cmr-7">allowed        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-7"  
class="td11">  <span 
class="cmr-7">ignored        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-3-8"  
class="td11">  <span 
class="cmr-7">honored                   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-1"  
class="td11">  <span 
class="cmr-7">mixed-warn         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-2"  
class="td11">  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-13" class="tabular" 
 
><colgroup id="TBL-13-1g"><col 
id="TBL-13-1" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-13-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-13-1-1"  
class="td00"><span 
class="cmr-7">driver where possible,</span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-13-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-13-2-1"  
class="td00"><span 
class="cmr-7">schedule otherwise</span></td></tr></table>                                                                                                                                         </div>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-3"  
class="td11">  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-14" class="tabular" 
 
><colgroup id="TBL-14-1g"><col 
id="TBL-14-1" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-14-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-14-1-1"  
class="td00"><span 
class="cmr-7">sync if driver, </span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-14-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-14-2-1"  
class="td00"><span 
class="cmr-7">warn otherwise</span></td></tr></table>                                                                                                                                                   </div>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-4"  
class="td11">  <span 
class="cmr-7">warn            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-5"  
class="td11">  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-15" class="tabular" 
 
><colgroup id="TBL-15-1g"><col 
id="TBL-15-1" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-15-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-15-1-1"  
class="td00"><span 
class="cmr-7">warn for driver bc,</span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-15-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-15-2-1"  
class="td00"><span 
class="cmr-7">nothing otherwise</span></td></tr></table>                                                                                                                                             </div>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-6"  
class="td11">  <span 
class="cmr-7">allowed        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-7"  
class="td11">  <span 
class="cmr-7">allowed        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-4-8"  
class="td11">  <span 
class="cmr-7">ignored for driver bc  </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-1"  
class="td11">  <span 
class="cmr-7">mixed-error         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-2"  
class="td11">  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-16" class="tabular" 
 
><colgroup id="TBL-16-1g"><col 
id="TBL-16-1" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-16-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-16-1-1"  
class="td00"><span 
class="cmr-7">driver where possible,</span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-16-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-16-2-1"  
class="td00"><span 
class="cmr-7">schedule otherwise</span></td></tr></table>                                                                                                                                         </div>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-3"  
class="td11">  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-17" class="tabular" 
 
><colgroup id="TBL-17-1g"><col 
id="TBL-17-1" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-17-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-17-1-1"  
class="td00"><span 
class="cmr-7">sync if driver, </span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-17-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-17-2-1"  
class="td00"><span 
class="cmr-7">error otherwise</span></td></tr></table>                                                                                                                                                   </div>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-4"  
class="td11">  <span 
class="cmr-7">error            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-5"  
class="td11">  <!--tex4ht:inline--><div class="tabular"> <table id="TBL-18" class="tabular" 
 
><colgroup id="TBL-18-1g"><col 
id="TBL-18-1" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-18-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-18-1-1"  
class="td00"><span 
class="cmr-7">error for driver bc,</span></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-18-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-18-2-1"  
class="td00"><span 
class="cmr-7">nothing otherwise</span></td></tr></table>                                                                                                                                             </div>  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-6"  
class="td11">  <span 
class="cmr-7">allowed        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-7"  
class="td11">  <span 
class="cmr-7">allowed        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-5-8"  
class="td11">  <span 
class="cmr-7">ignored for driver bc  </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-1"  
class="td11">  <span 
class="cmr-7">presync-only        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-2"  
class="td11">  <span 
class="cmr-7">driver only                                                                                                                                                             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-3"  
class="td11">  <span 
class="cmr-7">driver only                                                                                                                                                             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-4"  
class="td11">  <span 
class="cmr-7">error            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-5"  
class="td11">  <span 
class="cmr-7">error                                                                                                                                                                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-6"  
class="td11">  <span 
class="cmr-7">error            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-7"  
class="td11">  <span 
class="cmr-7">required       </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-12-6-8"  
class="td11">  <span 
class="cmr-7">ignored                   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-12-7-1"  
class="td11">                   </td></tr></table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </div>
<br /> <div class="caption" 
><span class="id">Table D5.1: </span><span  
class="content">Summary of modes and meanings for the <span 
class="cmtt-10">presync</span><span 
class="cmtt-10">_mode </span>parameter.</span></div><!--tex4ht:label?: x1-2100011 -->
                  </div><hr class="endfloat" />
                  </div>
                  </dd><dt class="list">
<span 
class="cmtt-10">terminate</span>         </dt><dd 
class="list">
                  <!--l. 2064--><p class="noindent" >Condition on which to terminate evolution loop [<span 
class="cmtt-10">iteration</span>] <span 
class="cmsy-10">{</span><span 
class="cmtt-10">never, iteration, time,</span>
                  <span 
class="cmtt-10">runtime, any, all</span><span 
class="cmsy-10">}</span>
                  </p></dd><dt class="list">
<span 
class="cmtt-10">terminate</span><span 
class="cmtt-10">_next</span>    </dt><dd 
class="list">
                  <!--l. 2067--><p class="noindent" >Terminate on next iteration ? [<span 
class="cmtt-10">no</span>]
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter D6</span><br /><a 
 id="x1-211000D6"></a>Using the Einstein Toolkit issue tracker</h2>
<!--l. 2079--><p class="noindent" >Bitbucket offers a web-based tool for tracking bug reports and feature requests. Cactus bugs and feature requests
are handled using the Bitbucket issue tracker at <a 
href="https://bitbucket.org/einsteintoolkit/tickets/" class="url" ><span 
class="cmtt-10">https://bitbucket.org/einsteintoolkit/tickets/</span></a>. Click
on <span 
class="cmti-10">Create </span>to create a new ticket in the system.
</p><!--l. 2085--><p class="noindent" >Here, we briefly describe the main categories when creating a Cactus problem report.
                  </p><dl class="list1"><dt class="list">
<span 
class="cmbx-10">Title</span>             </dt><dd 
class="list">
                  <!--l. 2088--><p class="noindent" >A brief and informative subject line.
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Description</span>       </dt><dd 
class="list">
                  <!--l. 2090--><p class="noindent" >Describe your problem precisely, if you get a core dump, include the stack trace, and
                  if possible give the minimal number of thorns, this problems occurs with. Describe
                  how to reproduce the problem if it is not clear. Note that the description field (and
                  the comments) allow markdown syntax. This means that blocks of code or error
                  messages should be surrounded by 3 backticks <span 
class="cmtt-10">```</span> …<span 
class="cmtt-10">```</span> in order to avoid the text
                  being interpreted as markdown commands. Click on the question mark link to learn
                  more about the available markdown commands.
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Kind</span>             </dt><dd 
class="list">
                  <!--l. 2100--><p class="noindent" >Choose <span 
class="cmti-10">bug </span>for cases where there is clearly something wrong and <span 
class="cmti-10">enhancement </span>for
                  a feature request.
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Priority</span>           </dt><dd 
class="list">
                  <!--l. 2103--><p class="noindent" >Pick  whichever  level  is  appropriate.  <span 
class="cmti-10">blocker </span>for  issues  that  stop  you  using  the
                  code, <span 
class="cmti-10">critical </span>for very serious problems, <span 
class="cmti-10">major </span>for things which should definitely
                  be addressed, <span 
class="cmti-10">minor </span>for things which would be good to fix but not essential, and
                  <span 
class="cmti-10">trivial </span>for very low priority items. If in doubt, choose either <span 
class="cmti-10">major </span>or <span 
class="cmti-10">minor</span>.
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Component</span>       </dt><dd 
class="list">
                  <!--l. 2110--><p class="noindent" >Use <span 
class="cmti-10">Cactus </span>for problems related to the Cactus flesh or one of the thorns in one of
                  the Cactus arrangements (those in arrangements with names starting “Cactus”).
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Milestone</span>         </dt><dd 
class="list">
                  <!--l. 2114--><p class="noindent" >This is used by the maintainers to indicate an intention to fix the problem before
                  a particular release of Cactus.
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Version</span>           </dt><dd 
class="list">
                  <!--l. 2117--><p class="noindent" >The Cactus release you are using. You can find this out, for example, from an
                  executable by typing <span 
class="cmtt-10">cactus</span><span 
class="cmtt-10">_&#x003C;config&#x003E; -v</span>.
                  </p></dd><dt class="list">
<span 
class="cmbx-10">Keyword</span>         </dt><dd 
class="list">
                                                                                       
                                                                                       
                  <!--l. 2122--><p class="noindent" >There is no explicit field to add keywords. It is however a good idea to add a line
                  ”Keyword: keyword1 keyword2” at the end to the Description to indicate that a
                  <span 
class="cmti-10">backport </span>to the release version is required. For example, you could also enter the
                  thorn name if the problem is with a specific thorn, the keyword <span 
class="cmti-10">testsuite </span>if the ticket
                  is related to a test failure, or the keyword <span 
class="cmti-10">documentation </span>if the problem is related
                  to the documentation.
</p>
                  </dd></dl>
                                                                                       
                                                                                       
<h2 class="chapterHead"><span class="titlemark">Chapter D7</span><br /><a 
 id="x1-212000D7"></a>Using Tags</h2>
<!--l. 2138--><p class="noindent" >Finding your way around in the Cactus structure can be pretty difficult to handle. To make life easier there is
support for <span 
class="cmti-10">tags</span>, which lets you browse the code easily from within Emacs/XEmacs or <span 
class="cmtt-10">vi</span>. A tags database can
be generated with <span 
class="cmtt-10">gmake</span>:
</p>
<h3 class="sectionHead"><span class="titlemark">D7.1   </span> <a 
 id="x1-213000D7.1"></a>Tags with Emacs</h3>
<!--l. 2145--><p class="noindent" >The command <span 
class="cmtt-10">gmake TAGS </span>will create a database for a routine reference table to be used within Emacs. This
database can be accessed within Emacs if you add either of the following lines to your <span 
class="cmtt-10">.emacs</span>
file:<br 
class="newline" /><span 
class="cmtt-10">(setq tags-file-name &#x0022;CACTUS</span><span 
class="cmtt-10">_HOME/TAGS&#x0022;) </span>XOR <br 
class="newline" /><span 
class="cmtt-10">(setq tag-table-alist ’((&#x0022;CACTUS</span><span 
class="cmtt-10">_HOME&#x0022; . &#x0022;CACTUS</span><span 
class="cmtt-10">_HOME/TAGS&#x0022;)))</span><br 
class="newline" />where <span 
class="cmtt-10">CACTUS</span><span 
class="cmtt-10">_HOME </span>is your Cactus directory.<br 
class="newline" />
</p><!--l. 2152--><p class="noindent" >You can now easily navigate your Cactus flesh and Toolkits by searching for functions or “tags”:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-213002x1">
     <!--l. 2155--><p class="noindent" > <span 
class="cmbx-10">Alt. </span>will find a tag
     </p></li>
<li 
  class="enumerate" id="x1-213004x2">
     <!--l. 2156--><p class="noindent" > <span 
class="cmbx-10">Alt, </span>will find the next matching tag
     </p></li>
<li 
  class="enumerate" id="x1-213006x3">
     <!--l. 2157--><p class="noindent" > <span 
class="cmbx-10">Alt* </span>will go back to the last matched tag</p></li></ol>
<!--l. 2159--><p class="noindent" >If you add the following lines to your <span 
class="cmtt-10">.emacs </span>file, the files found with tags will opened in <span 
class="cmti-10">read-only</span>
mode:
                                                                                       
                                                                                       
</p>
<pre class="verbatim" id="verbatim-140">
(defun find-tag-readonly (&#x0026;rest a)
  (interactive)
  (call-interactively ‘find-tag a)
  (if (eq nil buffer-read-only) (setq buffer-read-only t))  )

(defun find-tag-readonly-next (&#x0026;rest a)
  (interactive)
  (call-interactively ‘tags-loop-continue a)
  (if (eq nil buffer-read-only) (setq buffer-read-only t))  )

(global-set-key [(control meta \.)] ’find-tag-readonly)
(global-set-key [(control meta \,)] ’find-tag-readonly-next)
</pre>
<!--l. 2174--><p class="nopar" >The key strokes to use when you want to browse in read-only mode are:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-213008x1">
     <!--l. 2177--><p class="noindent" ><span 
class="cmbx-10">CTRL Alt. </span>will find a tag and open the file in read-only mode
     </p></li>
<li 
  class="enumerate" id="x1-213010x2">
     <!--l. 2178--><p class="noindent" ><span 
class="cmbx-10">CTRL Alt, </span>will find the next matching tag in read-only mode</p></li></ol>
<!--l. 2181--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">D7.2   </span> <a 
 id="x1-214000D7.2"></a>Tags with <span 
class="cmtt-10">vi</span></h3>
<!--l. 2183--><p class="noindent" >The commands available are highly dependent upon the version of <span 
class="cmtt-10">vi</span>, but the following is a selection of
commands which may work.
</p><!--l. 2187--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-214002x1">
     <!--l. 2189--><p class="noindent" ><span 
class="cmbx-10">vi -t tag </span>Start <span 
class="cmtt-10">vi </span>and position the cursor at the file and line where ‘tag’ is defined.
                                                                                       
                                                                                       
     </p></li>
<li 
  class="enumerate" id="x1-214004x2">
     <!--l. 2192--><p class="noindent" ><span 
class="cmbx-10">Control-] </span>Find the tag under the cursor.
     </p></li>
<li 
  class="enumerate" id="x1-214006x3">
     <!--l. 2195--><p class="noindent" ><span 
class="cmbx-10">:ta tag </span>Find a tag.
     </p></li>
<li 
  class="enumerate" id="x1-214008x4">
     <!--l. 2198--><p class="noindent" ><span 
class="cmbx-10">:tnext </span>Find the next matching tag.
     </p></li>
<li 
  class="enumerate" id="x1-214010x5">
     <!--l. 2201--><p class="noindent" ><span 
class="cmbx-10">:pop </span>Return to previous location before jump to tag.
     </p></li>
<li 
  class="enumerate" id="x1-214012x6">
     <!--l. 2204--><p class="noindent" ><span 
class="cmbx-10">Control-T </span>Return to previous location before jump to tag (not widely implemented).
</p>
     </li></ol>
<!--l. 2214--><p class="noindent" ><span 
class="cmti-10">Note: Currently some of the </span><span 
class="cmitt-10">CCTK</span><span 
class="cmitt-10">_FILEVERSION() </span><span 
class="cmti-10">macros at the top of every source file don’t have a trailing</span>
<span 
class="cmti-10">semicolon, which confuses the </span><span 
class="cmitt-10">etags </span><span 
class="cmti-10">and </span><span 
class="cmitt-10">ctags </span><span 
class="cmti-10">programs, so tags does not find the first subroutine in any file</span>
<span 
class="cmti-10">with this problem.</span>
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
                                                                                       
</p>
 
</body></html> 

                                                                                       


